
<button (click)="handleModalOpen()" nz-button nzType="default"><span nz-icon nzType="filter" nzTheme="outline"></span> Filter</button>

<nz-modal
    (nzOnCancel)="handleModalClose()"
    [(nzVisible)]="isVisible"
    [nzFooter]="modalFooter"
    nzTitle="Events Filter"
>
    <ng-container *nzModalContent>
        <div class="filter-form">
            <p *ngIf="liveEnabled">
                Date range filtering is disabled when "Live" is enabled.
            </p>
            
            <div *ngIf="!liveEnabled" class="date-range-container">
                <div class="date-picker-group">
                    <label>From Date</label>
                    <nz-date-picker
                        [(ngModel)]="dateTimeRange.oldestDateTime"
                        [nzShowTime]="{ nzFormat: 'HH:mm' }"
                        nzFormat="HH:mm dd-MMM-yyyy"
                    ></nz-date-picker>
                </div>
                
                <div class="date-picker-group">
                    <label>To Date</label>
                    <nz-date-picker
                        [(ngModel)]="dateTimeRange.newestDateTime"
                        [nzShowTime]="{ nzFormat: 'HH:mm' }"
                        nzFormat="HH:mm dd-MMM-yyyy"
                    ></nz-date-picker>
                </div>
            </div>

            <nz-table #filterTable [nzData]="filterProps" nzSize="small" class="filter-table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Filter</th>
                    </tr>
                </thead>
                <tbody *ngIf="isVisible">
                    <tr *ngFor="let item of filterTable.data">
                        <td>{{item.name}}</td>
                        <td>
                            <ng-container [ngSwitch]="item.showFilterAs">
                                <ng-container *ngSwitchCase="FilterAsEnum.SHOW_FILTER_AS_FREE_TEXT">
                                    <input
                                        [(ngModel)]="criteria(item).value"
                                        nz-input
                                        placeholder="Enter Text"
                                    />
                                </ng-container>

                                <ng-container *ngSwitchCase="FilterAsEnum.SHOW_FILTER_SELECT_MANY">
                                    <nz-select
                                        [(ngModel)]="criteria(item).value"
                                        nzMode="tags"
                                        nzPlaceHolder="Select many"
                                    >
                                        <nz-option
                                            *ngFor="let option of item.values"
                                            [nzLabel]="option.name"
                                            [nzValue]="option.value"
                                        >
                                        </nz-option>
                                    </nz-select>
                                </ng-container>

                                <ng-container *ngSwitchCase="FilterAsEnum.SHOW_FILTER_SELECT_ONE">
                                    <nz-select
                                        [(ngModel)]="criteria(item).value"
                                        nzAllowClear
                                        nzPlaceHolder="Select one"
                                        nzShowSearch
                                    >
                                        <nz-option
                                            *ngFor="let option of item.values"
                                            [nzLabel]="option.name"
                                            [nzValue]="option.value"
                                        >
                                        </nz-option>
                                    </nz-select>
                                </ng-container>

                                <span *ngSwitchDefault nz-text>No Filter</span>
                            </ng-container>
                        </td>
                    </tr>
                </tbody>
            </nz-table>
        </div>
    </ng-container>
</nz-modal>

<ng-template #modalFooter>
    <div class="modal-footer">
        <button
            (click)="handleFilterReset()"
            nz-button
            nzDanger="true"
        >
            Reset Defaults
        </button>

        <div class="modal-footer-right">
            <button (click)="handleModalClose()" nz-button nzType="default">
                Cancel
            </button>
            <button (click)="handleFilterApply()" nz-button nzType="primary">
                Apply
            </button>
        </div>
    </div>
</ng-template>