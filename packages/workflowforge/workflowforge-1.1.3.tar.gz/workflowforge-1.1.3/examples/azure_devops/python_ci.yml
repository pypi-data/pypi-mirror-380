# Do not modify - Generated with WorkflowForge
name: Python CI
trigger:
  - main
pr:
  - main
jobs:
  - job: Test
    pool:
      vmImage: $(vmImage)
    steps:
      - task: UsePythonVersion@0
        inputs:
          versionSpec: $(python.version)
        displayName: Use Python
      - task: Cache@2
        inputs:
          key: pip | $(Agent.OS) | $(python.version) | pyproject.toml
          restoreKeys: pip | $(Agent.OS) | $(python.version)
          path: $(PIP_CACHE_DIR)
        displayName: Cache pip
      - script: python -m pip install --upgrade pip
        displayName: Upgrade pip
      - script: pip install -e .[dev]
        displayName: Install deps
      - script: black --check src/ tests/
        displayName: Black
      - script: isort --check-only src/ tests/
        displayName: Isort
      - script: flake8 src/ tests/ examples/
        displayName: Flake8
      - script: mypy --install-types --non-interactive src/
        displayName: Mypy
      - script: pytest -q
        displayName: Pytest
    variables:
      PIP_CACHE_DIR: $(Pipeline.Workspace)/.pip
    strategy:
      matrix:
        Py311_ubuntulatest:
          python.version: '3.11'
          vmImage: ubuntu-latest
        Py311_windowslatest:
          python.version: '3.11'
          vmImage: windows-latest
        Py311_macOSlatest:
          python.version: '3.11'
          vmImage: macOS-latest
        Py312_ubuntulatest:
          python.version: '3.12'
          vmImage: ubuntu-latest
        Py312_windowslatest:
          python.version: '3.12'
          vmImage: windows-latest
        Py312_macOSlatest:
          python.version: '3.12'
          vmImage: macOS-latest
        Py313_ubuntulatest:
          python.version: '3.13'
          vmImage: ubuntu-latest
        Py313_windowslatest:
          python.version: '3.13'
          vmImage: windows-latest
        Py313_macOSlatest:
          python.version: '3.13'
          vmImage: macOS-latest
