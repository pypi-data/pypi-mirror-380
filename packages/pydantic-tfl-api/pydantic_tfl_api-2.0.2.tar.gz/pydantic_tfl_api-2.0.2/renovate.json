{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "description": "Intelligent dependency management for pydantic-tfl-api",
  "extends": [
    "config:recommended"
  ],
  "rangeStrategy": "widen",
  "schedule": [
    "before 4am on Monday"
  ],
  "prConcurrentLimit": 5,
  "prHourlyLimit": 2,
  "packageRules": [
    {
      "description": "Auto-merge dev dependencies after tests pass",
      "matchDatasources": [
        "pypi"
      ],
      "matchDepTypes": [
        "dev-dependencies"
      ],
      "automerge": true,
      "automergeType": "pr",
      "automergeStrategy": "squash",
      "ignoreTests": false,
      "groupName": "dev dependencies",
      "labels": [
        "dependencies",
        "dev",
        "automerge"
      ]
    },
    {
      "description": "Auto-merge GitHub Actions",
      "matchManagers": [
        "github-actions"
      ],
      "automerge": true,
      "automergeType": "pr",
      "automergeStrategy": "squash",
      "pinDigests": false,
      "groupName": "GitHub Actions",
      "labels": [
        "github-actions",
        "automerge"
      ],
      "commitMessageTopic": "action {{depName}}"
    },
    {
      "description": "Production dependencies - test compatibility (close PR after review)",
      "matchDatasources": [
        "pypi"
      ],
      "matchDepTypes": [
        "dependencies"
      ],
      "matchPackageNames": [
        "pydantic",
        "requests"
      ],
      "automerge": false,
      "prCreation": "not-pending",
      "recreateWhen": "never",
      "rangeStrategy": "widen",
      "separateMinorPatch": true,
      "labels": [
        "dependencies",
        "production",
        "test-only",
        "do-not-merge"
      ],
      "commitMessagePrefix": "[TEST ONLY]",
      "commitMessageTopic": "{{depName}}",
      "commitMessageExtra": "{{newValue}} compatibility check",
      "prBodyNotes": [
        "## ⚠️ TEST ONLY - DO NOT MERGE ⚠️",
        "",
        "🧪 **This PR validates compatibility but should NOT be merged.**",
        "",
        "### Purpose",
        "Automated test to verify that `{{depName}} {{newValue}}` works with our codebase.",
        "",
        "### Instructions",
        "1. ✅ Wait for CI tests to complete",
        "2. 📊 Review test results (especially Pydantic version matrix)",
        "3. 📝 Note compatibility in issue/changelog",
        "4. ❌ **Close this PR** (it won't be recreated)",
        "5. 🔧 When ready, manually update `pyproject.toml` to widen range",
        "",
        "### What the test results mean",
        "- ✅ **Tests pass**: This version is compatible with our codebase",
        "- ❌ **Tests fail**: Breaking changes exist, review changelog before widening",
        "",
        "### To actually widen the version range",
        "After reviewing several validation PRs and changelogs:",
        "1. Manually edit `pyproject.toml`",
        "2. Update the dependency range (e.g., `pydantic>=2.8.2,<4.0`)",
        "3. Create a normal PR with your changes",
        "",
        "**Close this PR after reviewing test results.**"
      ]
    },
    {
      "description": "Security patches - dev deps auto-merge, prod deps test-only",
      "matchUpdateTypes": [
        "patch"
      ],
      "vulnerabilityAlerts": {
        "enabled": true
      },
      "labels": [
        "security"
      ],
      "prPriority": 10
    },
    {
      "description": "Security patches for dev dependencies - auto-merge",
      "matchUpdateTypes": [
        "patch"
      ],
      "matchDepTypes": [
        "dev-dependencies"
      ],
      "vulnerabilityAlerts": {
        "enabled": true
      },
      "automerge": true,
      "automergeType": "pr",
      "automergeStrategy": "squash",
      "labels": [
        "security",
        "automerge"
      ],
      "prPriority": 10,
      "commitMessagePrefix": "security:"
    },
    {
      "description": "Python version updates - manual review only",
      "matchPackageNames": [
        "python"
      ],
      "automerge": false,
      "labels": [
        "python-version",
        "needs-review"
      ],
      "prBodyNotes": [
        "⚠️ **Python Version Update**",
        "",
        "This updates the Python version. Consider:",
        "1. New language features available",
        "2. Deprecations in newer versions",
        "3. Whether to widen support (e.g., add 3.14) vs. drop old versions",
        "4. Impact on users with older Python versions"
      ]
    },
    {
      "description": "Docker base image updates - auto-merge",
      "matchManagers": [
        "dockerfile"
      ],
      "automerge": true,
      "automergeType": "pr",
      "labels": [
        "docker",
        "automerge"
      ],
      "matchPackageNames": [
        "/devcontainers/"
      ]
    }
  ],
  "vulnerabilityAlerts": {
    "enabled": true,
    "labels": [
      "security"
    ]
  },
  "lockFileMaintenance": {
    "enabled": false
  },
  "rebaseWhen": "behind-base-branch",
  "updateNotScheduled": true,
  "prCreation": "immediate",
  "semanticCommits": "enabled",
  "postUpdateOptions": [
    "gomodTidy"
  ],
  "labels": [
    "renovate"
  ],
  "assignees": [
    "mnbf9rca"
  ]
}
