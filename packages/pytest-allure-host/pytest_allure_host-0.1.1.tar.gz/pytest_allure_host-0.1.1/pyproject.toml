[build-system]
requires = ["poetry-core>=1.9.0"]
build-backend = "poetry.core.masonry.api"

[project]
name = "pytest-allure-host"
version = "0.1.1"
description = "Publish Allure static reports to private S3 behind CloudFront with history preservation"
readme = "README.md"
license = "MIT"
authors = [ { name = "Allure Hosting Maintainers" } ]
requires-python = ">=3.9,<4.0"
keywords = ["allure", "pytest", "aws", "s3", "cloudfront", "reporting"]
classifiers = [
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3.9",
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Programming Language :: Python :: 3.13",
    "Intended Audience :: Developers",
    "Topic :: Software Development :: Testing",
    "Framework :: Pytest",
    "Development Status :: 3 - Alpha",
    "Operating System :: OS Independent"
]

dependencies = [
	"boto3>=1.28,<2.0",
	"PyYAML>=6,<7"
]

[project.optional-dependencies]
# (Reserved for runtime extras; dev tooling now uses a Poetry dependency group below.)

[tool.poetry.group.dev]
optional = true

[tool.poetry.group.dev.dependencies]
pytest = ">=7,<9"
moto = {version = ">=5,<6", extras=["s3"]}
bandit = ">=1.7,<2.0"
allure-pytest = ">=2,<3"
pytest-cov = ">=4,<5"
ruff = ">=0.5,<1.0"
pip-audit = ">=2.7,<3.0"
black = ">=24,<25"

[project.scripts]
publish-allure = "pytest_allure_host.cli:main"

[project.entry-points."pytest11"]
pytest_allure_host = "pytest_allure_host.plugin"

[project.urls]
Homepage = "https://github.com/darrenrabbs/allurehosting"
Repository = "https://github.com/darrenrabbs/allurehosting"
Documentation = "https://github.com/darrenrabbs/allurehosting#readme"
"Bug Tracker" = "https://github.com/darrenrabbs/allurehosting/issues"
Changelog = "https://github.com/darrenrabbs/allurehosting/releases"

# Package include (PEP 621 doesn't specify this; still handled by Poetry configuration)
[tool.poetry]
packages = [{ include = "pytest_allure_host" }]
# PEP 621 is authoritative; legacy duplicate metadata removed (require Poetry 2.2.1+)

[tool.poetry.dependencies]
# Retained only for Poetry's internal processing of the runtime dependency group.
python = ">=3.9,<4.0"


[tool.ruff]
line-length = 100
target-version = "py39"

[tool.ruff.lint]
select = ["E", "F", "I", "B", "UP", "S", "W", "C90"]
ignore = ["E203", "E501"]

[tool.ruff.lint.per-file-ignores]
"tests/**" = ["S101"]  # allow bare asserts in test modules

[tool.ruff.format]
quote-style = "double"
indent-style = "space"
skip-magic-trailing-comma = false
line-ending = "lf"

[tool.black]
line-length = 100
target-version = ["py39"]
skip-string-normalization = false
color = true
