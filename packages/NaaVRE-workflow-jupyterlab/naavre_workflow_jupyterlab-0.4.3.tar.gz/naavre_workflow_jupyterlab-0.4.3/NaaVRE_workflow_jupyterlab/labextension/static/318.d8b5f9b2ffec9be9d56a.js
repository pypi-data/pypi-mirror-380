"use strict";(self.webpackChunk_naavre_workflow_jupyterlab=self.webpackChunk_naavre_workflow_jupyterlab||[]).push([[318],{9358:(e,t,n)=>{n.r(t),n.d(t,{IWorkflowTracker:()=>Xt,default:()=>en});var r=n(9219),a=n(3794),l=n(5273),i=n(7262),s=n(316),o=n(3948),c=n(7327),d=n(4529),u=n(4602),p=n(1079),h=n.n(p),m=n(3345),f=n.n(m),g=n(2515),y=n(8856),v=n(1918),w=n(5023),k=n(7296);async function x(e="",t={}){const n=k.ServerConnection.makeSettings(),r=w.URLExt.join(n.baseUrl,e);let a;try{a=await k.ServerConnection.makeRequest(r,t,n)}catch(e){throw new k.ServerConnection.NetworkError(e)}let l=await a.text();if(l.length>0)try{l=JSON.parse(l)}catch(e){console.log("Not a JSON response body.",a)}if(!a.ok)throw new k.ServerConnection.ResponseError(a,l.message||l);return l}async function E(e,t,n={},r={}){const a="naavre-communicator/external-service",l={method:"POST",body:JSON.stringify({query:{method:e,url:t,headers:n,data:r}})};console.debug("request",a,l);const i=await x(a,l);console.debug("resp",i);try{console.debug("resp.content",JSON.parse(i.content))}catch(e){}return i}var b=n(4943),C=n.n(b);const S={offset:{x:0,y:0},scale:1,nodes:{},links:{},selected:{},hovered:{}};function _(e){return(new(C())).hex(e)}const A=(0,n(710).A)({palette:{secondary:{main:"#ea5b2d",dark:"#b12800",light:"#ff8c5a"},primary:{main:"#0f4e8a",dark:"#00275c",light:"#4e79ba"}}}),I=(0,m.createContext)({});var R=n(2826),O=n.n(R),U=n(7763);const T=O().div`
  position: absolute;
  background: white;
  width: ${e=>e.width||"250px"};
  height: ${e=>e.height||"150px"};
  border-radius: 5px;
  border: 1px solid lightgray;
`;function L({title:e,backgroundColor:t}){return f().createElement(U.A,{title:e,placement:"bottom",arrow:!0},f().createElement("div",{style:{borderTopLeftRadius:"5px",borderTopRightRadius:"5px",padding:"5px",textAlign:"center",backgroundColor:t}},f().createElement("div",{style:{fontSize:"small",display:"inline-block",maxWidth:"200px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},e)))}const G=f().forwardRef((({node:e,children:t,...n},r)=>function({node:e,children:t,...n},r){const a="workflow-cell"!==e.type;let l="250px",i="150px";return"splitter"!==e.type&&"merger"!==e.type||(l="200px",i="100px"),f().createElement(T,{width:l,height:i,ref:r,...n},f().createElement(L,{title:e.properties.cell.title,backgroundColor:a?"rgb(195, 235, 202)":"rgb(229,252,233)"}),t)}({node:e,children:t,...n},r)));var F=n(8593),M=n(2313);function N({nodeType:e,sx:t}){switch(e){case"splitter":return m.createElement(M.A,{sx:{transform:"rotate(90deg)",...t}});case"merger":return m.createElement(F.A,{sx:{transform:"rotate(90deg)",...t}});default:return m.createElement(m.Fragment,null)}}function P({node:e}){return m.createElement("div",{style:{width:"190px",padding:"5px",display:"flex",justifyContent:"center"}},m.createElement(N,{nodeType:e.type,sx:{fontSize:"50px"}}))}function H({color:e}){return f().createElement("div",{style:{width:"20px",height:"20px",background:e,borderRadius:"50%",cursor:"pointer"}})}function $(){return f().createElement("div",{style:{marginTop:"20px",width:"20px",height:"20px",background:"#3c8f49",borderRadius:"5px",cursor:"pointer"}})}function V({children:e}){return f().createElement("div",{style:{display:"inline-block",maxWidth:"100px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",marginLeft:"5px",marginRight:"5px"}},e)}const D=e=>"splitter"===e.port.properties.parentNodeType||"merger"===e.port.properties.parentNodeType?f().createElement($,null):f().createElement(U.A,{title:e.port.id,placement:"bottom",arrow:!0},f().createElement("div",{style:{display:"flex",justifyContent:"left"===e.port.type?"flex-start":"flex-end"}},"right"===e.port.type&&f().createElement(V,null,e.port.id),f().createElement(H,{color:e.port.properties.color}),"left"===e.port.type&&f().createElement(V,null,e.port.id)));var W=n(2369),z=n(951),j=n(9579),B=n(4939),Z=n(6247),J=n(3603),Y=n(2823),q=n(4327),K=n(4554),X=n(2819);function Q({title:e,children:t}){return f().createElement(f().Fragment,null,e&&f().createElement(X.A,{component:"h4",sx:{marginTop:"16px",marginBottom:"16px"}},e),f().createElement(z.A,{elevation:1},f().createElement(q.A,null,f().createElement(Z.A,null,f().createElement(J.A,null,t)))))}function ee({cells:e}){return f().createElement(K.A,null,e.map((e=>f().createElement(Y.A,null,e))))}function te({name:e}){return f().createElement("div",{style:{width:"20px",height:"20px",background:_(e),borderRadius:"50%"}})}function ne({cell:e}){return f().createElement(j.A,{sx:{margin:"15px"}},f().createElement(Q,null,e.container_image&&f().createElement(ee,{cells:["Image name",e.container_image]}),e.base_container_image&&f().createElement(f().Fragment,null,f().createElement(ee,{cells:["Base image (build)",e.base_container_image.build]}),f().createElement(ee,{cells:["Base image (runtime)",e.base_container_image.runtime]})),e.kernel&&f().createElement(ee,{cells:["Kernel",e.kernel]}),e.source_url&&f().createElement(ee,{cells:["Source",f().createElement(B.A,{href:e.source_url,target:"_blank",rel:"noreferrer"},e.source_url)]})),e.inputs.length>0&&f().createElement(f().Fragment,null,f().createElement(Q,{title:"Inputs"},e.inputs.map((e=>f().createElement(ee,{cells:[f().createElement(te,{name:e.name}),e.name,e.type]}))))),e.outputs.length>0&&f().createElement(f().Fragment,null,f().createElement(Q,{title:"Outputs"},e.outputs.map((e=>f().createElement(ee,{cells:[f().createElement(te,{name:e.name}),e.name,e.type]}))))),e.params.length>0&&f().createElement(f().Fragment,null,f().createElement(Q,{title:"Parameters"},e.params.map((e=>f().createElement(ee,{cells:[e.name,e.type,e.default_value]}))))),e.secrets.length>0&&f().createElement(f().Fragment,null,f().createElement(Q,{title:"Secrets"},e.secrets.map((e=>f().createElement(ee,{cells:[e.name]}))))))}var re=n(2691),ae=n(7809);function le({children:e,onClose:t}){return m.createElement("div",{className:"naavre-workflow-section-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},m.createElement("p",{style:{margin:"0"}},e),m.createElement(re.A,{"aria-label":"Close",style:{color:"white",borderRadius:"100%"},onClick:t},m.createElement(ae.A,null)))}function ie({link:e,onClose:t}){return m.createElement(le,{onClose:t},"Link")}function se({node:e,onClose:t}){let n="";switch(e.type){case"splitter":n="Splitter";break;case"merger":n="Merger";break;case"workflow-cell":n=e.properties.cell.title}return m.createElement(m.Fragment,null,m.createElement(le,{onClose:t},n),"workflow-cell"===e.type&&m.createElement(ne,{cell:e.properties.cell}))}function oe({chart:e,setChart:t,callbacks:n,config:r}){if(!e.selected.id)return m.createElement(m.Fragment,null);function a(){t({...e,selected:{}})}return m.createElement(z.A,{elevation:6,sx:{position:"absolute",top:20,right:20,width:380,maxHeight:"calc(100% - 40px)",overflowX:"clip",overflowY:"scroll"}},"link"===e.selected.type&&m.createElement(ie,{link:e.links[e.selected.id],onClose:a}),"node"===e.selected.type&&m.createElement(se,{node:e.nodes[e.selected.id],onClose:a}),m.createElement("div",{style:{margin:"15px"}},m.createElement(W.A,{variant:"contained",onClick:()=>n.onDeleteKey({config:r})},"Delete")))}var ce=n(3837),de=n(9211),ue=n(1228),pe=n(8183),he=n(1178),me=n(6962),fe=n(5603),ge=n(5002),ye=n(431),ve=n.n(ye),we=n(7375),ke=n.n(we),xe=n(4799),Ee=n(8245);function be(){const e=(t=[22,23,0,1,2,3,4,5])[Ce(0,t.length-1)];var t;const n=Ce(0,59);return ve()().hour(e).minute(n)}function Ce(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}function Se({periodUnit:e,setPeriodUnit:t}){return f().createElement(fe.Stack,{direction:"row",spacing:2,style:{padding:"1rem",alignItems:"center"}},f().createElement(fe.InputLabel,{id:"input-label",style:{width:"50%"}},"Run every"),f().createElement(fe.Select,{id:"period-interval",labelId:"input-label","aria-describedby":"repetion periodUnit duration",value:e,onChange:e=>{t(e.target.value)},style:{width:"50%"},MenuProps:{sx:{zIndex:3e4}}},f().createElement(fe.MenuItem,{value:"hour"},"hour"),f().createElement(fe.MenuItem,{value:"day"},"day"),f().createElement(fe.MenuItem,{value:"week"},"week"),f().createElement(fe.MenuItem,{value:"month"},"month")))}function _e({time:e,setTime:t}){return f().createElement(fe.Stack,{direction:"row",spacing:2,style:{padding:"1rem",alignItems:"center"}},f().createElement(fe.InputLabel,{id:"day-of-week-label",style:{width:"40%"}},"On"),f().createElement(fe.Select,{id:"day-of-week-select",labelId:"day-of-week-label",value:e.day(),onChange:n=>{t(e.day(Number(n.target.value)))},style:{width:"60%"},MenuProps:{sx:{zIndex:3e4}}},f().createElement(fe.MenuItem,{value:1},"Monday"),f().createElement(fe.MenuItem,{value:2},"Tuesday"),f().createElement(fe.MenuItem,{value:3},"Wednesday"),f().createElement(fe.MenuItem,{value:4},"Thursday"),f().createElement(fe.MenuItem,{value:5},"Friday"),f().createElement(fe.MenuItem,{value:6},"Saturday"),f().createElement(fe.MenuItem,{value:0},"Sunday")))}function Ae({time:e,setTime:t}){return f().createElement(fe.Stack,{direction:"row",spacing:2,style:{padding:"1rem",alignItems:"center"}},f().createElement(fe.InputLabel,{style:{width:"40%"}},"On day"),f().createElement(fe.TextField,{type:"number",id:"time",label:"Day",value:e.date(),onChange:n=>{const r=Number(n.target.value);t(e.date(r))},style:{width:"60%"}}))}function Ie({periodUnit:e,time:t,setTime:n}){return f().createElement(f().Fragment,null,"week"===e&&f().createElement(_e,{time:t,setTime:n}),"month"===e&&f().createElement(Ae,{time:t,setTime:n}),f().createElement(fe.Container,null,f().createElement(fe.Typography,{variant:"body2"},function(e,t){const n="Your workflow will run ";switch(e){case"hour":return n+`at minute :${t.format("mm")}`;case"day":case"week":case"month":return n+`during quiet hours at ${t.format("HH:mm")}`}}(e,t))))}function Re({setCron:e}){const[t,n]=(0,m.useState)(null),[r,a]=(0,m.useState)(!1),[l,i]=(0,m.useState)("day"),[s,o]=(0,m.useState)(be);(0,m.useEffect)((()=>{e(r?function(e,t){switch(e){case"hour":return`${t.minute()} * * * *`;case"day":return`${t.minute()} ${t.hour()} * * *`;case"week":return`${t.minute()} ${t.hour()} * * ${t.day()}`;case"month":return`${t.minute()} ${t.hour()} ${t.date()} * *`}}(l,s):null)}),[r,e,l,s]);const c=()=>{n(null)},d=Boolean(t),u=d?"simple-popover":void 0;return f().createElement(f().Fragment,null,f().createElement(fe.Button,{onClick:e=>{r||i("day"),a(!0),n(e.currentTarget)},size:"small",variant:"text",startIcon:f().createElement(ge.A,{fontSize:"inherit"}),style:{color:me.A[900],textTransform:"none",minWidth:"10rem"}},r?function(e,t){switch(e){case"hour":return`Every hour at :${t.format("mm")}`;case"day":return`Every day at ${t.format("HH:mm")}`;case"week":return`Every ${t.format("dddd")}`;case"month":return`On the ${t.format("Do")} of each month`}}(l,s):"Make recurring"),f().createElement(fe.Popover,{id:u,open:d,anchorEl:t,onClose:c,anchorOrigin:{vertical:"bottom",horizontal:"left"},style:{zIndex:2e4}},f().createElement(xe.LocalizationProvider,{dateAdapter:Ee.R},f().createElement(fe.Container,{style:{padding:"1rem",minWidth:"25rem"}},f().createElement(Se,{periodUnit:l,setPeriodUnit:i}),f().createElement(Ie,{periodUnit:l,time:s,setTime:o}),f().createElement(fe.Stack,{direction:"row",spacing:2,style:{float:"right",margin:"1rem"}},f().createElement(fe.Button,{onClick:()=>{a(!1),c()}},"Disable"),f().createElement(fe.Button,{onClick:c,variant:"contained"},"Apply"))))))}function Oe({chart:e}){const t=(0,m.useContext)(I),[n,r]=(0,m.useState)({}),[a,l]=(0,m.useState)({}),[i,s]=(0,m.useState)(null),[o,c]=(0,m.useState)(null),d=(e,t)=>{r((n=>({...n,[e]:t})))},u=(e,t)=>{l((n=>({...n,[e]:t})))};return(0,m.useEffect)((()=>{Object.values(e.nodes).forEach((e=>{e.properties.cell.params.forEach((e=>{d(e.name,{value:null,default_value:e.default_value})})),e.properties.cell.secrets.forEach((e=>{u(e.name,{value:null})}))}))}),[e.nodes]),f().createElement(g.A,{theme:A},f().createElement("div",{style:{display:"flex",overflow:"scroll",flexDirection:"column"}},o?f().createElement("div",{style:{padding:"10px",alignItems:"center",display:"flex",flexDirection:"column"}},f().createElement(de.A,{fontSize:"large",sx:{color:he.A[500]}}),f().createElement("p",{style:{fontSize:"large"}},"Workflow submitted! You can track it"," ",f().createElement("a",{target:"_blank",href:o.run_url},"here"))):f().createElement("div",null,0!==Object.keys(n).length&&f().createElement("div",{style:{textAlign:"right",padding:"10px 15px 0 0"}},f().createElement(W.A,{disabled:!1,onClick:async()=>{Object.entries(n).forEach((([e,t])=>{d(e,{value:t.default_value||null,default_value:t.default_value})}))},size:"small",variant:"text",endIcon:f().createElement(ce.A,{fontSize:"inherit"}),style:{color:me.A[900],textTransform:"none"}},"Use default parameter values")),f().createElement(q.A,null,f().createElement(Z.A,{stickyHeader:!0,"aria-label":"sticky table"},f().createElement(J.A,null,Object.entries(n).map((([e,t])=>f().createElement(K.A,{hover:!0,role:"checkbox",tabIndex:-1,key:e},f().createElement(Y.A,{key:e,align:"right"},e),f().createElement(Y.A,{component:"th",scope:"row"},f().createElement(pe.A,{value:n[e].value,onChange:t=>(async(e,t)=>{d(t,{value:e.target.value,default_value:n[t].default_value})})(t,e)}))))),Object.entries(a).map((([e,t])=>f().createElement(K.A,{hover:!0,role:"checkbox",tabIndex:-1,key:e},f().createElement(Y.A,{key:e,align:"right"},e),f().createElement(Y.A,{component:"th",scope:"row"},f().createElement(pe.A,{type:"password",autoComplete:"off",value:a[e].value,onChange:t=>(async(e,t)=>{u(t,{value:e.target.value})})(t,e)})))))))),f().createElement(ue.A,{direction:"row",spacing:2,style:{float:"right",marginTop:"2rem",alignItems:"center"}},f().createElement(Re,{setCron:s}),f().createElement(W.A,{variant:"contained",className:"lw-panel-button",onClick:()=>(async(n,r)=>{E("POST",`${t.workflowServiceUrl}/submit`,{},{virtual_lab:t.virtualLab,naavrewf2:e,params:n,secrets:r,cron_schedule:i}).then((e=>{if(200!==e.status_code)throw`${e.status_code} ${e.reason}`;const t=JSON.parse(e.content);c(t)})).catch((e=>{const t=`Error running the workflow: ${e}`;console.log(t),alert(t)}))})(n,a),color:"primary",disabled:!(()=>{let e=!0;return Object.values(n).forEach((t=>{e=e&&null!==t.value})),Object.values(a).forEach((t=>{e=e&&null!==t.value})),e})(),style:{float:"right"}},"Run")))))}ve().extend(ke());var Ue=n(250);const Te=[{url:"splitter",title:"Splitter",type:"splitter",version:1,next_version:null,container_image:"",dependencies:[],inputs:[{name:"splitter_source",type:"list"}],outputs:[{name:"splitter_target",type:"list"}],confs:[],params:[],secrets:[],shared_with_scopes:[],shared_with_users:[]},{url:"merger",title:"Merger",type:"merger",version:1,next_version:null,container_image:"",dependencies:[],inputs:[{name:"merger_source",type:"list"}],outputs:[{name:"merger_target",type:"list"}],confs:[],params:[],secrets:[],shared_with_scopes:[],shared_with_users:[]}];var Le=n(7583),Ge=n(5831),Fe=n(5402),Me=n(9634),Ne=n(7980),Pe=n(1794),He=n(988),$e=n(6761),Ve=n(5613),De=n(2452),We=n(1),ze=n(4721),je=n(3619),Be=n(2931),Ze=n(1763),Je=n(4083),Ye=n(2307),qe=n(3293);const Ke=(0,m.createContext)([]),Xe=/^.*sharing-scopes\/([^/]+)\/?$/,Qe={community:"Communities",virtual_lab:"Virtual labs"};function et(e,t,n,r){return t.map((t=>{const a=t.url.replace(Xe,"$1");return{key:a,title:t.title,section:t.label,checked:!e.virtualLab||t.check_in_virtual_labs.includes(e.virtualLab),getSearchParams:e=>{const t=n;return e?t.add(a):t.delete(a),r(t),{shared_with_scopes:Array.from(t).join(","),page:null}}}}))}function tt(e){const t=(0,m.useContext)(I),[n,r]=(0,m.useState)(e),[a,l]=(0,m.useState)([]),i=(0,m.useContext)(Ke),[s,o]=(0,m.useState)(new Set([]));return(0,m.useEffect)((()=>{r((e=>[...e,...et(t,i.filter((e=>!t.virtualLab||e.show_in_virtual_labs.includes(t.virtualLab))),s,o).filter((t=>!e.some((e=>e.key===t.key))))]))}),[t,i,s,o]),(0,m.useEffect)((()=>{l(function(e){const t=Array.from(new Set(e.map((e=>e.section))));return t.sort(((e,t)=>null===e&&null===t?0:null===e?-1:null===t?1:e.localeCompare(t))),t.map((t=>({key:t,title:null!==t&&Qe[t]||null,checkboxFilters:e.filter((e=>e.section===t))})))}(n))}),[n]),{checkboxFilters:n,setCheckboxFilters:r,checkboxFiltersBySection:a,activeSharingScopes:s}}function nt(e){const t=new URL(e);if(t.searchParams.has("page")){const n=Number(t.searchParams.get("page"));if(isNaN(n))throw Error(`Unexpected url: ${e}`);return n}return 1}async function rt(e){const t=await E("GET",e,{accept:"application/json"});if(200!==t.status_code)throw`${t.status_code} ${t.reason}`;return JSON.parse(t.content)}async function at(e,t){let n=await rt(e);if(t){const e={count:n.count,next:null,previous:null,results:n.results};for(;null!==n.next;)n=await rt(n.next),e.results=e.results.concat(n.results);return e}return n}function lt({children:e}){return f().createElement(X.A,{variant:"subtitle2",sx:{mt:2}},e)}function it({usernames:e,setUsernames:t,disabled:n,sx:r}){const a=(0,m.useContext)(I),[l,i]=f().useState(!1),[s,o]=f().useState([]),[c,d]=f().useState(!1),[u,p]=(0,m.useState)(null),[h]=(0,He.useDebouncedValue)(u,200);return(0,m.useEffect)((()=>{const e=h&&a.catalogueServiceUrl?`${a.catalogueServiceUrl}/users/?search=${h}`:null;e&&(d(!0),at(e).then((e=>{o(e.results.map((e=>e.username)))})).catch((e=>{const t=`Error loading cells: ${String(e)}`;console.error(t)})).finally((()=>{d(!1)})))}),[h]),f().createElement(Ve.A,{multiple:!0,sx:r,open:l,disabled:n,onOpen:()=>i(!0),onClose:()=>{i(!1),o([])},value:e,onChange:(e,n)=>t(n),onInputChange:(e,t)=>{p(t)},noOptionsText:"Search users",options:s,loading:c,filterOptions:e=>e,renderInput:e=>f().createElement(pe.A,{...e,slotProps:{input:{...e.InputProps,endAdornment:f().createElement(f().Fragment,null,c?f().createElement(We.A,{color:"inherit",size:20}):null,e.InputProps.endAdornment)}}})})}function st({open:e,onClose:t,onUpdated:n,cell:r,readonly:a}){const[l,i]=(0,m.useState)(r.shared_with_users),{checkboxFilters:s,setCheckboxFilters:o,checkboxFiltersBySection:c,activeSharingScopes:d}=tt([]),[u,p]=(0,m.useState)(!1),[h,g]=(0,m.useState)(null);(0,m.useEffect)((()=>{o((e=>(e.forEach((e=>{e.checked=r.shared_with_scopes.includes(e.key)})),e)))}),[r]),(0,m.useEffect)((()=>{s.forEach((e=>{e.getSearchParams(e.checked)}))}),[s]);const y=(0,m.useCallback)((async()=>{const e=await E("PATCH",r.url,{accept:"application/json"},{shared_with_users:l,shared_with_scopes:Array.from(d)});if(200!==e.status_code)throw`${e.status_code} ${e.reason}`}),[r,l,d]);return f().createElement(ze.A,{onClose:t,open:e},f().createElement(Ze.A,null,r.title),f().createElement(Be.A,null,a&&f().createElement($e.A,{severity:"info",sx:{mb:2}},"You cannot modify this cell because it belongs to another user."),f().createElement(lt,null,"Share with users"),f().createElement(it,{usernames:l,setUsernames:i,disabled:a,sx:{width:500,mt:1}}),c.map((e=>f().createElement(Ye.A,{key:e.key},f().createElement(lt,null,e.title),e.checkboxFilters.map((e=>f().createElement(Je.A,{key:e.key,label:e.title,control:f().createElement(De.A,{checked:e.checked,disabled:a,onChange:t=>{o((n=>{const r=[...n];return r[r.findIndex((t=>t.key===e.key))].checked=t.target.checked,r}))}})})))))),h&&f().createElement($e.A,{severity:"error",sx:{mt:2}},"Cannot update cell: ",h),u&&f().createElement(qe.A,{sx:{mt:2}})),f().createElement(je.A,null,f().createElement(W.A,{color:"secondary",onClick:t},"Cancel"),f().createElement(W.A,{disabled:a,onClick:async()=>{g(null),p(!0),y().then(t).then(n).catch((e=>g(e))).finally((()=>p(!1)))}},"Apply")))}const ot={sub:null,preferred_username:null,username:null},ct=(0,m.createContext)(ot);function dt({label:e,variant:t}){const[n,r]=(0,m.useState)(!1),a=(0,m.useRef)(null);return(0,m.useEffect)((()=>{a.current&&r(a.current.scrollWidth>a.current.clientWidth)}),[]),f().createElement(U.A,{title:e,disableHoverListener:!n,placement:"bottom",arrow:!0},f().createElement(X.A,{variant:t,ref:a,sx:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}},e))}function ut({cell:e,isSpecialNode:t,userIsOwner:n,sx:r}){const a=new RegExp(`-${e.owner}$`),l=e.title.replace(a,"");return f().createElement(ue.A,{sx:r},f().createElement(dt,{variant:"subtitle2",label:l}),t||f().createElement(ue.A,{direction:"row",spacing:1,sx:{alignItems:"center"}},f().createElement(Pe.A,{color:"action",fontSize:"inherit"}),f().createElement(X.A,{variant:"body2"},"v",e.version),e.owner&&f().createElement(f().Fragment,null,f().createElement(Ne.A,{color:"action",fontSize:"inherit"}),f().createElement(dt,{variant:"body2",label:n?"me":e.owner}))))}function pt({cell:e,selectedCellInList:t,setSelectedCell:n,fetchCellsListResponse:r}){const a=(0,m.useRef)(null),l=function(e){const t="type"in e?e.type:"workflow-cell";return{id:e.url,type:t,position:{x:35,y:15},properties:{cell:e},ports:Object.fromEntries([...e.inputs.map((e=>[e.name,{id:e.name,type:"left",properties:{color:_(e.name),parentNodeType:t}}])),...e.outputs.map((e=>[e.name,{id:e.name,type:"right",properties:{color:_(e.name),parentNodeType:t}}]))])}}(e),i="workflow-cell"!==l.type,s=(0,m.useContext)(ct),o=e.owner===s.preferred_username,[c,d]=(0,m.useState)(!1);return f().createElement(j.A,{ref:a,draggable:!0,onDragStart:e=>{e.dataTransfer.setData(v.REACT_FLOW_CHART,JSON.stringify({type:l.type,ports:l.ports,properties:l.properties}))},sx:{margin:"10px",fontSize:"14px",display:"flex",height:"25px",border:"1px solid lightgray",justifyContent:"space-between",alignItems:"center",background:"rgb(195, 235, 202)",backgroundColor:i?"rgb(195, 235, 202)":"rgb(229,252,233)",borderRadius:"5px",padding:"10px",paddingRight:"1px",cursor:"grab","&:active":{cursor:"grabbing"}}},f().createElement(ut,{cell:e,isSpecialNode:i,userIsOwner:o,sx:{width:"calc(100% - 80px + 8px)"}}),f().createElement(re.A,{"aria-label":"Info",style:{borderRadius:"100%"},sx:{width:"40px"},onClick:()=>d(!0)},e.shared_with_users.length>0||e.shared_with_scopes.length>0?f().createElement(Me.A,null):f().createElement(Fe.A,null)),f().createElement(st,{open:c,onClose:()=>d(!1),onUpdated:r,cell:e,readonly:!o}),f().createElement(re.A,{"aria-label":"Info",style:{borderRadius:"100%"},sx:{width:"40px",marginLeft:"-8px"},onClick:function(){t===e?n(null,null):n(e,a.current||null)}},f().createElement(Ge.A,null)))}function ht(){return f().createElement(Le.A,{variant:"rounded",style:{margin:"10px",fontSize:"14px",display:"flex",height:"25px",border:"1px solid transparent",padding:"10px",borderRadius:"5px"}})}function mt({title:e,cells:t,loading:n,message:r,selectedCellInList:a,setSelectedCell:l,fetchCellsListResponse:i,button:s,filter:o,pageNav:c}){return f().createElement("div",null,f().createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",minHeight:"40px",paddingRight:"10px",paddingLeft:"10px",background:"#3c8f49",color:"white",fontSize:"medium"}},f().createElement("span",{style:{overflow:"hidden",textOverflow:"ellipsis"}},e),s&&s),o&&o,f().createElement("div",null,n?f().createElement(f().Fragment,null,f().createElement(ht,null),f().createElement(ht,null)):f().createElement(f().Fragment,null,null!==r&&f().createElement("p",{style:{margin:"10px",textAlign:"center"}},r),t.map((e=>f().createElement(pt,{cell:e,selectedCellInList:a,setSelectedCell:l,fetchCellsListResponse:i}))))),c&&c)}var ft=n(9093),gt=n(5875);function yt({listResponse:e,setUrl:t}){const[n,r]=function(e){let t,n;if(null===e.previous&&null===e.next)t=1,n=1;else if(null===e.previous&&null!==e.next)t=1,n=(0,p.ceil)(e.count/e.results.length);else if(null!==e.previous&&null!==e.next){t=nt(e.previous)+1;const r=e.results.length;n=(0,p.ceil)(e.count/r)}else{if(null===e.previous||null!==e.next)throw Error(`Unexpected pagination: ${e}`);t=nt(e.previous)+1,n=t}return[t,n]}(e);return f().createElement(ue.A,{direction:"row",spacing:1,sx:{justifyContent:"center",alignItems:"center"}},f().createElement(re.A,{"aria-label":"Previous",style:{borderRadius:"100%"},onClick:()=>t(e.previous),sx:{visibility:null===e.previous?"hidden":"visible"}},f().createElement(ft.A,null)),f().createElement("p",null,"Page ",n," of ",r),f().createElement(re.A,{"aria-label":"Next",style:{borderRadius:"100%"},onClick:()=>t(e.next),sx:{visibility:null===e.next?"hidden":"visible"}},f().createElement(gt.A,null)))}var vt=n(6336),wt=n(5749),kt=n(8125);function xt({setUrl:e}){const[t,n]=(0,m.useState)(null),[r]=(0,He.useDebouncedValue)(t,200);return(0,m.useEffect)((()=>{e((e=>Tt(e,{search:r,page:null})))}),[r]),f().createElement(pe.A,{value:t,onChange:e=>n(e.target.value),slotProps:{input:{startAdornment:f().createElement(wt.A,{position:"start"},f().createElement(kt.A,null)),endAdornment:t&&f().createElement(wt.A,{position:"end"},f().createElement(re.A,{"aria-label":"clear search",onClick:()=>n(""),edge:"end",style:{borderRadius:"100%"}},f().createElement(vt.A,null)))}},size:"small",sx:{"& .MuiInputBase-root":{borderRadius:"100px"},width:"100%","&:focus-within":{flexShrink:0},transition:"all 0.5s ease"}})}var Et=n(6299),bt=n(3269),Ct=n(1437);const St=[{value:"modified",title:"First modified"},{value:"-modified",title:"Last modified"},{value:"title",title:"A-Z"},{value:"-title",title:"Z-A"}];function _t({setUrl:e}){const[t,n]=(0,m.useState)("-modified");(0,m.useEffect)((()=>{e((e=>Tt(e,{ordering:t,page:null})))}),[t]);const[r,a]=f().useState(null),l=Boolean(r);return f().createElement(f().Fragment,null,f().createElement(re.A,{id:"ordering-button","aria-label":"ordering","aria-controls":l?"ordering-menu":void 0,"aria-expanded":l?"true":void 0,"aria-haspopup":"true",style:{borderRadius:"100%"},onClick:e=>a(e.currentTarget)},f().createElement(Ct.A,null)),f().createElement(Et.A,{id:"ordering-menu",anchorEl:r,open:l,onClose:()=>a(null),slotProps:{list:{"aria-labelledby":"ordering-button"}}},St.map((e=>f().createElement(bt.A,{key:e.value,selected:e.value===t,onClick:()=>{n(e.value),a(null)}},e.title)))))}var At=n(6099),It=n(5851);const Rt=[{key:"all_versions",title:"All versions",section:null,checked:!0,getSearchParams:e=>({all_versions:e?"true":"false",page:null})},{key:"shared_with_me",title:"Shared with me",section:null,checked:!0,getSearchParams:e=>({shared_with_me:e?"true":"false",page:null})}];function Ot({children:e}){return f().createElement(X.A,{variant:"subtitle2",sx:{mt:2}},e)}function Ut({setUrl:e}){const{checkboxFilters:t,setCheckboxFilters:n,checkboxFiltersBySection:r}=tt(Rt),{virtualLab:a}=(0,m.useContext)(I);(0,m.useEffect)((()=>{const e=[{key:"virtual_lab",title:"All virtual labs",section:null,checked:!0,getSearchParams:e=>({virtual_lab:e?null:a||null,page:null})}];n((t=>[...e,...t.filter((t=>!e.some((e=>e.key===t.key))))]))}),[a]),(0,m.useEffect)((()=>{t.forEach((t=>{e((e=>Tt(e,t.getSearchParams(t.checked))))}))}),[t]);const[l,i]=f().useState(null),s=Boolean(l),o=s?"checkboxfilter-popover":void 0;return f().createElement(f().Fragment,null,f().createElement(re.A,{"aria-describedby":o,"aria-label":"checkbox-filters",style:{borderRadius:"100%"},onClick:e=>i(e.currentTarget)},f().createElement(At.A,null)),f().createElement(It.Ay,{id:o,open:s,anchorEl:l,onClose:()=>i(null),anchorOrigin:{vertical:"bottom",horizontal:"left"}},f().createElement(Ye.A,{sx:{px:2,py:1}},r.map((e=>f().createElement(Ye.A,{key:e.key},f().createElement(Ot,null,e.title),e.checkboxFilters.map((e=>f().createElement(Je.A,{key:e.key,label:e.title,control:f().createElement(De.A,{checked:e.checked,onChange:t=>{n((n=>{const r=[...n];return r[r.findIndex((t=>t.key===e.key))].checked=t.target.checked,r}))}})})))))))))}function Tt(e,t){if(null===e)return null;const n=new URL(e);for(const[e,r]of Object.entries(t))null===r||""===r?n.searchParams.delete(e):n.searchParams.set(e,r);return n.toString()}function Lt({setUrl:e}){return f().createElement(ue.A,{direction:"row",spacing:1,sx:{justifyContent:"start",alignItems:"center",padding:"10px"}},f().createElement(xt,{setUrl:e}),f().createElement(Ut,{setUrl:e}),f().createElement(_t,{setUrl:e}))}function Gt({settings:e,initialPath:t,getAllPages:n}){const[r,a]=(0,m.useState)(!0),[l,i]=(0,m.useState)(null),[s,o]=(0,m.useState)(e.catalogueServiceUrl?`${e.catalogueServiceUrl}/${t}`:null);(0,m.useEffect)((()=>{e.catalogueServiceUrl&&o(`${e.catalogueServiceUrl}/${t}`)}),[e.catalogueServiceUrl]);const[c,d]=(0,m.useState)({count:0,next:null,previous:null,results:[]}),u=(0,m.useCallback)((()=>{i&&i(null),a&&a(!0),s&&at(s,n).then((e=>{d(e)})).catch((e=>{const t=`Error listing items: ${String(e)}`;console.error(t),i&&i(t)})).finally((()=>{a&&a(!1)}))}),[s]);return(0,m.useEffect)((()=>u()),[u]),{url:s,setUrl:o,loading:r,setLoading:a,errorMessage:l,setErrorMessage:i,fetchResponse:u,response:c}}function Ft({selectedCellInList:e,setSelectedCell:t}){const n=(0,m.useContext)(I),{setUrl:r,loading:a,errorMessage:l,fetchResponse:i,response:s}=Gt({settings:n,initialPath:"workflow-cells/?ordering=-modified"}),{response:o}=Gt({settings:n,initialPath:"sharing-scopes/?page_size=100",getAllPages:!0}),c=function(){const[e,t]=(0,m.useState)(ot);return(0,m.useEffect)((()=>{x("naavre-communicator/me").then((e=>{t(e)}))}),[]),e}();return f().createElement(z.A,{elevation:12,style:{position:"absolute",top:0,left:0,width:300,height:"100%",overflowX:"hidden",overflowY:"scroll",display:"flex",flexDirection:"column",borderRadius:0}},f().createElement(Ke.Provider,{value:o.results},f().createElement(ct.Provider,{value:c},f().createElement(mt,{title:"Cells Catalog",cells:s.results,loading:a,message:l||(0===s.count?"There are no cells in your catalogue. Get started by creating a notebook and containerizing a cell.":null),selectedCellInList:e,setSelectedCell:t,fetchCellsListResponse:i,button:f().createElement(U.A,{title:"Refresh",arrow:!0},f().createElement(re.A,{"aria-label":"Reload",style:{color:"white",borderRadius:"100%"},onClick:()=>i()},f().createElement(Ue.A,null))),filter:f().createElement(Lt,{setUrl:r}),pageNav:f().createElement(yt,{listResponse:s,setUrl:r})}),f().createElement(mt,{title:"Special cells",cells:Te,loading:!1,message:null,selectedCellInList:e,setSelectedCell:t,fetchCellsListResponse:i}))))}function Mt({cell:e,cellNode:t,onClose:n}){const[r,a]=(0,m.useState)(null);return(0,He.useClickOutside)(n,null,[r,t]),f().createElement(z.A,{ref:a,elevation:12,sx:{position:"absolute",top:20,left:"calc(20px + 300px)",width:380,maxHeight:"calc(100% - 40px)",overflowX:"clip",overflowY:"scroll"}},f().createElement("div",{className:"naavre-workflow-section-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},f().createElement("p",{style:{margin:"0"}},e.title),f().createElement(re.A,{"aria-label":"Close",style:{color:"white",borderRadius:"100%"},onClick:n},f().createElement(ae.A,null))),f().createElement(ne,{cell:e}))}const Nt={chart:S,selectedCellInList:null,selectedCellNode:null};class Pt extends m.Component{constructor(e){super(e),this.state=Nt,this.chartStateActions=(0,p.mapValues)(y,(e=>(...t)=>{const n=e(...t)(this.state.chart);this.setState({chart:{...this.state.chart,...n}})})),this.chartConfig={readonly:!1},this.setSelectedCell=(e,t)=>{this.setState({selectedCellInList:e,selectedCellNode:t})},this.setChart=e=>{this.setState({chart:e})},this.getRunWorkflowDialogOptions=()=>({title:"Run Workflow",body:a.ReactWidget.create(m.createElement(Oe,{chart:this.state.chart})),buttons:[],hasClose:!0}),this.exportWorkflow=async e=>{E("POST",`${this.settings.workflowServiceUrl}/convert`,{},{virtual_lab:this.settings.virtualLab,naavrewf2:this.state.chart}).then((t=>{var n;null===(n=e.tracker.currentWidget)||void 0===n||n.model.upload(new File([t.content],"workflow.yaml"))})).catch((e=>{const t=`Error exporting the workflow: ${String(e)}`;console.log(t),alert(t)}))}}componentDidUpdate(){}render(){return m.createElement(g.A,{theme:A},m.createElement("div",{style:{display:"flex",flexDirection:"row",flex:1,maxWidth:"100vw",maxHeight:"100vh"}},m.createElement("div",{style:{display:"flex",flexDirection:"column",flex:"1",overflow:"hidden"}},m.createElement(v.FlowChart,{chart:this.state.chart,callbacks:this.chartStateActions,config:this.chartConfig,Components:{Node:G,NodeInner:P,Port:D}}),this.state.chart.selected.id&&m.createElement(oe,{chart:this.state.chart,setChart:this.setChart,callbacks:this.chartStateActions,config:this.chartConfig}),this.state.selectedCellInList&&m.createElement(Mt,{cell:this.state.selectedCellInList,cellNode:this.state.selectedCellNode,onClose:()=>this.setSelectedCell(null,null)}),m.createElement(Ft,{selectedCellInList:this.state.selectedCellInList,setSelectedCell:this.setSelectedCell}))))}}Pt.contextType=I;class Ht extends d.DocumentWidget{constructor(e){super(e)}updateSettings(e){this.content.updateSettings(e)}dispose(){this.content.dispose(),super.dispose()}}class $t extends a.ReactWidget{constructor(e){super(),this.settings={},this._onContentChanged=()=>{var e;null===(e=this.composerRef.current)||void 0===e||e.setState({chart:this._model.chart})},this.addClass("vre-composer"),this.composerRef=f().createRef(),this._model=e.model,e.ready.then((e=>{this._model.contentChanged.connect(this._onContentChanged),this._onContentChanged(),this.update()})),this._onContentChanged()}updateSettings(e){this.settings={...this.settings,...e},this.update()}render(){return f().createElement(I.Provider,{value:this.settings},f().createElement(Pt,{ref:this.composerRef}))}dispose(){this.isDisposed||(this._model.contentChanged.disconnect(this._onContentChanged),u.Signal.clearData(this),super.dispose())}onAfterAttach(e){super.onAfterAttach(e),this.node.addEventListener("focusout",this,!0)}onBeforeDetach(e){this.node.removeEventListener("focusout",this,!0),super.onBeforeDetach(e)}handleEvent(e){var t,n;e.preventDefault(),e.stopPropagation(),e.type&&"focusout"===e.type&&(h().isEqual(this._model.chart,null===(t=this.composerRef.current)||void 0===t?void 0:t.state.chart)||(this._model.chart=(null===(n=this.composerRef.current)||void 0===n?void 0:n.state.chart)||S))}}var Vt=n(8e3);class Dt{constructor(e){this.defaultKernelName="",this.defaultKernelLanguage="",this.sharedModel=Wt.create(),this._onClientChanged=()=>{const e=this.sharedModel.awareness.getStates();this._clientChanged.emit(e)},this._onSharedModelChanged=(e,t)=>{t.chartChange&&this.triggerContentChange(),t.stateChange&&t.stateChange.forEach((e=>{"dirty"===e.name?this.dirty=e.newValue:e.oldValue!==e.newValue&&this.triggerStateChange({newValue:void 0,oldValue:void 0,...e})}))},this._dirty=!1,this._isDisposed=!1,this._readOnly=!1,this._clientChanged=new u.Signal(this),this._contentChanged=new u.Signal(this),this._stateChanged=new u.Signal(this);const{collaborationEnabled:t,sharedModel:n}=e;this._collaborationEnabled=!!t,this.sharedModel=n||Wt.create(),this.sharedModel.changed.connect(this._onSharedModelChanged),this.sharedModel.awareness.on("change",this._onClientChanged)}get collaborative(){return this._collaborationEnabled}get dirty(){return this._dirty}set dirty(e){const t=this._dirty;e!==t&&(this._dirty=e,this.triggerStateChange({name:"dirty",oldValue:t,newValue:e}))}get isDisposed(){return this._isDisposed}get readOnly(){return this._readOnly}set readOnly(e){if(e===this._readOnly)return;const t=this._readOnly;this._readOnly=e,this.triggerStateChange({name:"readOnly",oldValue:t,newValue:e})}get clientId(){return this.sharedModel.awareness.clientID}get chart(){return this.sharedModel.get("chart")}set chart(e){this.sharedModel.set("chart",e)}get clientChanged(){return this._clientChanged}get contentChanged(){return this._contentChanged}get stateChanged(){return this._stateChanged}dispose(){this._isDisposed||(this._isDisposed=!0,u.Signal.clearData(this))}toString(){return this.sharedModel.getSource()}fromString(e){this.sharedModel.setSource(e)}toJSON(){return JSON.parse(this.toString()||"null")}fromJSON(e){this.fromString(JSON.stringify(e))}initialize(){}triggerStateChange(e){this._stateChanged.emit(e)}triggerContentChange(){this._contentChanged.emit(void 0),this.dirty=!0}}class Wt extends Vt.YDocument{constructor(){super(),this.version="1.0.0",this._contentObserver=e=>{const t={};e.keysChanged.has("chart")&&(t.chartChange=this._content.get("chart")),this._changed.emit(t)},this._content=this.ydoc.getMap("content"),this._content.observe(this._contentObserver)}getSource(){var e;const t={chart:null!==(e=this.get("chart"))&&void 0!==e?e:S};return JSON.stringify(t,null,2)}setSource(e){let t=S;if(e){const n=JSON.parse(e);t=n.chart}this.transact((()=>{this.set("chart",t)}))}dispose(){this.isDisposed||(this._content.unobserve(this._contentObserver),super.dispose())}static create(){return new Wt}get(e){const t=this._content.get(e);return"chart"===e?t?JSON.parse(t):S:null!=t?t:""}set(e,t){this._content.set(e,["chart"].includes(e)?JSON.stringify(t):t)}}class zt extends d.ABCWidgetFactory{constructor(e){super(e)}createNewWidget(e){return new Ht({context:e,content:new $t(e)})}}class jt{constructor(){this.collaborative=!0,this._disposed=!1}get name(){return"naavrewf-model"}get contentType(){return"naavrewfdoc"}get fileFormat(){return"text"}get isDisposed(){return this._disposed}dispose(){this._disposed=!0}preferredLanguage(e){return""}createNew(e){return new Dt(e)}}var Bt,Zt=n(8222);!function(e){e.createSaveButton=function(e,t){return new a.ToolbarButton({label:"Save",tooltip:"Save the workflow",icon:Zt.saveIcon,onClick:()=>{t.execute("docmanager:save")}})},e.createExportButton=function(e,t){return new a.ToolbarButton({label:"Export",tooltip:"Export the workflow",icon:Zt.codeIcon,onClick:()=>{var n;null===(n=e.content.composerRef.current)||void 0===n||n.exportWorkflow(t)}})},e.createRunButton=function(e){return new a.ToolbarButton({label:"Run",tooltip:"Run the workflow",icon:Zt.runIcon,onClick:()=>{var t;return(0,a.showDialog)(null===(t=e.content.composerRef.current)||void 0===t?void 0:t.getRunWorkflowDialogOptions())}})}}(Bt||(Bt={}));const Jt=new Zt.LabIcon({name:"launcher-icon",svgstr:'<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg\n   width="66.69"\n   height="66.69"\n   viewBox="0 0 66.69 66.69"\n   version="1.1"\n   id="svg5"\n   sodipodi:docname="launcher-icon.svg"\n   inkscape:version="1.4 (e7c3feb100, 2024-10-09)"\n   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"\n   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"\n   xmlns:xlink="http://www.w3.org/1999/xlink"\n   xmlns="http://www.w3.org/2000/svg"\n   xmlns:svg="http://www.w3.org/2000/svg">\n  <sodipodi:namedview\n     id="namedview5"\n     pagecolor="#ffffff"\n     bordercolor="#666666"\n     borderopacity="1.0"\n     inkscape:showpageshadow="2"\n     inkscape:pageopacity="0.0"\n     inkscape:pagecheckerboard="0"\n     inkscape:deskcolor="#d1d1d1"\n     inkscape:zoom="5.6423717"\n     inkscape:cx="12.671976"\n     inkscape:cy="62.739574"\n     inkscape:current-layer="svg5" />\n  <defs\n     id="defs1">\n    <linearGradient\n       id="swatch5"\n       inkscape:swatch="solid">\n      <stop\n         style="stop-color:#3c8f49;stop-opacity:1;"\n         offset="0"\n         id="stop5" />\n    </linearGradient>\n    <style\n       id="style1">\n      .a92fba6e-7ebd-4c32-8963-8296e20ef654 {\n        fill: #0f4e8b;\n      }\n    </style>\n    <linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch5"\n       id="linearGradient5"\n       x1="0"\n       y1="33.352931"\n       x2="66.69"\n       y2="33.352931"\n       gradientUnits="userSpaceOnUse" />\n  </defs>\n  <g\n     id="a472ef7c-dd17-4d49-9df0-027f7f177a8f"\n     data-name="Livello 2"\n     style="fill:url(#linearGradient5)">\n    <g\n       id="b55479a9-ce75-42ce-9f6a-fdbd00d931c6"\n       data-name="Livello 1"\n       style="fill:url(#linearGradient5)">\n      <g\n         id="g5"\n         style="fill:url(#linearGradient5)">\n        <path\n           class="a92fba6e-7ebd-4c32-8963-8296e20ef654"\n           d="M33.34,40.87a5.38,5.38,0,1,0,5.38,5.38,5.39,5.39,0,0,0-5.38-5.38Zm0,8.61a3.23,3.23,0,1,1,3.23-3.23,3.23,3.23,0,0,1-3.23,3.23Z"\n           id="path1"\n           style="fill:url(#linearGradient5)" />\n        <rect\n           class="a92fba6e-7ebd-4c32-8963-8296e20ef654"\n           x="32.27"\n           y="4.3"\n           width="8.6"\n           height="2.15"\n           id="rect1"\n           style="fill:url(#linearGradient5)" />\n        <rect\n           class="a92fba6e-7ebd-4c32-8963-8296e20ef654"\n           x="32.27"\n           y="8.6"\n           width="8.6"\n           height="2.15"\n           id="rect2"\n           style="fill:url(#linearGradient5)" />\n        <rect\n           class="a92fba6e-7ebd-4c32-8963-8296e20ef654"\n           x="25.81"\n           y="12.91"\n           width="15.06"\n           height="2.15"\n           id="rect3"\n           style="fill:url(#linearGradient5)" />\n        <rect\n           class="a92fba6e-7ebd-4c32-8963-8296e20ef654"\n           x="25.81"\n           y="17.21"\n           width="15.06"\n           height="2.15"\n           id="rect4"\n           style="fill:url(#linearGradient5)" />\n        <rect\n           class="a92fba6e-7ebd-4c32-8963-8296e20ef654"\n           x="25.81"\n           y="21.51"\n           width="15.06"\n           height="2.15"\n           id="rect5"\n           style="fill:url(#linearGradient5)" />\n        <path\n           class="a92fba6e-7ebd-4c32-8963-8296e20ef654"\n           d="M66.69,34.42V25.81H51.63v8.61h6.45V45.17H45.17V43.32l-2.64-.88L43.78,40l-4.14-4.14-2.49,1.25-.88-2.64H34.42V28H45.17V15.06H58.08v6L55.62,18.6l-1.53,1.52,5.07,5.06,5.06-5.06L62.7,18.6l-2.47,2.47V12.91H45.17V0H28.6L21.51,7.08v5.83H6.45v8.16L4,18.6,2.47,20.12l5.06,5.06,5.06-5.06L11.07,18.6,8.6,21.07v-6H21.51V28H32.27v6.45H30.42l-.88,2.64-2.49-1.25L22.91,40l1.24,2.49-2.64.88v1.85H8.6V34.42h6.46V25.81H0v8.61H6.45V51.78a4.31,4.31,0,1,0,2.15,0V47.33h6.46v13.1a3.23,3.23,0,1,0,2.15,0V47.33h4.3v1.85l2.64.88-1.24,2.49,4.14,4.14,2.49-1.25.88,2.64h5.85l.88-2.64,2.49,1.25,4.14-4.14-1.25-2.49,2.64-.88V47.33h4.31v13.1a3.23,3.23,0,1,0,2.15,0V47.33h6.45v4.45a4.31,4.31,0,1,0,2.15,0V34.42ZM28,3.67V6.45H25.18ZM23.66,8.6h6.46V2.15H43V25.81H23.66ZM2.15,28H12.91v4.3H2.15Zm7.53,28a2.15,2.15,0,1,1-2.15-2.15,2.15,2.15,0,0,1,2.15,2.15Zm6.45,8.61a1.08,1.08,0,1,1,1.08-1.08,1.08,1.08,0,0,1-1.08,1.08ZM43,47.63l-2.46.82-.19.47c0,.14-.1.28-.16.41L40,49.8l1.16,2.32-1.94,2-2.33-1.16-.46.2-.41.17-.48.18-.82,2.47H32l-.83-2.47-.48-.18-.4-.17-.46-.2-2.33,1.16-1.95-2,1.17-2.32-.21-.47c-.06-.13-.11-.27-.17-.41l-.18-.47-2.47-.82V44.87l2.47-.82.18-.47c.06-.14.11-.28.17-.41l.21-.47-1.17-2.32,1.95-2,2.33,1.16.46-.2.4-.17.48-.18L32,36.57h2.75L35.54,39l.48.18.41.17.46.21,2.33-1.17,1.94,2L40,42.7l.21.47c.06.13.11.27.17.41l.18.47,2.46.83Zm7.53,16.91a1.08,1.08,0,1,1,1.08-1.08,1.08,1.08,0,0,1-1.08,1.08Zm10.76-8.61a2.15,2.15,0,1,1-2.15-2.15,2.15,2.15,0,0,1,2.15,2.15ZM53.78,28H64.54v4.3H53.78Z"\n           id="path5"\n           style="fill:url(#linearGradient5)" />\n      </g>\n    </g>\n  </g>\n</svg>\n'});var Yt,qt;new Zt.LabIcon({name:"panel-icon",svgstr:'<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n\x3c!-- Created with Inkscape (http://www.inkscape.org/) --\x3e\n\n<svg\n   width="20"\n   height="20"\n   version="1.1"\n   viewBox="0 0 5.2916639 5.2916639"\n   xml:space="preserve"\n   id="svg7"\n   sodipodi:docname="extension-icon.svg"\n   inkscape:version="1.4 (e7c3feb100, 2024-10-09)"\n   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"\n   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"\n   xmlns:xlink="http://www.w3.org/1999/xlink"\n   xmlns="http://www.w3.org/2000/svg"\n   xmlns:svg="http://www.w3.org/2000/svg"><defs\n     id="defs7"><linearGradient\n       id="swatch20"\n       inkscape:swatch="solid"><stop\n         style="stop-color:#000000;stop-opacity:1;"\n         offset="0"\n         id="stop20" /></linearGradient><linearGradient\n       id="swatch12"\n       inkscape:swatch="solid"><stop\n         style="stop-color:#000000;stop-opacity:1;"\n         offset="0"\n         id="stop12" /></linearGradient><linearGradient\n       id="swatch9"\n       inkscape:swatch="solid"><stop\n         style="stop-color:#000000;stop-opacity:1;"\n         offset="0"\n         id="stop9" /></linearGradient><linearGradient\n       id="swatch8"\n       inkscape:swatch="solid"><stop\n         style="stop-color:#3c8f49;stop-opacity:1;"\n         offset="0"\n         id="stop8" /></linearGradient><linearGradient\n       id="swatch7"\n       inkscape:swatch="solid"><stop\n         style="stop-color:#000000;stop-opacity:1;"\n         offset="0"\n         id="stop7" /></linearGradient><clipPath\n       clipPathUnits="userSpaceOnUse"\n       id="clipPath33"><path\n         d="M 0,0 H 595.276 V 841.89 H 0 Z"\n         transform="translate(-364.14791,-348.99961)"\n         id="path33" /></clipPath><clipPath\n       clipPathUnits="userSpaceOnUse"\n       id="clipPath40"><path\n         d="M 0,0 H 595.276 V 841.89 H 0 Z"\n         transform="translate(-395.09281,-354.98901)"\n         id="path40" /></clipPath><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient7"\n       x1="92.20253"\n       y1="296.08044"\n       x2="141.51561"\n       y2="296.08044"\n       gradientUnits="userSpaceOnUse"\n       gradientTransform="matrix(20.437953,0,0,20.400997,24.954893,177.72344)" /><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient9"\n       gradientUnits="userSpaceOnUse"\n       x1="92.20253"\n       y1="296.08044"\n       x2="141.51561"\n       y2="296.08044"\n       gradientTransform="matrix(20.437953,0,0,20.400997,24.954893,177.72344)" /><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient10"\n       gradientUnits="userSpaceOnUse"\n       x1="92.20253"\n       y1="296.08044"\n       x2="141.51561"\n       y2="296.08044"\n       gradientTransform="matrix(20.437953,0,0,20.400997,24.95489,177.72344)" /><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient11"\n       gradientUnits="userSpaceOnUse"\n       x1="92.20253"\n       y1="296.08044"\n       x2="141.51561"\n       y2="296.08044"\n       gradientTransform="matrix(20.437953,0,0,20.400997,24.954893,177.72344)" /><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient12"\n       x1="38.725582"\n       y1="239.17892"\n       x2="119.33492"\n       y2="239.17892"\n       gradientUnits="userSpaceOnUse"\n       gradientTransform="matrix(20.437955,0,0,20.400997,24.954895,177.72344)" /><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient13"\n       x1="75.722961"\n       y1="217.14847"\n       x2="82.33754"\n       y2="217.14847"\n       gradientUnits="userSpaceOnUse"\n       gradientTransform="matrix(20.437954,0,0,20.400997,24.954894,177.72344)" /><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient20"\n       x1="31.019951"\n       y1="250.64404"\n       x2="53.045799"\n       y2="250.64404"\n       gradientUnits="userSpaceOnUse"\n       gradientTransform="matrix(20.437954,0,0,20.400997,24.954893,177.72344)" /><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient21"\n       x1="105.01471"\n       y1="250.64404"\n       x2="127.04055"\n       y2="250.64404"\n       gradientUnits="userSpaceOnUse"\n       gradientTransform="matrix(20.437955,0,0,20.400998,24.954894,177.72344)" /><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient22"\n       x1="68.017326"\n       y1="250.64404"\n       x2="90.043175"\n       y2="250.64404"\n       gradientUnits="userSpaceOnUse"\n       gradientTransform="matrix(20.437955,0,0,20.400998,24.954894,177.72344)" /></defs><sodipodi:namedview\n     id="namedview7"\n     pagecolor="#ffffff"\n     bordercolor="#666666"\n     borderopacity="1.0"\n     inkscape:showpageshadow="2"\n     inkscape:pageopacity="0.0"\n     inkscape:pagecheckerboard="0"\n     inkscape:deskcolor="#d1d1d1"\n     inkscape:zoom="27.188668"\n     inkscape:cx="7.3192259"\n     inkscape:cy="21.001397"\n     inkscape:current-layer="g22"\n     showgrid="false"><inkscape:grid\n       id="grid1"\n       units="px"\n       originx="-0.5291664"\n       originy="-0.5291664"\n       spacingx="0.2645832"\n       spacingy="0.2645832"\n       empcolor="#ff3f3f"\n       empopacity="0.25098039"\n       color="#3f3fff"\n       opacity="0.1254902"\n       empspacing="10"\n       enabled="true"\n       visible="false" /></sodipodi:namedview><g\n     id="g22"\n     transform="matrix(0.04892858,0,0,0.04901721,-1.2210061,-8.7115099)"\n     style="stroke-width:5.40265;stroke-dasharray:none"><path\n       id="rect7"\n       style="opacity:1;fill:none;stroke:url(#linearGradient7);stroke-width:5.40263;stroke-miterlimit:8;stroke-dasharray:none;paint-order:stroke fill markers"\n       d="m 27.65618,261.39123 h 21.635064 v 21.58618 H 27.65618 Z"\n       sodipodi:nodetypes="ccccc" /><path\n       id="rect9"\n       style="opacity:1;fill:none;stroke:url(#linearGradient9);stroke-width:5.40263;stroke-miterlimit:8;stroke-dasharray:none;paint-order:stroke fill markers"\n       d="m 65.508951,261.39123 h 21.635064 v 21.58618 H 65.508951 Z"\n       sodipodi:nodetypes="ccccc" /><path\n       id="rect10"\n       style="opacity:1;fill:none;stroke:url(#linearGradient10);stroke-width:5.40263;stroke-miterlimit:8;stroke-dasharray:none;paint-order:stroke fill markers"\n       d="m 103.36172,261.39123 h 21.63507 v 21.58618 h -21.63507 z"\n       sodipodi:nodetypes="ccccc" /><path\n       id="rect11"\n       style="opacity:1;fill:none;stroke:url(#linearGradient11);stroke-width:5.40262;stroke-miterlimit:8;stroke-dasharray:none;paint-order:stroke fill markers"\n       d="M 65.508946,180.42481 V 202.011 H 87.14402 v -21.58619 z" /><path\n       style="opacity:1;fill:none;stroke:url(#linearGradient13);stroke-width:5.40263;stroke-miterlimit:8;stroke-dasharray:none;paint-order:stroke fill markers"\n       d="m 76.324548,210.11006 v 37.78433"\n       id="path11"\n       sodipodi:nodetypes="cc" /><path\n       style="opacity:1;fill:none;stroke:url(#linearGradient12);stroke-width:5.40263;stroke-miterlimit:8;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers"\n       d="M 38.471258,247.89439 V 223.6069 h 75.710452 v 24.28749"\n       id="path12"\n       sodipodi:nodetypes="cccc" /><path\n       style="opacity:1;fill:none;stroke:url(#linearGradient20);stroke-width:5.40263;stroke-miterlimit:8;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers"\n       d="m 26.855112,237.89486 11.716755,11.59659 11.716756,-11.59659"\n       id="path18"\n       inkscape:transform-center-y="-0.28421607"\n       sodipodi:nodetypes="ccc" /><path\n       style="opacity:1;fill:none;stroke:url(#linearGradient21);stroke-width:5.40263;stroke-miterlimit:8;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers"\n       d="m 102.56065,237.89487 11.71676,11.59659 11.71676,-11.59659"\n       id="path19"\n       inkscape:transform-center-y="-0.28421561"\n       sodipodi:nodetypes="ccc" /><path\n       style="opacity:1;fill:none;stroke:url(#linearGradient22);stroke-width:5.40263;stroke-miterlimit:8;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers"\n       d="m 64.707883,237.89487 11.716756,11.59659 11.716756,-11.59659"\n       id="path20"\n       inkscape:transform-center-y="-0.28421561"\n       sodipodi:nodetypes="ccc" /></g></svg>\n'}),function(e){e.createNew="create-vre-composer"}(Yt||(Yt={})),function(e){e.addCommands=function(e,t,n){e.addCommand(Yt.createNew,{label:"Experiment Manager",caption:"Launch Workflow Composition",icon:e=>e.isPalette?void 0:Jt,execute:r=>{var a;return async function(e,t,n){const r=await e.execute("docmanager:new-untitled",{path:t,type:"file",ext:"naavrewf"});if(void 0!==r){const t=await e.execute("docmanager:open",{path:r.path,factory:n});return t.isUntitled=!0,t}}(e,r.cwd||(null===(a=t.tracker.currentWidget)||void 0===a?void 0:a.model.path),n)}})}}(qt||(qt={}));const Kt="NaaVRE workflow editor",Xt=new i.Token("naavrewfDocTracker"),Qt={id:"@naavre/workflow-jupyterlab:plugin",autoStart:!0,requires:[r.ILayoutRestorer,l.ILauncher,o.ITranslator,a.IToolbarWidgetRegistry,s.ISettingRegistry,c.IFileBrowserFactory],optional:[],provides:Xt,activate:(e,t,n,r,l,i,s)=>{let o;console.log("JupyterLab extension @naavre/workflow-jupyterlab is activated!"),qt.addCommands(e.commands,s,Kt),n&&n.add({command:Yt.createNew,category:"VRE Components",rank:0}),l&&(l.registerFactory(Kt,"saveWorkflow",(t=>Bt.createSaveButton(t,e.commands))),l.registerFactory(Kt,"exportWorkflow",(e=>Bt.createExportButton(e,s))),l.registerFactory(Kt,"runWorkflow",(e=>Bt.createRunButton(e))),i&&(o=(0,a.createToolbarFactory)(l,i,Kt,Qt.id,r)));const c=new a.WidgetTracker({namespace:"documents-naavrewf"});function d(e){var t;null===(t=c.currentWidget)||void 0===t||t.updateSettings(e.composite)}t&&t.restore(c,{command:"docmanager:open",args:e=>({path:e.context.path,factory:Kt}),name:e=>e.context.path}),i&&Promise.all([e.restored,i.load(Qt.id)]).then((([,e])=>{d(e),e.changed.connect(d),c.currentChanged.connect((()=>d(e)))})).catch((e=>{console.error("Failed to load settings for @naavre/containerizer-jupyterlab.",e)})),e.docRegistry.addFileType({name:"naavrewf",displayName:"NaaVRE Workflow",mimeTypes:["text/json","application/json"],extensions:[".naavrewf"],fileFormat:"text",contentType:"naavrewfdoc"});const u=new jt;e.docRegistry.addModelFactory(u);const p=new zt({name:Kt,modelName:"naavrewf-model",fileTypes:["naavrewf"],defaultFor:["naavrewf"],toolbarFactory:o});p.widgetCreated.connect(((e,t)=>{t.context.pathChanged.connect((()=>{c.save(t)})),c.add(t)})),e.docRegistry.addWidgetFactory(p)}},en=Qt}}]);