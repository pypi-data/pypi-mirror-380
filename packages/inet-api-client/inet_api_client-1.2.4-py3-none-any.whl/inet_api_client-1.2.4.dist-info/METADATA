Metadata-Version: 2.4
Name: inet-api-client
Version: 1.2.4
Summary: Inet API Client - ç”¨äºè®¿é—®Sky Cloudå¹³å°APIçš„Pythonå®¢æˆ·ç«¯åº“
Home-page: https://github.com/sky-cloud/inet-api-client
Author: Bobby Sheng
Author-email: Bobby Sheng <Bobby@sky-cloud.net>
License: MIT
Project-URL: Homepage, https://github.com/sky-cloud/inet-api-client
Project-URL: Repository, https://github.com/sky-cloud/inet-api-client
Project-URL: Documentation, https://github.com/sky-cloud/inet-api-client/blob/main/README.md
Project-URL: Bug Reports, https://github.com/sky-cloud/inet-api-client/issues
Keywords: inet-api,sky-cloud,api,client,network,management,vlan,vpn
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Classifier: Topic :: Internet :: WWW/HTTP :: HTTP Servers
Classifier: Topic :: System :: Networking
Requires-Python: >=3.8
Description-Content-Type: text/markdown
Requires-Dist: aiohttp>=3.8.0
Requires-Dist: pyjwt>=2.0.0
Requires-Dist: pycryptodome>=3.15.0
Provides-Extra: dev
Requires-Dist: pytest>=7.0.0; extra == "dev"
Requires-Dist: pytest-asyncio>=0.21.0; extra == "dev"
Requires-Dist: black>=22.0.0; extra == "dev"
Requires-Dist: flake8>=5.0.0; extra == "dev"
Requires-Dist: mypy>=1.0.0; extra == "dev"
Dynamic: author
Dynamic: home-page
Dynamic: requires-python

# Inet API Client

Inet API Client æ˜¯ä¸€ä¸ªç”¨äºè®¿é—® Sky Cloud å¹³å° API çš„ Python å®¢æˆ·ç«¯åº“ï¼Œæä¾›å®Œæ•´çš„è®¾å¤‡ç®¡ç†ã€VLAN ç®¡ç†ã€VPN ç®¡ç†ã€å·¥ä½œæµç®¡ç†ç­‰åŠŸèƒ½ã€‚

## âœ¨ ç‰¹æ€§

- ğŸš€ **å¼‚æ­¥ HTTP å®¢æˆ·ç«¯** - åŸºäº aiohttp çš„é«˜æ€§èƒ½å¼‚æ­¥è¯·æ±‚
- ğŸ” **è‡ªåŠ¨è®¤è¯ç®¡ç†** - æ”¯æŒå¤šç§è®¤è¯æ–¹å¼ï¼Œè‡ªåŠ¨å¤„ç† Token åˆ·æ–°
- ğŸ“¦ **å®Œæ•´ API è¦†ç›–** - æ¶µç›– Sky Cloud å¹³å°æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½
- ğŸ”„ **å®Œå…¨å‘åå…¼å®¹** - æ— éœ€ä¿®æ”¹ç°æœ‰è„šæœ¬å³å¯ä½¿ç”¨
- ğŸ›¡ï¸ **é”™è¯¯å¤„ç†** - å®Œå–„çš„å¼‚å¸¸å¤„ç†å’Œé”™è¯¯ä¿¡æ¯
- ğŸ“ **ç±»å‹æç¤º** - å®Œæ•´çš„ç±»å‹æ³¨è§£æ”¯æŒ

## ğŸ“¦ å®‰è£…

```bash
pip install inet-api-client
```

## ğŸš€ å¿«é€Ÿå¼€å§‹
## ğŸ”§ ç¯å¢ƒå˜é‡

æ‚¨å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡æ¥é…ç½®å®¢æˆ·ç«¯ï¼š

```bash
export SKY_API_HOST="192.168.1.100"
export SKY_API_USERNAME="admin"
export SKY_API_PASSWORD="password" 
```

### ä½¿ç”¨å°è£…æ¥å£ç”¨æ³•

```python
import asyncio
from inet_api_client import ApiClient    

async def main():
    
    api_client = ApiClient(host="192.168.1.100")
    await api_client.init_login()
    # è·å–è®¾å¤‡ä¿¡æ¯
    device_info = await client.get_device_by_ip("192.168.1.1")
    print(f"è®¾å¤‡ä¿¡æ¯: {device_info}")
    
    # è·å– VLAN åˆ—è¡¨
    vlan_list = await client.get_vlan_list_simple()
    print(f"VLAN åˆ—è¡¨: {vlan_list}")

# è¿è¡Œå¼‚æ­¥å‡½æ•°
asyncio.run(main())
```

### ç›´æ¥ä½¿ç”¨urlè¯·æ±‚ç”¨æ³•

```python
import asyncio
from inet_api_client import ApiClient

async def main():
    # åˆå§‹åŒ–æ–¹å¼ï¼ˆå®Œå…¨å…¼å®¹ç°æœ‰è„šæœ¬ï¼‰
    api_client = ApiClient()
    await api_client.init_login()
    
    # ä½¿ç”¨ self.url æ„å»º URLï¼ˆå®Œå…¨å…¼å®¹ï¼‰
    url = f"{api_client.url}/api/sky-cmdb/resource/instance/entrust_vpn"
    data = {"page": 0, "size": 10}
    
    # ä½¿ç”¨ self.req() æ–¹æ³•è°ƒç”¨æ¥å£ï¼ˆå®Œå…¨å…¼å®¹ï¼‰
    res = await api_client.req(method="POST", url=url, json=data)
    print(f"API è°ƒç”¨ç»“æœ: {res}")

asyncio.run(main())
```

### è‡ªå®šä¹‰é…ç½®

```python
import asyncio
from inet_api_client import ApiClient

async def main():
    # è‡ªå®šä¹‰é…ç½®
    client = ApiClient(
        host="192.168.1.100",
        port=80,
        protocol="http",
        username="xxx",
        password="xxx",
        timeout=30
    )
    
    await client.init_login()
    
    # ä½¿ç”¨ API
    devices = await client.get_device_list()
    print(f"è®¾å¤‡åˆ—è¡¨: {devices}")

asyncio.run(main())
```

## ğŸ“š API æ–¹æ³•

### è®¾å¤‡ç®¡ç†
- `get_device_list()` - è·å–è®¾å¤‡åˆ—è¡¨
- `get_device_by_ip(ip)` - æ ¹æ® IP è·å–è®¾å¤‡ä¿¡æ¯
- `get_device_by_id(device_id)` - æ ¹æ® ID è·å–è®¾å¤‡ä¿¡æ¯

### VLAN ç®¡ç†
- `get_vlan_list()` - è·å– VLAN åˆ—è¡¨
- `get_vlan_list_simple()` - è·å–ç®€åŒ– VLAN åˆ—è¡¨
- `create_vlan(vlan_data)` - åˆ›å»º VLAN
- `update_vlan(vlan_id, vlan_data)` - æ›´æ–° VLAN

### VPN ç®¡ç†
- `get_vpn_list()` - è·å– VPN åˆ—è¡¨
- `create_vpn(vpn_data)` - åˆ›å»º VPN
- `update_vpn(vpn_id, vpn_data)` - æ›´æ–° VPN

### å·¥ä½œæµç®¡ç†
- `get_workflow_list()` - è·å–å·¥ä½œæµåˆ—è¡¨
- `create_workflow_task(task_data)` - åˆ›å»ºå·¥ä½œæµä»»åŠ¡
- `rollback_pipeline(method, data_id, pipeline_id)` - å›æ»šæµæ°´çº¿

### ä¸šåŠ¡åŸŸç®¡ç†
- `get_sdc_id_list(data)` - è·å–ä¸šåŠ¡åŸŸåˆ—è¡¨
- `get_sdc_detail(method, data)` - è·å–ä¸šåŠ¡åŸŸè¯¦æƒ…


## ğŸ“– ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šæ‰¹é‡ä¸šåŠ¡å¤„ç†

```python
import asyncio
import json
from inet_api_client import ApiClient

async def batch_business_example():
    """æ‰¹é‡ä¸šåŠ¡å¤„ç†ç¤ºä¾‹"""
    api_client = ApiClient()
    await api_client.init_login()
    
    # å¤„ç†ä¸šåŠ¡æ•°æ®
    process_data = {
        "request": [
            {
                "branch": "xxx",
                "customerName": "xxx",
                "idc": "xxx",
                "switch_a": "xxx",
                "interface_a": "xxx",
                "vlan": "12",
                "pvlan": "56",
                "rack": "xxx",
                "unit": "xxx",
            }
        ]
    }
    
    # åˆ›å»ºå·¥ä½œæµä»»åŠ¡
    work_order_id_list = []
    for data in process_data["request"]:
        try:
            res = await api_client.create_workflow_task(data)
            task_id = res.get("data", {}).get("id")
            if task_id:
                work_order_id_list.append(task_id)
        except Exception as e:
            print(f"åˆ›å»ºå·¥ä½œæµä»»åŠ¡å¤±è´¥: {e}")
    
    print(f"æˆåŠŸåˆ›å»º {len(work_order_id_list)} ä¸ªå·¥å•")

asyncio.run(batch_business_example())
```

### ç¤ºä¾‹ 2ï¼šè®¾å¤‡ç®¡ç†

```python
import asyncio
from inet_api_client import ApiClient

async def device_management_example():
    """è®¾å¤‡ç®¡ç†ç¤ºä¾‹"""
    api_client = ApiClient()
    await api_client.init_login()
    # è·å–æ‰€æœ‰è®¾å¤‡
    devices = await client.get_device_list()
    print(f"æ€»è®¾å¤‡æ•°: {len(devices.get('data', {}).get('content', []))}")
    
    # æ ¹æ® IP æŸ¥æ‰¾ç‰¹å®šè®¾å¤‡
    device_info = await client.get_device_by_ip("192.168.1.1")
    print(f"è®¾å¤‡è¯¦æƒ…: {device_info}")

asyncio.run(device_management_example())
```

### ç¤ºä¾‹ 3ï¼šVLAN ç®¡ç†

```python
import asyncio
from inet_api_client import ApiClient

async def vlan_management_example():
    """VLAN ç®¡ç†ç¤ºä¾‹"""
    api_client = ApiClient()
    await api_client.init_login()
    # è·å– VLAN åˆ—è¡¨
    vlan_list = await client.get_vlan_list_simple()
    print(f"VLAN åˆ—è¡¨: {vlan_list}")
    
    # åˆ›å»ºæ–° VLAN
    new_vlan = {
        "name": "xxx",
        "vlan_id": 100,
        "description": "xxx"
    }
    result = await client.create_vlan(new_vlan)
    print(f"åˆ›å»º VLAN ç»“æœ: {result}")

asyncio.run(vlan_management_example())
```

## âš™ï¸ é…ç½®é€‰é¡¹

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `host` | str | ä»ç¯å¢ƒå˜é‡è¯»å– | Sky Cloud æœåŠ¡å™¨åœ°å€ |
| `port` | int | 80 | æœåŠ¡å™¨ç«¯å£ |
| `protocol` | str | "https" | åè®®ç±»å‹ |
| `username` | str | ä»ç¯å¢ƒå˜é‡è¯»å– | ç”¨æˆ·å |
| `password` | str | ä»ç¯å¢ƒå˜é‡è¯»å– | å¯†ç  |
| `timeout` | int | 30 | è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ |

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License
