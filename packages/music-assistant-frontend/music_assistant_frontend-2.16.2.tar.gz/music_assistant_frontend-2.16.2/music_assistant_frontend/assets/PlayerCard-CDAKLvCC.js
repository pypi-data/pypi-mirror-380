import{i as B,N as q,e as f,o as r,aQ as Y,r as G,w as m,aR as j,aA as X,b0 as C,d as H,h as J,q as b,c as v,V as A,D as E,u as n,b8 as w,b as g,g as k,a as $,t as c,b9 as I,b4 as P,m as u,bf as z,p as K,F as Z,be as Q,aU as R,aV as M,aT as V,s as S,$ as x,ba as N,b1 as O,b2 as ee,aZ as ae,bg as le,ad as oe,n as se,E as te,J as U,M as ie,bd as re,b6 as ne,bk as de,aF as ue,k as pe,bh as D,bi as F}from"./index-LFx1jIjH.js";import{B as T}from"./Button-SUce42c3.js";import{M as me}from"./MediaItemThumb-cYqdWFcl.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as ye}from"./VSlider-B0DY4XNd.js";import{V as ve}from"./NowPlayingBadge.vue_vue_type_style_index_0_lang-B4veTxLS.js";const ce={props:{width:String,height:String,style:String,allowWheel:Boolean},emits:["update:model-value"],setup(t,s){const d=B(!0),o=q(()=>({class:"player-volume",hideDetails:!0,trackSize:2,thumbSize:d.value?0:10,step:2,elevation:0,style:`width: ${t.width}; height:${t.height}; display: inline-grid; ${t.style}`})),h=q(()=>({...o.value,...s}));return{isThumbHidden:d,playerVolumeProps:h,onWheel:({deltaY:y})=>{if(!t.allowWheel)return;const a=h.value.step,e=s.attrs["model-value"],p=y<0?a:-a;s.emit("update:model-value",e+p)}}}};function _e(t,s,d,o,h,i){return r(),f(ye,X(o.playerVolumeProps,{onTouchstart:s[0]||(s[0]=y=>o.isThumbHidden=!1),onTouchend:s[1]||(s[1]=y=>o.isThumbHidden=!0),onMouseenter:s[2]||(s[2]=y=>o.isThumbHidden=!1),onMouseleave:s[3]||(s[3]=y=>o.isThumbHidden=!0),onWheel:C(o.onWheel,["prevent"]),onEnd:s[4]||(s[4]=y=>t.$emit("update:model-value",y))}),Y({_:2},[G(t.$slots,(y,a)=>({name:a,fn:m(()=>[j(t.$slots,a,{},void 0,!0)])}))]),1040,["onWheel"])}const W=L(ce,[["render",_e],["__scopeId","data-v-af51e13c"]]),be={key:1,class:"text-caption volumecaption"},fe={key:0,class:"text-caption volumecaption"},ge=H({__name:"VolumeControl",props:{player:{},showSyncControls:{type:Boolean},showSubPlayers:{type:Boolean},showHeadingRow:{type:Boolean},showVolumeControl:{type:Boolean},allowWheel:{type:Boolean}},setup(t){const s=t,d=B([]),o=B([]),h=B(void 0),i=q(()=>s.player.group_members.length>0),y=function(e){const p=[];for(const l of e.group_members){const _=u?.players[l];_&&_.volume_control!=w&&_&&_.available&&!p.includes(_)&&p.push(_)}if(s.showSyncControls&&e.supported_features.includes(R.SET_MEMBERS))for(const l of Object.values(u?.players))l.player_id!=e.player_id&&(!e.can_group_with.includes(l.player_id)&&!e.can_group_with.includes(l.provider)||l.available&&l.type!=z.GROUP&&(l.active_group&&l.active_group!=e.player_id||l.active_source&&l.playback_state==M.PLAYING&&![e.player_id,l.player_id].includes(l.active_source)||p.includes(l)||p.push(l)));return p.sort((l,_)=>l.name.toUpperCase()>_.name.toUpperCase()?1:-1),p},a=async function(e,p){const l=s.player.player_id;p?(o.value.includes(e)&&(o.value=o.value.filter(_=>_!=e)),d.value.includes(e)||d.value.push(e),u.players[l].group_members.push(e)):(d.value.includes(e)&&(d.value=d.value.filter(_=>_!=e)),o.value.includes(e)||o.value.push(e),u.players[l].group_members=u.players[l].group_members.filter(_=>_!=e)),h.value!=null&&clearTimeout(h.value),!(d.value.length==0&&o.value.length==0)&&(h.value=setTimeout(async()=>{u.playerCommandSetMembers(l,d.value.length?d.value:void 0,o.value.length?o.value:void 0).catch(async()=>{u.players[l]=await u.getPlayer(l)}).finally(()=>{d.value=[],o.value=[]})},500))};return(e,p)=>(r(),f(J,{style:{overflow:"hidden",padding:"0"},lines:"two"},{default:m(()=>[e.showHeadingRow?(r(),f(A,{key:0,class:"volumesliderrow heading",link:!1,style:E(e.player.powered==!1?"opacity: 0.6":"opacity: 1")},{prepend:m(()=>[g(k,{size:25,icon:e.player.icon,style:{"margin-left":"6px",opacity:"0.6"}},null,8,["icon"])]),default:m(()=>[$("h5",null,c(n(I)(e.player,27)),1)]),append:m(()=>[e.player.power_control!=n(w)?(r(),f(T,{key:0,class:"powerbtn",variant:"icon",onClick:p[0]||(p[0]=C(l=>n(u).playerCommandPowerToggle(e.player.player_id),["stop"]))},{default:m(()=>[g(k,{size:25,icon:"mdi-power"})]),_:1})):b("",!0)]),_:1},8,["style"])):b("",!0),e.showVolumeControl&&(e.player.volume_control!=n(w)||e.player.group_members.length)?(r(),f(A,{key:1,class:"volumesliderrow",link:!1,style:E(e.player.powered==!1?"opacity: 0.35":"opacity: 0.75")},{prepend:m(()=>[g(T,{icon:"",style:{height:"25px"},disabled:e.player.type==n(z).GROUP||e.player.group_members.length>0||e.player.mute_control==n(w),onClick:p[1]||(p[1]=C(l=>n(u).playerCommandMuteToggle(e.player.player_id),["stop"]))},{default:m(()=>[g(k,{size:25,icon:e.player.volume_muted?"mdi-volume-mute":"mdi-volume-medium"},null,8,["icon"])]),_:1},8,["disabled"])]),default:m(()=>[e.player.volume_control!=n(w)||e.player.group_members.length?(r(),f(W,{key:0,color:"secondary",width:"100%","is-powered":e.player.powered!=!1,disabled:!e.player.available,"model-value":Math.round(e.player.group_members.length?e.player.group_volume:e.player.volume_level||0),onClick:p[2]||(p[2]=C(()=>{},["stop"])),"onUpdate:modelValue":p[3]||(p[3]=l=>e.player.group_members.length>0?n(u).playerCommandGroupVolume(e.player.player_id,l):n(u).playerCommandVolumeSet(e.player.player_id,l))},null,8,["is-powered","disabled","model-value"])):b("",!0)]),append:m(()=>[i.value&&!e.showSubPlayers?(r(),f(k,{key:0,class:"expandbtn"},{default:m(()=>[...p[7]||(p[7]=[P(" mdi-chevron-down ",-1)])]),_:1})):(r(),v("div",be,c(Math.round(e.player.group_members.length?e.player.group_volume:e.player.volume_level||0)),1))]),_:1},8,["style"])):b("",!0),e.showSubPlayers&&(e.player.group_members.length>0||e.showSyncControls)&&y(e.player).length>0?(r(),v("div",{key:2,onClick:p[6]||(p[6]=C(()=>{},["stop"]))},[g(K,{style:{"margin-top":"10px","margin-bottom":"15px"}}),(r(!0),v(Z,null,G(y(e.player),l=>(r(),v("div",{key:l.player_id},[g(A,{class:"volumesliderrow",link:!1,style:E(l.powered!=!1||e.showSyncControls?"opacity: 0.75":"opacity: 0.4"),onClick:p[4]||(p[4]=C(()=>{},["stop"]))},{prepend:m(()=>[g(k,{size:30,icon:l.icon,style:{"margin-left":"6px",opacity:"0.6"}},null,8,["icon"])]),default:m(()=>[$("h6",null,c(n(Q)(l.name,27)),1)]),append:m(()=>[e.showSyncControls?(r(),f(ve,{key:0,ripple:!1,disabled:l.player_id==e.player.player_id||e.player.static_group_members.includes(l.player_id)&&e.player.group_members.includes(l.player_id),"model-value":e.player.group_members.includes(l.player_id)||l.player_id==e.player.player_id,size:"22",class:"checkbox","onUpdate:modelValue":_=>a(l.player_id,_)},null,8,["disabled","model-value","onUpdate:modelValue"])):b("",!0)]),_:2},1032,["style"]),l.volume_control!=n(w)?(r(),f(A,{key:0,class:"volumesliderrow",link:!1,style:E(l.powered==!1?"opacity: 0.4":"opacity: 0.75"),onClick:p[5]||(p[5]=C(()=>{},["stop"]))},{prepend:m(()=>[g(T,{icon:"",disabled:!l.available||l.mute_control==n(w),style:{height:"25px"},onClick:_=>n(u).playerCommandMuteToggle(l.player_id)},{default:m(()=>[g(k,{size:25,icon:l.volume_muted?"mdi-volume-mute":"mdi-volume-medium"},null,8,["icon"])]),_:2},1032,["disabled","onClick"])]),default:m(()=>[l.volume_control!=n(w)?(r(),f(W,{key:0,color:"secondary",width:"100%","is-powered":l.powered!=!1,disabled:!l.available,"allow-wheel":e.allowWheel,"model-value":Math.round(l.volume_level||0),"onUpdate:modelValue":_=>n(u).playerCommandVolumeSet(l.player_id,_)},null,8,["is-powered","disabled","allow-wheel","model-value","onUpdate:modelValue"])):b("",!0)]),append:m(()=>[l.volume_control!=n(w)?(r(),v("div",fe,c(l.volume_level),1)):b("",!0)]),_:2},1032,["style"])):b("",!0),p[8]||(p[8]=$("div",{style:{height:"14px"}},null,-1))]))),128))])):b("",!0)]),_:1}))}}),he=L(ge,[["__scopeId","data-v-407df88f"]]),we=(t,s)=>{const d=[];t?.power_control!=w&&d.push({label:t.powered?"power_off_player":"power_on_player",labelArgs:[],action:()=>{u.playerCommandPowerToggle(t.player_id)},icon:"mdi-power"}),(t?.playback_state=="playing"||t?.playback_state=="paused")&&d.push({label:"stop_playback",labelArgs:[],action:()=>{u.playerCommandStop(t.player_id)},icon:"mdi-stop"});const o=Object.values(u.players).filter(i=>i.player_id!=t.player_id&&i.available&&i.enabled&&(i.can_group_with.includes(t.provider)||i.can_group_with.includes(t.player_id))&&i.supported_features.includes(R.SET_MEMBERS)&&!i.synced_to);t.supported_features.includes(R.SET_MEMBERS)&&!t.synced_to&&t.type==z.PLAYER&&t.group_members.length==0&&o.length>0&&d.push({label:"sync_player_with",labelArgs:[],icon:"mdi-link-variant",subItems:o.map(i=>({label:i.name,labelArgs:[],action:()=>{u.playerCommandGroup(t.player_id,i.player_id)}})).sort((i,y)=>i.label.toUpperCase()>y.label?.toUpperCase()?1:-1)}),s&&d.push({label:s.shuffle_enabled?"shuffle_disable":"shuffle_enable",labelArgs:[],action:()=>{u.queueCommandShuffleToggle(s.queue_id)},icon:s.shuffle_enabled?"mdi-shuffle-disabled":"mdi-shuffle"}),s&&d.push({label:"select_repeat_mode",labelArgs:[],subItems:[{label:"repeat_mode.off",labelArgs:[],action:()=>{u.queueCommandRepeat(s.queue_id,V.OFF)},selected:s.repeat_mode==V.OFF},{label:"repeat_mode.all",labelArgs:[],action:()=>{u.queueCommandRepeat(s.queue_id,V.ALL)},selected:s.repeat_mode==V.ALL},{label:"repeat_mode.one",labelArgs:[],action:()=>{u.queueCommandRepeat(s.queue_id,V.ONE)},selected:s.repeat_mode==V.ONE}],icon:"mdi-repeat"}),s?.items&&d.push({label:"transfer_queue",icon:"mdi-swap-horizontal",subItems:Object.values(u.players).filter(i=>i.player_id!=s.queue_id&&i.player_id!=t.player_id&&i.available&&i.enabled&&!i.synced_to).map(i=>({label:i.name,labelArgs:[],action:()=>{u.queueCommandTransfer(s.queue_id,i.player_id),S.activePlayerId=i.player_id}})).sort((i,y)=>i.label.toUpperCase()>y.label?.toUpperCase()?1:-1)}),s?.items&&d.push({label:"queue_clear",labelArgs:[],action:()=>{u.queueCommandClear(s.queue_id)},icon:"mdi-cancel"});const h=t.source_list.filter(i=>!i.passive||i.id==t.active_source);return t.active_source!=t.player_id&&h.push({id:t.player_id,name:x("music_assistant_source"),passive:!1,can_play_pause:!0,can_seek:!0,can_next_previous:!0}),!t.synced_to&&h.length>0&&d.push({label:"select_source",labelArgs:[],icon:"mdi-import",subItems:h.map(i=>({label:i.name,labelArgs:[],disabled:i.id==t.active_source,selected:i.id==t.active_source,action:()=>{u.playerCommandGroupSelectSource(t.player_id,i.id)}})).sort((i,y)=>i.label.toUpperCase()>y.label?.toUpperCase()?1:-1)}),s&&"dont_stop_the_music_enabled"in s&&d.push({label:s.dont_stop_the_music_enabled?"dont_stop_the_music_disable":"dont_stop_the_music_enable",labelArgs:[],action:()=>{u.queueCommandDontStopTheMusicToggle(s.queue_id)},icon:"mdi-all-inclusive"}),d.push({label:"open_player_settings",labelArgs:[],action:()=>{S.showFullscreenPlayer=!1,S.showPlayersMenu=!1,N.push(`/settings/editplayer/${t.player_id}`)},icon:"mdi-cog-outline"}),t.type!==z.GROUP&&d.push({label:"open_dsp_settings",labelArgs:[],action:()=>{S.showFullscreenPlayer=!1,S.showPlayersMenu=!1,N.push(`/settings/editplayer/${t.player_id}/dsp`)},icon:"mdi-equalizer"}),d},ke={class:"player-media-thumb"},Ce={key:1},Se={key:2,class:"icon-thumb"},Ve={key:0,style:{"margin-bottom":"3px"}},Te={key:0},Ae={key:1},Me={key:1},Be={key:0,style:{"font-size":"0.85rem","font-weight":"500","white-space":"nowrap"}},$e={key:0},qe={key:0},ze={key:1},Ee={key:2},Pe={class:"v-list-item-subtitle",style:{"font-size":"0.85rem","white-space":"nowrap"}},Ue={key:0},Ie={key:1},Re={key:2},Le={key:3},Ne={key:4},Oe={key:5},De={key:6},Fe={key:7},We=H({__name:"PlayerCard",props:{player:{},showVolumeControl:{type:Boolean},showMenuButton:{type:Boolean},showSubPlayers:{type:Boolean},showSyncControls:{type:Boolean},allowPowerControl:{type:Boolean}},emits:["click"],setup(t){const s=t,d=q(()=>{if(s.player&&s.player.active_source&&s.player.active_source in u.queues)return u.queues[s.player.active_source];if(s.player&&!s.player.active_source&&s.player.player_id in u.queues)return u.queues[s.player.player_id]}),o=q(()=>{if(d.value&&d.value.active)return d.value.current_item}),h=function(a){pe.emit("contextmenu",{items:we(s.player,d.value),posX:a.clientX,posY:a.clientY})},i=B({0:"",1:"",2:"",3:"",4:"",5:"",lightColor:"",darkColor:""}),y=new Image;return y.src=ae.theme.current.value.dark?O:ee,y.crossOrigin="Anonymous",y.addEventListener("load",function(){i.value=le(y)}),oe(o,a=>{a?.media_item?y.src=D(a.media_item,F.THUMB)||"":a?y.src=D(a,F.THUMB)||"":y.src=""},{immediate:!0}),(a,e)=>(r(),f(se,{flat:"",class:te(["panel-item",{"panel-item-selected":a.player.player_id==n(S).activePlayerId,"panel-item-idle":a.player.playback_state==n(M).IDLE,"panel-item-off":a.player.powered==!1}]),ripple:!1,disabled:!a.player.available,onClick:e[2]||(e[2]=p=>a.$emit("click",a.player))},{default:m(()=>[g(A,{class:"panel-item-details",flat:"",ripple:!1},{prepend:m(()=>[$("div",ke,[a.player.powered!=!1&&o.value?(r(),f(me,{key:0,class:"media-thumb",size:"60",item:o.value,fallback:n(O)},null,8,["item","fallback"])):a.player.powered!=!1&&!d.value&&a.player.current_media?.image_url?(r(),v("div",Ce,[g(ue,{class:"media-thumb",size:"60",src:a.player.current_media.image_url},null,8,["src"])])):(r(),v("div",Se,[g(k,{size:"24",icon:a.player.type==n(z).PLAYER&&a.player.group_members.length?"mdi-speaker-multiple":a.player.icon,style:{display:"table-cell",opacity:"0.8"}},null,8,["icon"])]))])]),title:m(()=>[n(de).player_id===a.player.player_id?(r(),v("div",Ve,[a.player.name=="This Device"?(r(),v("span",Te,c(a.$t("this_device")),1)):(r(),v("span",Ae,c(n(I)(a.player,27)),1)),g(k,{size:"20",class:"ml-2",icon:n(S).deviceType=="phone"?"mdi-cellphone":"mdi-monitor"},null,8,["icon"])])):(r(),v("div",Me,c(n(I)(a.player,27)),1))]),subtitle:m(()=>[a.player.powered!=!1?(r(),v("div",Be,[o.value?.media_item?(r(),v("div",$e,[P(c(o.value?.media_item.name)+" ",1),"version"in o.value?.media_item&&o.value?.media_item.version?(r(),v("span",qe,"("+c(o.value?.media_item.version)+")",1)):b("",!0)])):o.value?(r(),v("div",ze,c(o.value?.name),1)):!d.value&&a.player.current_media?.title?(r(),v("div",Ee,c(a.player.current_media.title),1)):b("",!0)])):b("",!0)]),default:m(()=>[$("div",Pe,[a.player.powered==!1?(r(),v("div",Ue,c(a.$t("off")),1)):o.value?.media_item&&o.value?.media_item?.media_type==n(ie).TRACK&&"album"in o.value?.media_item&&o.value?.media_item.album?(r(),v("div",Ie,c(n(re)(o.value?.media_item.artists))+" â€¢ "+c(o.value?.media_item.album.name),1)):o.value?.media_item&&"artists"in o.value?.media_item&&o.value?.media_item.artists.length>0?(r(),v("div",Re,c(o.value?.media_item.artists[0].name),1)):o.value?.streamdetails?.stream_metadata&&o.value?.streamdetails?.stream_metadata.title&&o.value?.streamdetails?.stream_metadata.artist?(r(),v("div",Le,c(o.value?.streamdetails?.stream_metadata.artist)+" - "+c(o.value?.streamdetails?.stream_metadata.title),1)):o.value?.streamdetails?.stream_metadata&&o.value?.streamdetails?.stream_metadata.title?(r(),v("div",Ne,c(o.value?.streamdetails?.stream_metadata.title),1)):o.value?.media_item?.metadata.description?(r(),v("div",Oe,c(o.value?.media_item.metadata.description),1)):!d.value&&a.player.active_source?(r(),v("div",De,c(a.$t("external_source_active",[n(ne)(a.player)])),1)):d.value?.items==0?(r(),v("div",Fe,c(a.$t("queue_empty")),1)):b("",!0)])]),append:m(()=>[a.player.playback_state==n(M).PAUSED||a.player.playback_state==n(M).PLAYING||d.value?.items?(r(),f(T,{key:0,variant:"icon",class:"player-command-btn",onClick:e[0]||(e[0]=C(p=>{n(u).playerCommandPlayPause(a.player.player_id),n(S).activePlayerId=a.player.player_id},["stop"]))},{default:m(()=>[g(k,{size:n(U)({breakpoint:"phone"})?"30":"32",icon:a.player.playback_state==n(M).PLAYING?"mdi-pause":"mdi-play"},null,8,["size","icon"])]),_:1})):b("",!0),a.player.power_control!=n(w)&&a.allowPowerControl?(r(),f(T,{key:1,variant:"icon",class:"player-command-btn",onClick:e[1]||(e[1]=C(p=>{n(u).playerCommandPowerToggle(a.player.player_id),n(S).activePlayerId=a.player.player_id},["stop"]))},{default:m(()=>[g(k,{size:n(U)({breakpoint:"phone"})?"30":"32"},{default:m(()=>[...e[3]||(e[3]=[P("mdi-power",-1)])]),_:1},8,["size"])]),_:1})):b("",!0),a.showMenuButton?(r(),f(T,{key:2,variant:"icon",class:"player-command-btn",style:{"margin-right":"-5px"},onClick:C(h,["stop"])},{default:m(()=>[g(k,{size:n(U)({breakpoint:"phone"})?"30":"32"},{default:m(()=>[...e[4]||(e[4]=[P("mdi-dots-vertical",-1)])]),_:1},8,["size"])]),_:1})):b("",!0)]),_:1}),a.showVolumeControl?(r(),f(he,{key:0,player:a.player,"show-sync-controls":a.showSyncControls,"show-heading-row":!1,"show-sub-players":a.showSubPlayers,"show-volume-control":a.player.powered!=!1,"allow-wheel":!1},null,8,["player","show-sync-controls","show-sub-players","show-volume-control"])):b("",!0)]),_:1},8,["class","disabled"]))}}),Ke=L(We,[["__scopeId","data-v-2484db6a"]]);export{W as P,he as V,Ke as a,we as g};
