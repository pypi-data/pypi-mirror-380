import{C as xe}from"./Container-CuH2YNr5.js";import{T as et}from"./Toolbar-iQxHKI_C.js";import{x as Be,y as tt,O as at,a2 as it,b as y,D as Ae,E as P,R as lt,G as st,a5 as ot,I as nt,an as rt,ai as ut,d as q,e as d,o as r,aA as re,u as f,b0 as M,m as se,bw as $e,i as A,N as H,bO as K,w as m,q as c,c as h,aF as mt,bN as Ce,bG as oe,b4 as g,t as p,J as U,v as dt,M as $,g as O,a as R,aX as ct,bd as j,bP as pt,be as ft,bQ as Te,bH as Fe,bR as ue,bS as Ve,bK as De,ae as vt,n as yt,bl as ht,V as bt,f as kt,by as Y,s as I,bC as wt,bz as gt,ar as It,l as ie,ad as X,j as St,ao as he,bT as _t,k as be,a_ as z,p as Bt,aR as At,bt as $t,F as ke,r as we,bu as ge,bv as le,bJ as Ct}from"./index-LFx1jIjH.js";import{B as Pe}from"./Button-SUce42c3.js";import{L as Tt}from"./ListItem-DhvO1M3C.js";import{_ as ne,V as Oe}from"./NowPlayingBadge.vue_vue_type_style_index_0_lang-B4veTxLS.js";import{M as Le}from"./MediaItemThumb-cYqdWFcl.js";import{a as W}from"./VBtn-BYKkZzw0.js";import{_ as me}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as Ft,P as Vt}from"./PanelviewItemCompact-Bf82DAtE.js";import{V as Dt}from"./VSpacer-Cg-cZSyv.js";import{V as Pt}from"./VTextField-DyzwZgKh.js";import{a as Ot,V as Lt}from"./VInfiniteScroll-DH2IK80_.js";import{V as Ie,a as Se}from"./VRow-cyJLSUM5.js";import{V as Et}from"./VVirtualScroll-DYZmdOFl.js";import{V as _e}from"./VAlert-Cyb25ra3.js";const Ee=Symbol.for("vuetify:v-item-group"),Mt=tt({...nt(),...ot({selectedClass:"v-item--selected"}),...st(),...lt()},"VItemGroup"),Me=Be()({name:"VItemGroup",props:Mt(),emits:{"update:modelValue":S=>!0},setup(S,l){let{slots:b}=l;const{themeClasses:w}=at(S),{isSelected:s,select:k,next:_,prev:C,selected:a}=it(S,Ee);return()=>y(S.tag,{class:P(["v-item-group",w.value,S.class]),style:Ae(S.style)},{default:()=>[b.default?.({isSelected:s,select:k,next:_,prev:C,selected:a.value})]})}}),L=Be()({name:"VItem",props:rt(),emits:{"group:selected":S=>!0},setup(S,l){let{slots:b}=l;const{isSelected:w,select:s,toggle:k,selectedClass:_,value:C,disabled:a}=ut(S,Ee);return()=>b.default?.({isSelected:w.value,selectedClass:_.value,select:s,toggle:k,value:C.value,disabled:a.value})}}),Re=q({__name:"FavoriteButton",props:{item:{}},setup(S){const l=S;return(b,w)=>(r(),d(Pe,re(l,{variant:"icon",icon:b.item?.favorite?"mdi-heart":"mdi-heart-outline",title:b.$t("tooltip.favorite"),onClick:[w[0]||(w[0]=s=>f(se).toggleFavorite(b.item)),w[1]||(w[1]=M(()=>{},["prevent"])),w[2]||(w[2]=M(()=>{},["stop"]))]}),null,16,["icon","title"]))}}),Rt={key:0,class:"media-thumb listitem-media-thumb"},Kt={key:1,class:"media-thumb listitem-media-thumb"},Nt={key:0},Yt={key:0},zt={key:0,class:"line-clamp-1"},Gt={key:1},Xt={key:0},Ht={key:1},Ut={key:2},jt={key:3},Wt={key:4},qt={key:5},Jt={key:6},Qt={key:7},Zt={key:5},xt={key:6},ea={class:"text-caption",style:{"padding-right":"10px","padding-left":"10px"}},ta=q({__name:"ListviewItem",props:{item:{},showTrackNumber:{type:Boolean,default:!0},showDiscNumber:{type:Boolean,default:!0},showPosition:{type:Boolean,default:!0},showProvider:{type:Boolean,default:!0},showAlbum:{type:Boolean,default:!0},showMenu:{type:Boolean,default:!0},showFavorite:{type:Boolean,default:!1},showDuration:{type:Boolean,default:!0},isSelected:{type:Boolean},isDisabled:{type:Boolean,default:!1},isAvailable:{type:Boolean,default:!0},isPlaying:{type:Boolean},showCheckboxes:{type:Boolean,default:!1},showDetails:{type:Boolean},parentItem:{default:void 0}},emits:["select"],setup(S,{emit:l}){const{t:b}=$e(),w=A(!1),s=S,k=H(()=>{if(!("provider_mappings"in s.item))return"";for(const t of s.item.provider_mappings)if(t.audio_format&&t.audio_format.content_type!=null&&[K.DSF,K.FLAC,K.AIFF,K.WAV].includes(t.audio_format.content_type)&&(t.audio_format.sample_rate>48e3||t.audio_format.bit_depth>16))return`${t.audio_format.sample_rate/1e3}kHz ${t.audio_format.bit_depth} bits`;return""}),_=l,C=function(t){const v=t;ue(s.item,v.clientX,v.clientY,s.parentItem)},a=function(t){if(s.showCheckboxes)return;const v=t;Ve(s.item,v.clientX,v.clientY,s.parentItem)},T=function(t){s.showCheckboxes||De(s.item,t.clientX,t.clientY,s.parentItem)};return(t,v)=>(r(),d(Tt,{link:"","show-menu-btn":t.showMenu,class:P({unavailable:!t.isAvailable}),onClick:M(a,["stop"]),onMenu:M(C,["stop"])},{prepend:m(()=>[t.showCheckboxes?(r(),h("div",Rt,[y(Oe,{"model-value":t.isSelected,onClick:v[0]||(v[0]=M(()=>{},["stop"])),"onUpdate:modelValue":v[1]||(v[1]=B=>{B!=null&&_("select",t.item,B)})},null,8,["model-value"])])):(r(),h("div",Kt,[y(Le,{size:"50",item:t.isAvailable?t.item:void 0,class:P({dimmed:w.value})},null,8,["item","class"])])),!t.showCheckboxes&&t.item.is_playable?(r(),d(W,{key:2,class:P({hidden:!w.value}),icon:"mdi-play",variant:"text",size:"small",style:{position:"absolute",left:"14px",bottom:"12px",color:"white","font-size":"18px"},onClick:M(T,["stop"]),onMouseenter:v[2]||(v[2]=B=>w.value=!0),onMouseleave:v[3]||(v[3]=B=>w.value=!1)},null,8,["class"])):c("",!0)]),title:m(()=>[t.item.media_type==f($).FOLDER?(r(),h("span",Nt,[R("span",null,p(f(Te)(t.item,f(b))),1)])):(r(),h("span",{key:1,class:P({"is-playing":t.isPlaying})},[g(p(t.item.name)+" ",1),"version"in t.item&&t.item.version?(r(),h("span",Yt,"("+p(t.item.version)+")",1)):c("",!0)],2)),t.item&&t.item.metadata?(r(),d(f(oe),{key:2,location:"bottom"},{activator:m(({props:B})=>[f(Fe)(t.item.metadata.explicit||!1)?(r(),d(O,re({key:0},B,{icon:"mdi-alpha-e-box",width:"35"}),null,16)):c("",!0)]),default:m(()=>[R("span",null,p(t.$t("tooltip.explicit")),1)]),_:1})):c("",!0)]),subtitle:m(()=>[t.item.media_type==f($).TRACK&&"provider_mappings"in t.item?(r(),h("div",zt,[y(Me,null,{default:m(()=>["artists"in t.item?(r(),d(L,{key:0},{default:m(()=>[g(p(f(j)(t.item.artists,2)),1)]),_:1})):c("",!0),t.showAlbum&&"album"in t.item&&t.item.album?(r(),d(L,{key:1},{default:m(()=>[g(" • "+p(t.item.album.name),1)]),_:1})):c("",!0),t.showDiscNumber&&"disc_number"in t.item&&t.item.disc_number?(r(),d(L,{key:2},{default:m(()=>[y(O,{style:{"margin-left":"5px"},icon:"md:album"}),g(" "+p(t.item.disc_number),1)]),_:1})):c("",!0),t.showTrackNumber&&"track_number"in t.item&&t.item.track_number?(r(),d(L,{key:3},{default:m(()=>[y(O,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),g(" "+p(t.item.track_number),1)]),_:1})):t.showPosition&&"position"in t.item&&t.item.position?(r(),d(L,{key:4},{default:m(()=>[y(O,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),g(" "+p(t.item.position),1)]),_:1})):c("",!0)]),_:1})])):t.item.media_type==f($).ALBUM&&"year"in t.item?(r(),h("div",Gt,[t.item.album_type!=f(pt).UNKNOWN?(r(),h("span",Xt,p(t.$t("album_type."+t.item.album_type))+" • ",1)):c("",!0),R("span",null,p(f(j)(t.item.artists)),1),t.item.year?(r(),h("span",Ht," • "+p(t.item.year),1)):c("",!0)])):"artists"in t.item&&t.item.artists?(r(),h("div",Ut,p(f(j)(t.item.artists)),1)):"owner"in t.item&&t.item.owner?(r(),h("div",jt,p(t.item.owner),1)):"authors"in t.item&&t.item.authors?(r(),h("div",Wt,p(t.item.authors.join(" / ")),1)):"publisher"in t.item&&t.item.publisher?(r(),h("div",qt,p(t.item.publisher),1)):"metadata"in t.item&&t.item.metadata?.description&&[f($).RADIO,f($).PLAYLIST,f($).FOLDER].includes(t.item.media_type)?(r(),h("div",Jt,p(f(ft)(t.item.metadata.description,150)),1)):"media_type"in t.item&&!t.item.provider_mappings?(r(),h("div",Qt,p(t.$t(t.item.media_type)),1)):c("",!0)]),append:m(()=>[t.isPlaying?(r(),d(ne,{key:0})):c("",!0),k.value?(r(),d(mt,{key:1,src:f(Ce),width:"30",class:P(t.$vuetify.theme.current.dark?"hiresicondark":"hiresicon")},{default:m(()=>[y(f(oe),{activator:"parent",location:"bottom"},{default:m(()=>[g(p(k.value),1)]),_:1})]),_:1},8,["src","class"])):c("",!0),f(U)("bp2")&&t.showProvider?(r(),d(dt,{key:2,domain:t.item.media_type==f($).PLAYLIST?t.item.provider_mappings[0].provider_domain:t.item.provider,size:24},null,8,["domain"])):c("",!0),"fully_played"in t.item&&t.item.fully_played?(r(),d(O,{key:3,title:t.$t("item_fully_played")},{default:m(()=>[...v[4]||(v[4]=[g("mdi-check",-1)])]),_:1},8,["title"])):"resume_position_ms"in t.item&&t.item.resume_position_ms?(r(),d(O,{key:4,title:t.$t("item_in_progress")},{default:m(()=>[...v[5]||(v[5]=[g("mdi-clock-fast",-1)])]),_:1},8,["title"])):c("",!0),f(U)("bp3")&&"favorite"in t.item&&t.showFavorite&&!t.$vuetify.display.mobile?(r(),h("div",Zt,[y(Re,{item:t.item},null,8,["item"])])):c("",!0),t.showDuration&&"duration"in t.item&&t.item.duration&&f(U)("bp0")?(r(),h("div",xt,[R("div",null,[R("span",ea,p(f(ct)(t.item.duration)),1)])])):c("",!0)]),_:1},8,["show-menu-btn","class"]))}}),aa=me(ta,[["__scopeId","data-v-9ae0d4eb"]]),ia={key:0},la=["src"],sa={key:0},oa=q({__name:"PanelviewItem",props:{item:{},size:{default:200},isSelected:{type:Boolean},showCheckboxes:{type:Boolean,default:!1},showMediaType:{type:Boolean,default:!1},showActions:{type:Boolean,default:!1},showTrackNumber:{type:Boolean,default:!1},isAvailable:{type:Boolean,default:!0},isPlaying:{type:Boolean},parentItem:{default:void 0}},emits:["select"],setup(S,{emit:l}){const b=S,w=H(()=>{for(const a of b.item.provider_mappings)if(a.audio_format&&a.audio_format.content_type!=null&&[K.DSF,K.FLAC,K.AIFF,K.WAV].includes(a.audio_format.content_type)&&(a.audio_format.sample_rate>48e3||a.audio_format.bit_depth>16))return`${a.audio_format.sample_rate/1e3}kHz ${a.audio_format.bit_depth} bits`;return""}),s=l,k=function(a){if(b.showCheckboxes)return;const T="clientX"in a?a.clientX:a.touches[0].clientX,t="clientY"in a?a.clientY:a.touches[0].clientY;ue(b.item,T,t,b.parentItem)},_=function(a){if(b.showCheckboxes){s("select",b.item,!b.isSelected);return}Ve(b.item,a.clientX,a.clientY,b.parentItem)},C=function(a){b.showCheckboxes||De(b.item,a.clientX,a.clientY,b.parentItem)};return(a,T)=>{const t=gt("hold");return r(),d(Ft,null,{default:m(({isHovering:v,props:B})=>[vt((r(),d(yt,re(B,{tile:"",hover:"",class:["panel-item",{unavailable:!a.isAvailable}],onClick:_,onContextmenu:M(k,["right","prevent"])}),{default:m(()=>[a.showCheckboxes?(r(),d(ht,{key:0,"model-value":a.showCheckboxes,contained:"",scrim:a.isSelected?a.$vuetify.theme.current.dark?"rgba(0,0,0,.75)":"rgba(255,255,255,.75)":"#ffffff00"},{default:m(()=>[y(Oe,{class:"panel-item-checkbox",ripple:!1,"model-value":a.isSelected},null,8,["model-value"])]),_:1},8,["model-value","scrim"])):c("",!0),y(Le,{item:a.isAvailable?a.item:void 0,style:{height:"auto"}},null,8,["item"]),y(bt,{variant:"text",slim:"",tile:"",density:"compact",class:"panel-item-details"},{default:m(()=>[y(kt,null,{default:m(()=>[a.item.media_type==f($).FOLDER?(r(),h("span",ia,[R("span",null,p(f(Te)(a.item,a.$t)),1)])):(r(),h("span",{key:1,class:P({"is-playing":a.isPlaying})},p(a.item.name),3)),"version"in a.item&&a.item.version?(r(),h("span",{key:2,class:P({"is-playing":a.isPlaying})}," - "+p(a.item.version),3)):c("",!0)]),_:1}),"artists"in a.item&&a.item.artists?(r(),d(Y,{key:0,class:"line-clamp-1"},{default:m(()=>[g(p(f(j)(a.item.artists,1)),1)]),_:1})):c("",!0),"authors"in a.item&&a.item.authors?(r(),d(Y,{key:1,class:"line-clamp-1"},{default:m(()=>[g(p(a.item.authors.join(" / ")),1)]),_:1})):"publisher"in a.item&&a.item.publisher?(r(),d(Y,{key:2,class:"line-clamp-1"},{default:m(()=>[g(p(a.item.publisher),1)]),_:1})):"owner"in a.item&&a.item.owner?(r(),d(Y,{key:3,class:"line-clamp-1"},{default:m(()=>[g(p(a.item.owner),1)]),_:1})):a.showMediaType?(r(),d(Y,{key:4,class:"line-clamp-1"},{default:m(()=>[g(p(a.$t(a.item.media_type)),1)]),_:1})):(r(),d(Y,{key:5,class:"line-clamp-1"}))]),_:1}),a.isPlaying&&!a.showActions?(r(),d(ne,{key:1,"icon-style":"position: absolute; right: 5px; bottom: 5px","show-badge":!1})):c("",!0),(v||f(I).isTouchscreen)&&a.isAvailable&&a.item.is_playable?(r(),d(W,{key:2,icon:"mdi-play",color:"primary",fab:"",style:Ae(`position: absolute; right: 15px; bottom: ${a.showActions?90:35}px; opacity: 0.8`),onClick:M(C,["stop"])},null,8,["style"])):c("",!0),a.showActions?(r(),d(wt,{key:3,class:"panel-item-actions"},{default:m(()=>[y(Me,{style:{padding:"0"}},{default:m(()=>[f(Fe)(a.item.metadata.explicit||!1)?(r(),d(L,{key:0},{default:m(()=>[y(O,{size:"30",icon:"mdi-alpha-e-box"})]),_:1})):c("",!0),w.value?(r(),d(L,{key:1},{default:m(()=>[y(O,{class:P(a.$vuetify.theme.current.dark?"hiresicon":"hiresiconinverted")},{default:m(()=>[R("img",{src:f(Ce),width:"30"},null,8,la),y(oe,{activator:"parent",location:"bottom"},{default:m(()=>[g(p(w.value),1)]),_:1})]),_:1},8,["class"])]),_:1})):c("",!0),a.showTrackNumber&&"track_number"in a.item&&a.item.track_number?(r(),d(L,{key:2},{default:m(()=>[y(O,{size:"small",icon:"mdi-music-circle-outline"}),a.item.disc_number?(r(),h("span",sa,p(a.item.disc_number)+"/",1)):c("",!0),g(p(a.item.track_number),1)]),_:1})):"position"in a.item&&a.item.position?(r(),d(L,{key:3},{default:m(()=>[y(O,{size:"small",icon:"mdi-music-circle-outline"}),g(" "+p(a.item.position),1)]),_:1})):c("",!0),f(U)("bp3")?(r(),d(L,{key:4},{default:m(()=>[y(Re,{item:a.item},null,8,["item"])]),_:1})):c("",!0)]),_:1}),a.isPlaying?(r(),d(ne,{key:0,"show-badge":!1})):c("",!0),y(Dt),v||a.$vuetify.display.mobile?(r(),d(Pe,{key:1,variant:"list",icon:"mdi-dots-vertical",style:{"padding-right":"0","margin-right":"-5px"},onClick:M(k,["stop"])})):c("",!0)]),_:2},1024)):c("",!0)]),_:2},1040,["class"])),[[t,k]])]),_:1})}}}),na=me(oa,[["__scopeId","data-v-bb3ba95c"]]),ra={key:0},ua={key:2},ma=q({__name:"ItemsListing",props:{itemtype:{},sortKeys:{default:()=>["name","sort_name"]},showTrackNumber:{type:Boolean,default:!0},showProvider:{type:Boolean,default:Object.keys(se.providers).length>1},showAlbum:{type:Boolean,default:!0},showFavoritesOnlyFilter:{type:Boolean,default:!0},showDuration:{type:Boolean,default:!0},parentItem:{default:void 0},showAlbumArtistsOnlyFilter:{type:Boolean},showSearchButton:{type:Boolean,default:void 0},showRefreshButton:{type:Boolean,default:void 0},showSelectButton:{type:Boolean,default:void 0},showAlbumTypeFilter:{type:Boolean,default:void 0},updateAvailable:{type:Boolean},title:{default:void 0},hideOnEmpty:{type:Boolean,default:!1},showLibraryOnlyFilter:{type:Boolean,default:!1},allowCollapse:{type:Boolean,default:!1},allowKeyHooks:{type:Boolean,default:!1},extraMenuItems:{default:void 0},loadPagedData:{type:Function,default:void 0},loadItems:{type:Function,default:void 0},limit:{default:50},total:{default:void 0},infiniteScroll:{type:Boolean,default:!0},path:{default:void 0},icon:{default:void 0},restoreState:{type:Boolean,default:!1},onTitleClick:{type:Function,default:void 0}},setup(S){const l=S,b=Ct(),{t:w}=$e(),s=A({offset:0,limit:50,sortBy:"name",search:"",libraryOnly:!1}),k=A("list"),_=A(!1),C=A(!1),a=A([]),T=A([]),t=A(!1),v=A([]),B=A(!1),V=A(!1),N=A(!0),E=A(!1),G=A(!1),J=A(!1),de=function(){s.value.search="",_.value=!1},Q=function(){he(()=>{document.getElementById("searchInput")?.focus()})},Ke=function(){_.value?de():(_.value=!0,Q())},Z=function(){if(l.onTitleClick){l.onTitleClick();return}N.value=!N.value;const e=`${l.path}.${l.itemtype}`;localStorage.setItem(`expand.${e}`,N.value.toString())},x=function(e){k.value=e;const o=`${l.path}.${l.itemtype}`;localStorage.setItem(`viewMode.${o}`,e)},Ne=function(){s.value.favoritesOnly=!s.value.favoritesOnly;const e=s.value.favoritesOnly?"true":"false",o=`${l.path}.${l.itemtype}`;localStorage.setItem(`favoriteFilter.${o}`,e),D(void 0,void 0,!0)},Ye=function(){s.value.libraryOnly=!s.value.libraryOnly;const e=s.value.libraryOnly?"true":"false",o=`${l.path}.${l.itemtype}`;localStorage.setItem(`libraryFilter.${o}`,e),D(!0,void 0,!0)},ze=function(){s.value.albumArtistsFilter=!s.value.albumArtistsFilter;const e=s.value.albumArtistsFilter?"true":"false",o=`${l.path}.${l.itemtype}`;localStorage.setItem(`albumArtistsFilter.${o}`,e),D(void 0,void 0,!0)},ee=function(e){return v.value.includes(e)},te=function(e,o){const i=I.curQueueItem?.media_item;if(!i)return!1;switch(o){case"tracks":return e.item_id===i.item_id;case"albums":return"album"in i?e.item_id===i.album.item_id:!1;case"artists":return"artists"in i?Array.isArray(i.artists)&&i.artists.some(n=>n.item_id===e.item_id):!1;case"radios":return e.item_id===i.item_id;case"podcasts":return"podcast"in i?e.item_id===i.podcast.item_id:!1;case"podcastepisodes":return e.item_id===i.item_id;default:return!1}},ae=function(e,o){if(o)v.value.includes(e)||v.value.push(e);else for(let i=0;i<v.value.length;i++)v.value[i]===e&&v.value.splice(i,1)},Ge=function(){V.value&&(v.value=[]),V.value=!V.value},Xe=function(){D(!0,!0)},He=function(){s.value.search="",_.value=!1,D(void 0,void 0,!0)},Ue=function(e){e!==void 0&&(s.value.sortBy=e);const o=`${l.path}.${l.itemtype}`;localStorage.setItem(`sortBy.${o}`,s.value.sortBy),D(void 0,void 0,!0)},je=function(e){s.value.albumType?.includes(e)?s.value.albumType=s.value.albumType?.filter(i=>i!==e):(s.value.albumType=s.value.albumType||[],s.value.albumType.push(e));const o=`${l.path}.${l.itemtype}`;localStorage.setItem(`albumType.${o}`,s.value.albumType.join(",")),D(void 0,void 0,!0)},We=function(){I.globalSearchTerm=s.value.search,l.itemtype=="artists"?I.globalSearchType=$.ARTIST:l.itemtype=="albums"?I.globalSearchType=$.ALBUM:l.itemtype=="tracks"?I.globalSearchType=$.TRACK:l.itemtype=="playlists"?I.globalSearchType=$.PLAYLIST:l.itemtype=="audiobooks"?I.globalSearchType=$.AUDIOBOOK:l.itemtype=="podcasts"?I.globalSearchType=$.PODCAST:l.itemtype=="radios"&&(I.globalSearchType=$.RADIO),b.push({name:"search"})},ce=async function({done:e}){if(E.value){e("empty");return}await D(void 0,void 0,void 0,s.value.offset+l.limit),e("ok")},qe=async function(){for(;!E.value;)await ce({done:function(){}})},pe=H(()=>{var e=!1;return s.value.search&&s.value.search.length!==0&&(e=!0),e}),fe=H(()=>_.value&&N.value);It(()=>{fe.value||(C.value=!1)});const Je=H(()=>{if(l.allowCollapse===!0&&!N.value)return[{label:"tooltip.collapse_expand",icon:"mdi-chevron-down",action:Z,overflowAllowed:!1}];const e=[];return l.showSelectButton!==!1&&(V.value&&e.push({label:"tooltip.select_all",icon:"mdi-select-all",action:ye}),e.push({label:"tooltip.select_items",icon:V.value?"mdi-checkbox-multiple-outline":"mdi-checkbox-multiple-blank-outline",action:Ge,active:V.value})),l.showLibraryOnlyFilter===!0&&e.push({label:"tooltip.filter_library",icon:"mdi-bookshelf",action:Ye,active:s.value.libraryOnly}),l.showFavoritesOnlyFilter===!0&&e.push({label:"tooltip.filter_favorites",icon:s.value.favoritesOnly?"mdi-heart":"mdi-heart-outline",action:Ne,active:s.value.favoritesOnly}),l.showAlbumArtistsOnlyFilter===!0&&e.push({label:"tooltip.album_artist_filter",icon:s.value.albumArtistsFilter?"mdi-account-music":"mdi-account-music-outline",action:ze,active:s.value.albumArtistsFilter}),l.showAlbumTypeFilter&&e.push({label:"tooltip.album_type",icon:"mdi-album",disabled:t.value,subItems:["album","single","ep","compilation","live","soundtrack","unknown"].map(o=>({label:`album_type.${o}`,selected:s.value.albumType?.includes(o),action:()=>{je(o)}}))}),(l.showRefreshButton!==!1||B.value)&&e.push({label:B.value?"tooltip.refresh_new_content":"tooltip.refresh",icon:"mdi-refresh",action:Xe,active:B.value,disabled:t.value}),l.sortKeys?.length&&e.push({label:"tooltip.sort_options",icon:"mdi-sort",disabled:l.sortKeys.length<=1||t.value,subItems:l.sortKeys.map(o=>({label:`sort.${o}`,selected:s.value.sortBy==o,action:()=>{Ue(o)}}))}),l.showSearchButton!==!1&&e.push({label:pe.value?"tooltip.search_filter_active":"tooltip.search",icon:"mdi-magnify",action:Ke,active:pe.value,disabled:t.value}),e.push({label:"tooltip.toggle_view_mode",icon:k.value=="list"?"mdi-view-list":"mdi-grid",subItems:[{label:"view.list",icon:"mdi-view-list",selected:k.value=="list",action:()=>{x("list")}},{label:"view.panel",icon:"mdi-grid",selected:k.value=="panel",action:()=>{x("panel")}},{label:"view.panel_compact",icon:"mdi-grid",selected:k.value=="panel_compact",action:()=>{x("panel_compact")}}]}),l.extraMenuItems?.length&&e.push(...l.extraMenuItems),l.allowCollapse===!0&&e.push({label:"tooltip.collapse_expand",icon:"mdi-chevron-up",action:Z}),e}),D=async function(e=!1,o=!1,i=!1,n=0){if(!t.value){if(t.value=!0,i&&l.loadPagedData!=null&&(e=!0),(e||o)&&(n=0,E.value&&(J.value=!0),E.value=!1,G.value=!1,B.value=!1),s.value.offset=n,s.value.limit=l.limit,s.value.refresh=o,l.loadPagedData!=null){const u=await l.loadPagedData(s.value);s.value.offset?a.value.push(...u):a.value=u,Math.abs(u.length-l.limit)>10&&(E.value=!0)}else if(l.loadItems!=null){(!G.value||o)&&(T.value=await l.loadItems(s.value),G.value=!0);const u=Ze(T.value,s.value);s.value.offset?a.value.push(...u):a.value=u,E.value=u.length<l.limit}s.value.refresh=!1,t.value=!1,J.value=!1}},Qe=async function(){const e=`${l.path}.${l.itemtype}`,o=localStorage.getItem(`viewMode.${e}`);o&&o!=="null"?k.value=o:l.itemtype=="artists"||l.itemtype=="albums"?k.value="panel":k.value="list";const i=localStorage.getItem(`sortBy.${e}`);if(i&&i!=="null"&&l.sortKeys.includes(i)?s.value.sortBy=i:s.value.sortBy=l.sortKeys[0],l.showFavoritesOnlyFilter!==!1){const n=localStorage.getItem(`favoriteFilter.${e}`);n&&n=="true"&&(s.value.favoritesOnly=!0)}if(l.showLibraryOnlyFilter!==!1){const n=localStorage.getItem(`libraryFilter.${e}`);n&&n=="true"&&(s.value.libraryOnly=!0)}if(l.showAlbumArtistsOnlyFilter!==!1){const n=localStorage.getItem(`albumArtistsFilter.${e}`);n&&(s.value.albumArtistsFilter=n=="true")}if(l.allowCollapse!==!1){const n=localStorage.getItem(`expand.${e}`);n&&(N.value=n=="true")}if(l.showAlbumTypeFilter===!0){const n=localStorage.getItem(`albumType.${e}`);n&&(s.value.albumType=n.split(","))}if(l.restoreState){let n=`search.${e}`;l.parentItem&&(n+=l.parentItem.item_id);const u=localStorage.getItem(n);u&&u!=="null"&&(s.value.search=u)}},ve=function(e){I.dialogActive||t.value||(e.key==="Escape"&&de(),!C.value&&(e.key==="a"&&(e.ctrlKey||e.metaKey)?(e.preventDefault(),ye()):!C.value&&e.key=="Backspace"?Q():!C.value&&e.key.length==1&&(_.value=!0,Q())))};l.allowKeyHooks&&(document.addEventListener("keydown",ve),ie(()=>{document.removeEventListener("keydown",ve)})),l.restoreState&&ie(()=>{const e=l.path||l.itemtype,o=document.querySelector("#cont");I.prevState={path:e,scrollPos:o?.scrollTop||0,pagedItems:a.value,allItems:T.value,allItemsReceived:E.value,initialDataReceived:G.value,params:s.value}}),X(()=>s.value.search,e=>{e&&(_.value=!0),D(void 0,void 0,!0);let o=`search.${l.path}.${l.itemtype}`;l.parentItem&&(o+=l.parentItem.item_id),localStorage.setItem(o,s.value.search)}),X(()=>l.path,e=>{t.value!=!0&&(a.value=[],T.value=[],D(!0))}),X(()=>l.parentItem,()=>{t.value!=!0&&(T.value=[],B.value=!0)},{deep:!0}),X(()=>l.limit,e=>{s.value.limit=e}),X(()=>l.updateAvailable,e=>{t.value||(B.value=e)},{immediate:!0}),St(async()=>{Qe();const e=l.path||l.itemtype;l.restoreState&&I.prevState?.path==e?(s.value=I.prevState.params,a.value=I.prevState.pagedItems,T.value=I.prevState.allItems,E.value=I.prevState.allItemsReceived,G.value=I.prevState.initialDataReceived,he(()=>{const i=document.getElementById("cont");i&&_t(i,I.prevState.scrollPos,50)}),t.value=!1):D(!0),be.on("clearSelection",()=>{v.value=[],V.value=!1});const o=se.subscribe_multi([z.MEDIA_ITEM_UPDATED,z.MEDIA_ITEM_DELETED,z.MEDIA_ITEM_PLAYED],i=>{if(i.event==z.MEDIA_ITEM_DELETED)a.value=a.value.filter(n=>n.uri!=i.object_id);else if(i.event==z.MEDIA_ITEM_UPDATED){const n=a.value.findIndex(u=>u.uri==i.object_id);n>=0&&(a.value[n]=i.data)}else if(i.event==z.MEDIA_ITEM_PLAYED){const n=a.value.findIndex(u=>u.uri==i.object_id);n>=0&&("fully_played"in a.value[n]&&(a.value[n].fully_played=i.data.fully_played),"resume_position_ms"in a.value[n]&&(a.value[n].resume_position_ms=i.data.seconds_played*1e3))}});ie(()=>{be.off("clearSelection"),o()})});const F=function(e,o=!1){return e?"translation_key"in e&&e.translation_key&&e.name?w(e.translation_key,[e.name]):"translation_key"in e&&e.translation_key?w(e.translation_key):o&&"sort_name"in e&&e.sort_name?e.sort_name:e.name:""},Ze=function(e,o){let i=[];if(o.search){const n=o.search.toLowerCase();for(const u of e)(u.name.toLowerCase().includes(n)||"album"in u&&u.album?.name.toLowerCase().includes(n)||"artists"in u&&u.artists&&u.artists.length&&u.artists[0].name.toLowerCase().includes(n))&&i.push(u)}else i=[...e];return o.sortBy=="name"&&i.sort((n,u)=>F(n).localeCompare(F(u),void 0,{numeric:!0})),o.sortBy=="sort_name"&&i.sort((n,u)=>F(n,!0).localeCompare(F(u,!0),void 0,{numeric:!0})),o.sortBy=="name_desc"&&i.sort((n,u)=>F(u).localeCompare(F(n),void 0,{numeric:!0})),o.sortBy=="sort_name_desc"&&i.sort((n,u)=>F(u,!0).localeCompare(F(n,!0),void 0,{numeric:!0})),o.sortBy=="album"&&i.sort((n,u)=>F(n.album).localeCompare(F(u.album),void 0,{numeric:!0})),o.sortBy=="artist"&&i.sort((n,u)=>F(n.artists[0]).localeCompare(F(u.artists[0]))),o.sortBy=="track_number"&&(i.sort((n,u)=>(n.track_number||0)-(u.track_number||0)),i.sort((n,u)=>(n.disc_number||0)-(u.disc_number||0))),o.sortBy=="position"&&i.sort((n,u)=>(n.position||0)-(u.position||0)),o.sortBy=="position_desc"&&i.sort((n,u)=>(u.position||0)-(n.position||0)),o.sortBy=="year"&&i.sort((n,u)=>(n.year||0)-(u.year||0)),o.sortBy=="year_desc"&&i.sort((n,u)=>(u.year||0)-(n.year||0)),o.sortBy=="recent"&&i.sort((n,u)=>(u.timestamp_added||0)-(n.timestamp_added||0)),o.sortBy=="duration"&&i.sort((n,u)=>(n.duration||0)-(u.duration||0)),o.sortBy=="duration_desc"&&i.sort((n,u)=>(u.duration||0)-(n.duration||0)),o.sortBy=="provider"&&i.sort((n,u)=>n.provider.localeCompare(u.provider)),o.favoritesOnly&&(i=i.filter(n=>n.favorite)),o.albumType&&o.albumType.length>0&&(i=i.filter(n=>o.albumType?.includes(n.album_type))),i.slice(o.offset,o.offset+o.limit)},ye=async function(){let e=!0;(l.total||T.value.length)>250&&(e=await new Promise(i=>{confirm(w("select_all_confirmation"))?i(!0):i(!1)})),e&&(await qe(),v.value=a.value,V.value=!0)};return(e,o)=>e.hideOnEmpty&&a.value.length==0?c("",!0):(r(),h("section",ra,[y(et,{icon:e.icon,title:e.title,count:s.value.search?a.value.length:e.total||T.value.length,color:"transparent","menu-items":Je.value,onTitleClicked:Z},{title:m(()=>[At(e.$slots,"title",{},()=>[g(p(e.title),1)],!0)]),_:3},8,["icon","title","count","menu-items"]),y(Bt),fe.value?(r(),d(Pt,{key:0,id:"searchInput",modelValue:s.value.search,"onUpdate:modelValue":o[0]||(o[0]=i=>s.value.search=i),clearable:"","prepend-inner-icon":"mdi-magnify",label:e.$t("search"),"hide-details":"",variant:"filled",style:{width:"auto","margin-top":"10px"},onFocus:o[1]||(o[1]=i=>C.value=!0),onBlur:o[2]||(o[2]=i=>C.value=!1),"onClick:clear":He},null,8,["modelValue","label"])):c("",!0),N.value?(r(),d(xe,{key:1,variant:k.value=="list"?"default":"panel",style:{overflow:"hidden"}},{default:m(()=>[t.value?(r(),d($t,{key:0,color:"accent",height:"4",indeterminate:"",rounded:""})):c("",!0),!J.value&&!(a.value.length==0&&E.value)?(r(),d(Ot,{key:1,onLoad:ce,mode:e.infiniteScroll?"intersect":"manual","load-more-text":e.$t("load_more_items"),"empty-text":"",style:{overflow:"hidden"}},{default:m(()=>[k.value=="panel"?(r(),d(Ie,{key:0},{default:m(()=>[(r(!0),h(ke,null,we(a.value,i=>(r(),d(Se,{key:i.uri,cols:"12",class:P(`col-${f(ge)(e.$vuetify.display.width)}`)},{default:m(()=>[y(na,{item:i,"is-selected":ee(i),"show-checkboxes":V.value,"show-actions":["tracks","albums","albumtracks"].includes(e.itemtype),"show-track-number":e.showTrackNumber,"is-available":f(le)(i),"is-playing":te(i,e.itemtype),"parent-item":e.parentItem,onSelect:ae},null,8,["item","is-selected","show-checkboxes","show-actions","show-track-number","is-available","is-playing","parent-item"])]),_:2},1032,["class"]))),128))]),_:1})):c("",!0),k.value=="panel_compact"?(r(),d(Ie,{key:1},{default:m(()=>[(r(!0),h(ke,null,we(a.value,i=>(r(),d(Se,{key:i.uri,cols:"12",class:P(`col-${f(ge)(e.$vuetify.display.width)}`)},{default:m(()=>[y(Vt,{item:i,"is-selected":ee(i),"show-checkboxes":V.value,"is-available":f(le)(i),"is-playing":te(i,e.itemtype),"parent-item":e.parentItem,onSelect:ae},null,8,["item","is-selected","show-checkboxes","is-available","is-playing","parent-item"])]),_:2},1032,["class"]))),128))]),_:1})):c("",!0),k.value=="list"?(r(),d(Et,{key:2,"item-height":70,height:"100%",items:a.value,style:{height:"100%",overflow:"hidden"}},{default:m(({item:i})=>[y(aa,{item:i,"show-track-number":e.showTrackNumber,"show-disc-number":e.showTrackNumber,"show-duration":e.showDuration,"show-favorite":e.showFavoritesOnlyFilter,"show-menu":i.is_playable,"show-provider":e.showProvider,"show-album":e.showAlbum,"show-checkboxes":V.value,"is-selected":ee(i),"is-available":f(le)(i),"is-playing":te(i,e.itemtype),"show-details":e.itemtype.includes("versions"),"parent-item":e.parentItem,onSelect:ae},null,8,["item","show-track-number","show-disc-number","show-duration","show-favorite","show-menu","show-provider","show-album","show-checkboxes","is-selected","is-available","is-playing","show-details","parent-item"])]),_:1},8,["items"])):c("",!0)]),_:1},8,["mode","load-more-text"])):c("",!0),!t.value&&a.value.length==0?(r(),h("div",ua,[!t.value&&a.value.length==0&&(s.value.search||s.value.favoritesOnly)?(r(),d(_e,{key:0,title:e.$t("no_content_filter")},{default:m(()=>[s.value.search?(r(),d(W,{key:0,style:{"margin-top":"15px"},onClick:We},{default:m(()=>[g(p(e.$t("try_global_search")),1)]),_:1})):c("",!0)]),_:1},8,["title"])):!t.value&&a.value.length==0?(r(),d(_e,{key:1},{default:m(()=>[g(p(e.$t("no_content")),1)]),_:1})):c("",!0)])):c("",!0),y(Lt,{"model-value":v.value.length>1,timeout:-1,style:{"margin-bottom":"120px"}},{actions:m(()=>[y(W,{color:"primary",variant:"text",onClick:o[3]||(o[3]=i=>f(ue)(v.value,i.clientX,i.clientY,e.parentItem))},{default:m(()=>[g(p(e.$t("actions")),1)]),_:1})]),default:m(()=>[R("span",null,p(e.$t("items_selected",[v.value.length])),1)]),_:1},8,["model-value"])]),_:1},8,["variant"])):c("",!0)]))}}),$a=me(ma,[["__scopeId","data-v-551a2a2b"]]);export{$a as I};
