{% include 'header.html' %}
<main class="dashboard">
    {% if error or request.args.get('error') or message %}
    <section class="notifications">
        {% if error %}
        <div class="notification error">{{ _(error) }}</div>
        {% endif %}
        {% if request.args.get('error') %}
        <div class="notification error">{{ _(request.args.get('error')) }}</div>
        {% endif %}
        {% if message %}
        <div class="notification message">{{ _(message) }}</div>
        {% endif %}
    </section>
    {% endif %}

    <h1 class="dashboard-title">{% if g.mode == "single" %}{{ _('your_blog') }}{% else %}{{ _('your_blogs') }}{% endif %}</h1>
    
    {% if g.mode == "multi" %}
    <p class="blog-count">{{ blogs | count }}/{{ g.blog_limit }}</p>
    {% endif %}

    <section class="blogs-list">
        {% for blog in blogs %}
        <article class="blog-card">
            <header class="blog-card-header">
                <h2 class="blog-name">
                    {% if blog.favicon != "" %}
                    <span class="blog-favicon">{{ blog.favicon }}</span>
                    {% endif %}
                    {{ blog.title }}
                </h2>
                <p class="blog-title">{{ blog.name }}</p>
            </header>
            <div class="blog-url">
                <a href="{% if g.mode == 'multi' %}{% if blog.access == 'path' %}https://{{ g.main_domain }}/b/{{ blog.name }}{% else %}https://{{ blog.name }}.{{ g.main_domain }}/{% endif %}{% else %}http://{{ g.main_domain }}{% endif %}" target="_blank">
                    {% if g.mode == 'multi' %}
                    {% if blog.access == 'path' %}https://{{ g.main_domain }}/b/{{ blog.name }}{% else %}https://{{ blog.name }}.{{ g.main_domain }}/{% endif %}
                    {% else %}
                    {{ g.main_domain }}
                    {% endif %}
                </a>
            </div>
            <div class="blog-actions">
                <a href="/dashboard/edit/{{ blog.name }}" class="btn btn-edit">{{ _('edit') }}</a>
                <a href="/dashboard/post/{{ blog.name }}" class="btn btn-new-post">{{ _('new_post') }}</a>
                <a href="/dashboard/stats/{{ blog.name }}#7d" class="btn btn-stats">{{ _('statistics') }}</a>
                {% if g.mode == "multi" %}
                <a href="/dashboard/delete/{{ blog.name }}" class="btn btn-delete" onclick="return confirm('{{ _('are_you_sure_blog') }} {{ blog.name }}?\n{{ _('this_action_cannot_be_reverted') }}.')">{{_('delete_blog') }}</a>
                {% endif %}
            </div>
        </article>
        {% endfor %}
    </section>

    <section class="dashboard-settings">
        <h2 class="settings-title">{{ _('settings') }}</h2>
        <div class="settings-actions">
            {% if g.mode == "multi" and blogs | count < g.blog_limit | int %}
            <a href="/dashboard/create" class="btn btn-create">{{ _('create_new_blog') }}</a>
            {% endif %}
            <a href="/dashboard/changepw" class="btn btn-change-pw">{{ _('change_password') }}</a>
            <a href="/dashboard/import" class="btn btn-import">{{ _('migrate_posts') }}</a>
        </div>
    </section>
</main>

{% include 'footer.html' %}
