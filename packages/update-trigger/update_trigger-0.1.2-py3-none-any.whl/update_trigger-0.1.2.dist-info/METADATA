Metadata-Version: 2.4
Name: update-trigger
Version: 0.1.2
Summary: Pacote utilizado para publicar mensagens MQTT quando um arquivo √© atualizado.
Author-email: Felipe Ribeiro <feliperibeiromachado@edu.univali.br>
License: MIT
Description-Content-Type: text/markdown
Requires-Dist: paho-mqtt==2.1.0
Requires-Dist: python-dotenv==1.1.1

# update-trigger üöÄ

[![PyPI version](https://img.shields.io/pypi/v/update-trigger.svg)](https://pypi.org/project/update-trigger/)  
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)  

Pacote Python utilizado para **publicar mensagens MQTT** (payload `"update"`) quando acionado em pipelines de **CI/CD**, como no **GitHub Actions**.  

Esse pacote facilita a integra√ß√£o com servi√ßos que precisam ser notificados sobre atualiza√ß√µes de arquivos ou sistemas.

---

## üì¶ Instala√ß√£o

Instale o pacote via **PyPI** (ap√≥s publica√ß√£o):

```bash
pip install update-trigger
```

Ou localmente durante o desenvolvimento:

```bash
pip install .
```

---

## ‚öôÔ∏è Configura√ß√£o

O pacote utiliza vari√°veis de ambiente para se conectar ao broker MQTT.  
Crie um arquivo `.env` com as seguintes chaves:

```env
MQTT_BROKER=test.mosquitto.org
MQTT_PORT=8883
MQTT_USERNAME=seu_usuario
MQTT_PASSWORD=sua_senha
```

---

## üß© Uso em Python

Voc√™ pode importar a classe `MqttService` diretamente no seu projeto:

```python
from update_trigger import MqttService
import os

service = MqttService(
    broker=os.environ["MQTT_BROKER"],
    port=int(os.environ["MQTT_PORT"]),
    client_id="github-actions",
    topic="actions",
)

service.send_message()
```

---

## ü§ñ Uso no GitHub Actions

Exemplo de workflow que dispara o **update-trigger** ap√≥s um push na branch `main`:

```yaml
name: Trigger MQTT Update

on:
  push:
    branches:
      - main

jobs:
  mqtt-notify:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: Install update-trigger
        run: pip install update-trigger

      - name: Send MQTT update
        env:
          MQTT_BROKER: ${{ secrets.MQTT_BROKER }}
          MQTT_PORT: ${{ secrets.MQTT_PORT }}
          MQTT_USERNAME: ${{ secrets.MQTT_USERNAME }}
          MQTT_PASSWORD: ${{ secrets.MQTT_PASSWORD }}
        run: python -m update_trigger
```

> ‚ö†Ô∏è Configure os valores de conex√£o (`MQTT_BROKER`, `MQTT_PORT`, `MQTT_USERNAME`, `MQTT_PASSWORD`) como **GitHub Secrets** para maior seguran√ßa.  

---

## üìú Licen√ßa

Distribu√≠do sob a licen√ßa **MIT**. Veja o arquivo [LICENSE](LICENSE) para mais detalhes.  
