import{d as Qt,e as ae,f as A,h as G,aX as at,aQ as ca,r as V,C as da,c as pa,a3 as _a,a2 as ga,b as ma,J as Ht,al as zt,Q as Z,p as ya,n as ha,ag as va,B as he,N as ba,cq as wa,o as Ta,a8 as It,bQ as xa,i as J,w as U,ab as Et,ac as Ot,l as i,E as te,W as Ca,M as Vt,t as Y,ai as Aa,z as qe,a7 as Ia,s as Ie,a6 as Ea,aU as Oa,j as Pa,Y as Ra,b6 as La,U as Ua,v as Ma,aa as Na,L as ka,aY as rt,aZ as Da}from"./index-CvCv8tjC.js";import{u as Fa,g as $a,v as Sa,w as qa,x as Ga,y as Ba,z as Ka}from"./exp-BIf1sWJ4.js";import{_ as Ha}from"./DynamicForm.vue_vue_type_script_setup_true_lang-Ijfe0G_0.js";import{i as za}from"./json-editor-vue-BvJIz9SG.js";import{u as Va}from"./exp-CMCdJMb9.js";import{c as Ja}from"./index-D5YeMwg8.js";import{N as Ya}from"./InputNumber-C_LhnbBs.js";import{N as Qa}from"./Switch-1B_VZ16h.js";import{b as Wa,a as Xa}from"./Tabs-CqcYRKXl.js";import{_ as ja}from"./Popconfirm-DNmDyeOO.js";import"./debounce-D4NDO7dG.js";import"./Add-D6uUqg2u.js";const Za={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},er=Qt({name:"Edit",render:function(ee,L){return A(),ae("svg",Za,L[0]||(L[0]=[G("path",{d:"M2 26h28v2H2z",fill:"currentColor"},null,-1),G("path",{d:"M25.4 9c.8-.8.8-2 0-2.8l-3.6-3.6c-.8-.8-2-.8-2.8 0l-15 15V24h6.4l15-15zm-5-5L24 7.6l-3 3L17.4 7l3-3zM6 22v-3.6l10-10l3.6 3.6l-10 10H6z",fill:"currentColor"},null,-1)]))}});var Ge={exports:{}};Ge.exports;var Jt;function tr(){return Jt||(Jt=1,function(Ee,ee){var L=200,st="Expected a function",Ne="__lodash_hash_undefined__",ve=1,a=2,M=9007199254740991,pe="[object Arguments]",Q="[object Array]",ne="[object Boolean]",be="[object Date]",re="[object Error]",se="[object Function]",it="[object GeneratorFunction]",W="[object Map]",ke="[object Number]",ie="[object Object]",Be="[object Promise]",De="[object RegExp]",we="[object Set]",le="[object String]",Oe="[object Symbol]",Te="[object WeakMap]",Pe="[object ArrayBuffer]",Re="[object DataView]",lt="[object Float32Array]",ut="[object Float64Array]",Fe="[object Int8Array]",Le="[object Int16Array]",ot="[object Int32Array]",ft="[object Uint8Array]",ct="[object Uint8ClampedArray]",Ke="[object Uint16Array]",dt="[object Uint32Array]",p=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/,g=/^\./,_=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,y=/[\\^$.*+?()[\]{}|]/g,f=/\\(\\)?/g,I=/^\[object .+?Constructor\]$/,h=/^(?:0|[1-9]\d*)$/,l={};l[lt]=l[ut]=l[Fe]=l[Le]=l[ot]=l[ft]=l[ct]=l[Ke]=l[dt]=!0,l[pe]=l[Q]=l[Pe]=l[ne]=l[Re]=l[be]=l[re]=l[se]=l[W]=l[ke]=l[ie]=l[De]=l[we]=l[le]=l[Te]=!1;var m=typeof at=="object"&&at&&at.Object===Object&&at,x=typeof self=="object"&&self&&self.Object===Object&&self,d=m||x||Function("return this")(),b=ee&&!ee.nodeType&&ee,B=b&&!0&&Ee&&!Ee.nodeType&&Ee,C=B&&B.exports===b,K=C&&m.process,N=function(){try{return K&&K.binding("util")}catch{}}(),H=N&&N.isTypedArray;function E(e,t,n,r){for(var u=-1,s=e?e.length:0;++u<s;){var c=e[u];t(r,c,n(c),e)}return r}function w(e,t){for(var n=-1,r=e?e.length:0;++n<r;)if(t(e[n],n,e))return!0;return!1}function O(e){return function(t){return t==null?void 0:t[e]}}function P(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function k(e){return function(t){return e(t)}}function z(e,t){return e==null?void 0:e[t]}function F(e){var t=!1;if(e!=null&&typeof e.toString!="function")try{t=!!(e+"")}catch{}return t}function He(e){var t=-1,n=Array(e.size);return e.forEach(function(r,u){n[++t]=[u,r]}),n}function _e(e,t){return function(n){return e(t(n))}}function pt(e){var t=-1,n=Array(e.size);return e.forEach(function(r){n[++t]=r}),n}var _t=Array.prototype,Wt=Function.prototype,ze=Object.prototype,gt=d["__core-js_shared__"],Pt=function(){var e=/[^.]+$/.exec(gt&&gt.keys&&gt.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Rt=Wt.toString,ue=ze.hasOwnProperty,Ue=ze.toString,Xt=RegExp("^"+Rt.call(ue).replace(y,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Lt=d.Symbol,Ut=d.Uint8Array,jt=ze.propertyIsEnumerable,Zt=_t.splice,en=_e(Object.keys,Object),mt=Me(d,"DataView"),$e=Me(d,"Map"),yt=Me(d,"Promise"),ht=Me(d,"Set"),vt=Me(d,"WeakMap"),Se=Me(Object,"create"),tn=Ce(mt),nn=Ce($e),an=Ce(yt),rn=Ce(ht),sn=Ce(vt),Ve=Lt?Lt.prototype:void 0,bt=Ve?Ve.valueOf:void 0,Mt=Ve?Ve.toString:void 0;function xe(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ln(){this.__data__=Se?Se(null):{}}function un(e){return this.has(e)&&delete this.__data__[e]}function on(e){var t=this.__data__;if(Se){var n=t[e];return n===Ne?void 0:n}return ue.call(t,e)?t[e]:void 0}function fn(e){var t=this.__data__;return Se?t[e]!==void 0:ue.call(t,e)}function cn(e,t){var n=this.__data__;return n[e]=Se&&t===void 0?Ne:t,this}xe.prototype.clear=ln,xe.prototype.delete=un,xe.prototype.get=on,xe.prototype.has=fn,xe.prototype.set=cn;function oe(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function dn(){this.__data__=[]}function pn(e){var t=this.__data__,n=Ye(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():Zt.call(t,n,1),!0}function _n(e){var t=this.__data__,n=Ye(t,e);return n<0?void 0:t[n][1]}function gn(e){return Ye(this.__data__,e)>-1}function mn(e,t){var n=this.__data__,r=Ye(n,e);return r<0?n.push([e,t]):n[r][1]=t,this}oe.prototype.clear=dn,oe.prototype.delete=pn,oe.prototype.get=_n,oe.prototype.has=gn,oe.prototype.set=mn;function fe(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function yn(){this.__data__={hash:new xe,map:new($e||oe),string:new xe}}function hn(e){return Qe(this,e).delete(e)}function vn(e){return Qe(this,e).get(e)}function bn(e){return Qe(this,e).has(e)}function wn(e,t){return Qe(this,e).set(e,t),this}fe.prototype.clear=yn,fe.prototype.delete=hn,fe.prototype.get=vn,fe.prototype.has=bn,fe.prototype.set=wn;function Je(e){var t=-1,n=e?e.length:0;for(this.__data__=new fe;++t<n;)this.add(e[t])}function Tn(e){return this.__data__.set(e,Ne),this}function xn(e){return this.__data__.has(e)}Je.prototype.add=Je.prototype.push=Tn,Je.prototype.has=xn;function ce(e){this.__data__=new oe(e)}function Cn(){this.__data__=new oe}function An(e){return this.__data__.delete(e)}function In(e){return this.__data__.get(e)}function En(e){return this.__data__.has(e)}function On(e,t){var n=this.__data__;if(n instanceof oe){var r=n.__data__;if(!$e||r.length<L-1)return r.push([e,t]),this;n=this.__data__=new fe(r)}return n.set(e,t),this}ce.prototype.clear=Cn,ce.prototype.delete=An,ce.prototype.get=In,ce.prototype.has=En,ce.prototype.set=On;function Pn(e,t){var n=me(e)||Gt(e)?P(e.length,String):[],r=n.length,u=!!r;for(var s in e)ue.call(e,s)&&!(u&&(s=="length"||Ft(s,r)))&&n.push(s);return n}function Ye(e,t){for(var n=e.length;n--;)if(qt(e[n][0],t))return n;return-1}function Rn(e,t,n,r){return Ln(e,function(u,s,c){t(r,u,n(u),c)}),r}var Ln=Jn(Mn),Un=Yn();function Mn(e,t){return e&&Un(e,t,et)}function Nt(e,t){t=We(t,e)?[t]:kt(t);for(var n=0,r=t.length;e!=null&&n<r;)e=e[Xe(t[n++])];return n&&n==r?e:void 0}function Nn(e){return Ue.call(e)}function kn(e,t){return e!=null&&t in Object(e)}function wt(e,t,n,r,u){return e===t?!0:e==null||t==null||!je(e)&&!Ze(t)?e!==e&&t!==t:Dn(e,t,wt,n,r,u)}function Dn(e,t,n,r,u,s){var c=me(e),R=me(t),T=Q,D=Q;c||(T=ge(e),T=T==pe?ie:T),R||(D=ge(t),D=D==pe?ie:D);var S=T==ie&&!F(e),q=D==ie&&!F(t),$=T==D;if($&&!S)return s||(s=new ce),c||sa(e)?Dt(e,t,n,r,u,s):Qn(e,t,T,n,r,u,s);if(!(u&a)){var X=S&&ue.call(e,"__wrapped__"),j=q&&ue.call(t,"__wrapped__");if(X||j){var ye=X?e.value():e,de=j?t.value():t;return s||(s=new ce),n(ye,de,r,u,s)}}return $?(s||(s=new ce),Wn(e,t,n,r,u,s)):!1}function Fn(e,t,n,r){var u=n.length,s=u;if(e==null)return!s;for(e=Object(e);u--;){var c=n[u];if(c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++u<s;){c=n[u];var R=c[0],T=e[R],D=c[1];if(c[2]){if(T===void 0&&!(R in e))return!1}else{var S=new ce,q;if(!(q===void 0?wt(D,T,r,ve|a,S):q))return!1}}return!0}function $n(e){if(!je(e)||ea(e))return!1;var t=Bt(e)||F(e)?Xt:I;return t.test(Ce(e))}function Sn(e){return Ze(e)&&Ct(e.length)&&!!l[Ue.call(e)]}function qn(e){return typeof e=="function"?e:e==null?oa:typeof e=="object"?me(e)?Kn(e[0],e[1]):Bn(e):fa(e)}function Gn(e){if(!ta(e))return en(e);var t=[];for(var n in Object(e))ue.call(e,n)&&n!="constructor"&&t.push(n);return t}function Bn(e){var t=Xn(e);return t.length==1&&t[0][2]?St(t[0][0],t[0][1]):function(n){return n===e||Fn(n,e,t)}}function Kn(e,t){return We(e)&&$t(t)?St(Xe(e),t):function(n){var r=la(n,e);return r===void 0&&r===t?ua(n,e):wt(t,r,void 0,ve|a)}}function Hn(e){return function(t){return Nt(t,e)}}function zn(e){if(typeof e=="string")return e;if(At(e))return Mt?Mt.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function kt(e){return me(e)?e:na(e)}function Vn(e,t){return function(n,r){var u=me(n)?E:Rn,s=t?t():{};return u(n,e,qn(r),s)}}function Jn(e,t){return function(n,r){if(n==null)return n;if(!xt(n))return e(n,r);for(var u=n.length,s=-1,c=Object(n);++s<u&&r(c[s],s,c)!==!1;);return n}}function Yn(e){return function(t,n,r){for(var u=-1,s=Object(t),c=r(t),R=c.length;R--;){var T=c[++u];if(n(s[T],T,s)===!1)break}return t}}function Dt(e,t,n,r,u,s){var c=u&a,R=e.length,T=t.length;if(R!=T&&!(c&&T>R))return!1;var D=s.get(e);if(D&&s.get(t))return D==t;var S=-1,q=!0,$=u&ve?new Je:void 0;for(s.set(e,t),s.set(t,e);++S<R;){var X=e[S],j=t[S];if(r)var ye=c?r(j,X,S,t,e,s):r(X,j,S,e,t,s);if(ye!==void 0){if(ye)continue;q=!1;break}if($){if(!w(t,function(de,Ae){if(!$.has(Ae)&&(X===de||n(X,de,r,u,s)))return $.add(Ae)})){q=!1;break}}else if(!(X===j||n(X,j,r,u,s))){q=!1;break}}return s.delete(e),s.delete(t),q}function Qn(e,t,n,r,u,s,c){switch(n){case Re:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Pe:return!(e.byteLength!=t.byteLength||!r(new Ut(e),new Ut(t)));case ne:case be:case ke:return qt(+e,+t);case re:return e.name==t.name&&e.message==t.message;case De:case le:return e==t+"";case W:var R=He;case we:var T=s&a;if(R||(R=pt),e.size!=t.size&&!T)return!1;var D=c.get(e);if(D)return D==t;s|=ve,c.set(e,t);var S=Dt(R(e),R(t),r,u,s,c);return c.delete(e),S;case Oe:if(bt)return bt.call(e)==bt.call(t)}return!1}function Wn(e,t,n,r,u,s){var c=u&a,R=et(e),T=R.length,D=et(t),S=D.length;if(T!=S&&!c)return!1;for(var q=T;q--;){var $=R[q];if(!(c?$ in t:ue.call(t,$)))return!1}var X=s.get(e);if(X&&s.get(t))return X==t;var j=!0;s.set(e,t),s.set(t,e);for(var ye=c;++q<T;){$=R[q];var de=e[$],Ae=t[$];if(r)var Kt=c?r(Ae,de,$,t,e,s):r(de,Ae,$,e,t,s);if(!(Kt===void 0?de===Ae||n(de,Ae,r,u,s):Kt)){j=!1;break}ye||(ye=$=="constructor")}if(j&&!ye){var tt=e.constructor,nt=t.constructor;tt!=nt&&"constructor"in e&&"constructor"in t&&!(typeof tt=="function"&&tt instanceof tt&&typeof nt=="function"&&nt instanceof nt)&&(j=!1)}return s.delete(e),s.delete(t),j}function Qe(e,t){var n=e.__data__;return Zn(t)?n[typeof t=="string"?"string":"hash"]:n.map}function Xn(e){for(var t=et(e),n=t.length;n--;){var r=t[n],u=e[r];t[n]=[r,u,$t(u)]}return t}function Me(e,t){var n=z(e,t);return $n(n)?n:void 0}var ge=Nn;(mt&&ge(new mt(new ArrayBuffer(1)))!=Re||$e&&ge(new $e)!=W||yt&&ge(yt.resolve())!=Be||ht&&ge(new ht)!=we||vt&&ge(new vt)!=Te)&&(ge=function(e){var t=Ue.call(e),n=t==ie?e.constructor:void 0,r=n?Ce(n):void 0;if(r)switch(r){case tn:return Re;case nn:return W;case an:return Be;case rn:return we;case sn:return Te}return t});function jn(e,t,n){t=We(t,e)?[t]:kt(t);for(var r,u=-1,c=t.length;++u<c;){var s=Xe(t[u]);if(!(r=e!=null&&n(e,s)))break;e=e[s]}if(r)return r;var c=e?e.length:0;return!!c&&Ct(c)&&Ft(s,c)&&(me(e)||Gt(e))}function Ft(e,t){return t=t??M,!!t&&(typeof e=="number"||h.test(e))&&e>-1&&e%1==0&&e<t}function We(e,t){if(me(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||At(e)?!0:o.test(e)||!p.test(e)||t!=null&&e in Object(t)}function Zn(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function ea(e){return!!Pt&&Pt in e}function ta(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||ze;return e===n}function $t(e){return e===e&&!je(e)}function St(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==void 0||e in Object(n))}}var na=Tt(function(e){e=ia(e);var t=[];return g.test(e)&&t.push(""),e.replace(_,function(n,r,u,s){t.push(u?s.replace(f,"$1"):r||n)}),t});function Xe(e){if(typeof e=="string"||At(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function Ce(e){if(e!=null){try{return Rt.call(e)}catch{}try{return e+""}catch{}}return""}var aa=Vn(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]});function Tt(e,t){if(typeof e!="function"||t&&typeof t!="function")throw new TypeError(st);var n=function(){var r=arguments,u=t?t.apply(this,r):r[0],s=n.cache;if(s.has(u))return s.get(u);var c=e.apply(this,r);return n.cache=s.set(u,c),c};return n.cache=new(Tt.Cache||fe),n}Tt.Cache=fe;function qt(e,t){return e===t||e!==e&&t!==t}function Gt(e){return ra(e)&&ue.call(e,"callee")&&(!jt.call(e,"callee")||Ue.call(e)==pe)}var me=Array.isArray;function xt(e){return e!=null&&Ct(e.length)&&!Bt(e)}function ra(e){return Ze(e)&&xt(e)}function Bt(e){var t=je(e)?Ue.call(e):"";return t==se||t==it}function Ct(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=M}function je(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function Ze(e){return!!e&&typeof e=="object"}function At(e){return typeof e=="symbol"||Ze(e)&&Ue.call(e)==Oe}var sa=H?k(H):Sn;function ia(e){return e==null?"":zn(e)}function la(e,t,n){var r=e==null?void 0:Nt(e,t);return r===void 0?n:r}function ua(e,t){return e!=null&&jn(e,t,kn)}function et(e){return xt(e)?Pn(e):Gn(e)}function oa(e){return e}function fa(e){return We(e)?O(Xe(e)):Hn(e)}Ee.exports=aa}(Ge,Ge.exports)),Ge.exports}var nr=tr();const ar=ca(nr),rr={class:"flex gap-3"},sr={class:"w-64 pl-2"},ir={class:"mb-5"},lr={class:"text-xl"},ur={class:"text-sm opacity-80"},or={key:0,class:"text-right mt-2"},fr={class:"flex justify-between items-center mb-2"},cr={class:"flex-1"},dr={key:0},pr={class:"text-xl"},_r={class:"opacity-75 italic pl-2"},gr={key:1,class:"text-xl"},mr={key:0,class:"flex gap-2"},yr={class:"mt-4 mb-2 text-xl"},hr={class:"flex justify-end mt-5 gap-2"},v="__SPACE_PARAMETER_UPDATING__",Yt="__SELECTED_SPACE_PARAMETER_UPDATING__",Lr=Qt({__name:"ExpRunResult",setup(Ee){const ee=V(!1),L=da(),st=pa(),Ne=_a(),ve=ga(),a=Va(),{t:M}=ma(),pe=V(),Q=V({show:!1}),ne=V(!1),be=V(!1),re=V(!1),se=V(!1),it=[{label:"str",value:"str"},{label:"int",value:"int"},{label:"float",value:"float"},{label:"bool",value:"bool"},{label:"list",value:"list"},{label:"tuple",value:"tuple"},{label:"dict",value:"dict"},{label:"complex",value:"complex"},{label:"ndarray",value:"ndarray"}],W=V(),ke=V(),ie=V(),Be=async()=>{var g,_;const[p,o]=await Fa();if(!p&&(o==null?void 0:o.status)===0){ie.value=o.data;const[y]=(_=(g=a==null?void 0:a.expInfo)==null?void 0:g.exp)!=null&&_.template?a.expInfo.exp.template.split("/"):"";y&&o.data[y]?(W.value=y,rt(()=>{Te(y,!0)})):(W.value=Object.keys(o.data)[0],rt(()=>{Te(Object.keys(o.data)[0])}))}},De=async()=>{var g,_,y;if(!L.query.exp_id)return;const[p,o]=await $a({exp_id:L.query.exp_id,device_group_name:L.query.device_group_name,space_id:L.query.space_id});if(!p&&(o==null?void 0:o.status)===0){if((g=o.data)!=null&&g.data){o.data.data=JSON.parse(o.data.data);const f=(_=o.data.data)!=null&&_.tables?(y=o.data.data)==null?void 0:y.tables[v]:null;f&&(f.crows=f.rows)}a.result=o.data}},we=Ht(()=>{var _,y;const p=[];(_=a.result)!=null&&_.data&&zt((y=a.result.data)==null?void 0:y.tables,f=>{const I=f.rows.map(l=>{var x;const m={};return(x=f.columns)==null||x.forEach((d,b)=>{m[d.name]=typeof l[b]!==void 0?`${l[b]}`:l[b]}),m}),h=f.columns.map((l,m)=>{const x={...l,title:l.name,key:l.name};return l.name==="key"?{...x,minWidth:200}:l.name==="type"&&f.name===v?{...x,width:200,render(d,b){if(ee.value){const B=f.crows?f.crows[b][m]:null;return Z(ya,{class:B!=d.type?"!outline !outline-red-500 w-32":"w-32",options:it,value:d.type,onUpdateValue:C=>{var K,N,H,E,w,O,P,k;(N=(K=a==null?void 0:a.result)==null?void 0:K.data)!=null&&N.tables&&((E=(H=a==null?void 0:a.result)==null?void 0:H.data)!=null&&E.tables[v])&&(((O=(w=a==null?void 0:a.result)==null?void 0:w.data)==null?void 0:O.tables[v]).rows[b][m]=C,C==="bool"&&(((k=(P=a==null?void 0:a.result)==null?void 0:P.data)==null?void 0:k.tables[v]).rows[b][m+1]=!1))}})}return d.type}}:l.name==="value"&&f.name===v?{...x,render:(d,b)=>{const B=f.crows?f.crows[b][m]:null;if(ee.value){const C=Z(Ya,{value:+d.value,class:B!=d.value?"outline outline-red-500 w-full":"w-full",onUpdateValue(E){var w,O,P,k,z,F;(O=(w=a==null?void 0:a.result)==null?void 0:w.data)!=null&&O.tables&&((k=(P=a==null?void 0:a.result)==null?void 0:P.data)!=null&&k.tables[v])&&(((F=(z=a==null?void 0:a.result)==null?void 0:z.data)==null?void 0:F.tables[v]).rows[b][m]=E)}}),K=Z(ha,{value:String(d.value),class:B!==d.value?"!outline !outline-red-500":"",onUpdateValue(E){var w,O,P,k,z,F;(O=(w=a==null?void 0:a.result)==null?void 0:w.data)!=null&&O.tables&&((k=(P=a==null?void 0:a.result)==null?void 0:P.data)!=null&&k.tables[v])&&(((F=(z=a==null?void 0:a.result)==null?void 0:z.data)==null?void 0:F.tables[v]).rows[b][m]=E)}}),N=Z("div",{class:"flex gap-2 h-[34px] leading-[34px]"},[Z("div",{class:B!=d.value?"outline outline-red-500":""},Z(va,{lineClamp:1},{default:()=>d.value})),Z(he,{type:"info",size:"tiny",class:"!h-[34px] !w-[34px]",onClick:()=>{Q.value={show:!0,info:{rowIdx:b,cidx:m,value:d.value}}}},{icon:()=>Z(er)})]),H=Z(Qa,{class:B!=d.value?"!outline !outline-red-500 w-32":"w-32",checkedValue:"true",uncheckedValue:"false",onUpdateValue:E=>{var w,O,P,k,z,F;(O=(w=a==null?void 0:a.result)==null?void 0:w.data)!=null&&O.tables&&((k=(P=a==null?void 0:a.result)==null?void 0:P.data)!=null&&k.tables[v])&&(((F=(z=a==null?void 0:a.result)==null?void 0:z.data)==null?void 0:F.tables[v]).rows[b][m]=E)}});return Z("div",{class:"flex items-center"},Ja([["float","int"].includes(d.type)?C:null,["str","complex"].includes(d.type)?K:null,["dict","list","tuple","ndarray"].includes(d.type)?N:null,["bool"].includes(d.type)?H:null]))}return d.value}}:x});ee.value&&f.name===v&&h.push({title:M("expInfo.tableOptions"),key:"options",width:100,align:"rigth",render(l,m){const x=f.columns.findIndex(C=>C.name==="type"),d=f.crows?f.crows[m][x]:null,b=f.columns.findIndex(C=>C.name==="value"),B=f.crows?f.crows[m][b]:null;return Z(he,{type:"info",size:"small",class:"!h-[34px]",onClick:()=>{var C,K,N,H,E,w,O,P;(K=(C=a==null?void 0:a.result)==null?void 0:C.data)!=null&&K.tables&&((H=(N=a==null?void 0:a.result)==null?void 0:N.data)!=null&&H.tables[v])&&(((w=(E=a==null?void 0:a.result)==null?void 0:E.data)==null?void 0:w.tables[v]).rows[m][b]=B,((P=(O=a==null?void 0:a.result)==null?void 0:O.data)==null?void 0:P.tables[v]).rows[m][x]=d)}},{default:()=>M("expInfo.reset"),icon:()=>Z(ba,{component:wa})})}}),f.name===v&&ee.value&&h.unshift({type:"selection",key:"selection"}),p.push({oname:f.name,name:f.name===v?M("expInfo.needUpdateParams"):f.name===Yt?M("expInfo.updatedParams"):f.name,columns:h,rows:I})});const[o,g]=ar(p,{oname:Yt});return[...o,...g]}),le=V(),Oe=V(),Te=async(p,o)=>{var y,f,I;const[g,_]=await Sa({fitter_group_name:p});if(!g&&(_==null?void 0:_.status)===0){ke.value=_.data;const h=(I=(f=(y=a==null?void 0:a.expInfo)==null?void 0:y.exp)==null?void 0:f.template)==null?void 0:I.split("/")[1];h&&_.data[h]&&o?(le.value=h,rt(()=>{Pe(h)})):(le.value=Object.keys(_.data)[0],rt(()=>{Pe(Object.keys(_.data)[0])}))}},Pe=async p=>{if(ne.value)return;ne.value=!0;const[o,g]=await qa({fitter_group_name:W.value,fitter_name:p,group_name:L.query.device_group_name,space_id:L.query.space_id});ne.value=!1,!o&&(g==null?void 0:g.status)===0&&(g.data.exp_id&&(g.data.exp_id.default=L.query.exp_id?Number(L.query.exp_id):null),Oe.value=g.data)},Re=p=>{Te(p)},lt=p=>{Pe(p)},ut=async()=>{var I;if(!pe.value||be.value)return;be.value=!0;const p=await((I=pe.value[0])==null?void 0:I.submit()),o=Da(p);if(It(o))return;const{device_group_name:g,space_id:_}=L.query,[y,f]=await Ga({setting:o,group_name:g,space_id:_,fitter_group:W.value,fitter_name:le.value});if(be.value=!1,!y&&(f==null?void 0:f.status)===0){a.result={...f.data,big_picture_url:"/"+f.data.plot_file_in_static};const[h,l]=await Ba("/"+f.data.table_file_in_static);h||(ee.value=!0,zt(l==null?void 0:l.tables,(m,x)=>{x===v&&(m.crows=JSON.parse(JSON.stringify(m.rows)),Le.value=m.crows.map(d=>d[0]))}),a.result={...a.result||{},data:l})}},Fe=async(p=!1)=>{var y,f,I,h,l;if(p){if(se.value)return;se.value=!0}else{if(re.value)return;re.value=!0}const o={group_name:L.query.device_group_name,space_id:L.query.space_id,exp_id:L.query.exp_id,task_id:((y=a.expInfo)==null?void 0:y.task_id)||"",img_file:((f=a.result)==null?void 0:f.plot_file)||"",table_file:((I=a.result)==null?void 0:I.table_file)||"",update_space_parameters:p};if(p){const m=(h=we.value)==null?void 0:h.find(x=>x.oname===v);o.space_parameters=(l=Le.value)==null?void 0:l.map(x=>{var d;return(d=m.rows)==null?void 0:d.find(b=>b.key===x)})}const[g,_]=await Ka(o);!g&&(_==null?void 0:_.status)===0&&(Ne.success("Submit Successfully"),await De(),ee.value=!1),p?se.value=!1:re.value=!1},Le=V(),ot=p=>{Le.value=p};Ta(()=>{if(!L.query.exp_id){st.back();return}Be(),De()});const ft=()=>{Fe()},ct=Ht(()=>{var o,g,_,y,f,I;const p=(g=(o=a.result)==null?void 0:o.data)!=null&&g.tables?(y=(_=a.result)==null?void 0:_.data)==null?void 0:y.tables[v]:null;if(!It(p)){const h=(f=p.columns)==null?void 0:f.findIndex(l=>l.name==="value");return h<0?!1:(I=p.crows)==null?void 0:I.some((l,m)=>l[h]!==p.rows[m][h])}return!1}),Ke=()=>{Q.value={show:!1,info:void 0}},dt=()=>{var _,y,f,I,h,l;const{rowIdx:p,cidx:o,value:g}=Q.value.info;(y=(_=a==null?void 0:a.result)==null?void 0:_.data)!=null&&y.tables&&((I=(f=a==null?void 0:a.result)==null?void 0:f.data)!=null&&I.tables[v])&&(((l=(h=a==null?void 0:a.result)==null?void 0:h.data)==null?void 0:l.tables[v]).rows[p][o]=g),Ke()};return xa(()=>{a.result=void 0}),(p,o)=>{const g=Ia,_=Aa,y=Oa,f=ja,I=Pa,h=Ra,l=Ua,m=Wa,x=Xa,d=Ca,b=Ma,B=ka;return A(),ae("div",null,[J(x,{type:"card",placement:"top",animated:"",onUpdateValue:Re,value:i(W),"onUpdate:value":o[3]||(o[3]=C=>Vt(W)?W.value=C:null),class:"!h-full"},{default:U(()=>[(A(!0),ae(Et,null,Ot(i(ie),(C,K)=>(A(),te(m,{key:K,name:K,tab:C.title,disabled:i(ne)},{default:U(()=>[J(d,{class:"p-3 min-h-[260px]"},{default:U(()=>[J(x,{type:"line",placement:"left",value:i(le),"onUpdate:value":o[2]||(o[2]=N=>Vt(le)?le.value=N:null),size:"small",onUpdateValue:lt,style:{height:"calc(100vh - 330px)"}},{default:U(()=>[(A(!0),ae(Et,null,Ot(i(ke),(N,H)=>(A(),te(m,{key:H,name:H,tab:N.title,disabled:i(ne)},{default:U(()=>[G("div",rr,[G("div",sr,[G("div",ir,[G("div",lr,Y(N.title),1),G("div",ur,Y(N.desc),1)]),J(_,{show:i(ne)},{default:U(()=>{var E,w;return[J(g,{style:{"max-height":"calc(100vh - 330px)"}},{default:U(()=>[i(Oe)&&!i(ne)?(A(),te(Ha,{key:0,cfgs:i(Oe),ref_for:!0,ref_key:"dynamicFormRef",ref:pe},null,8,["cfgs"])):qe("",!0)]),_:1}),(w=(E=i(a))==null?void 0:E.expInfo)!=null&&w.exp_id?(A(),ae("div",or,[J(i(he),{type:"primary",onClick:ut,loading:i(be)},{default:U(()=>[Ie(Y(i(M)("expInfo.ffitting")),1)]),_:1},8,["loading"])])):qe("",!0)]}),_:1},8,["show"])]),G("div",{class:"flex-1 pl-3",style:Ea({borderLeft:`1px solid ${i(ve).dividerColor}`})},[i(It)(i(a).result)?(A(),te(y,{key:0,description:i(M)("expInfo.nores"),class:"mt-20"},null,8,["description"])):(A(),te(g,{key:1,style:{"max-height":"calc(100vh - 330px)"}},{default:U(()=>{var E,w,O,P,k,z,F,He;return[G("div",fr,[G("div",cr,[!((E=i(a).result)!=null&&E.plot_file)&&!((w=i(a).result)!=null&&w.table_file)&&((O=i(a).result)!=null&&O.create_time)?(A(),ae("div",dr,[G("span",pr,Y(i(M)("expInfo.resUploaded")),1),G("span",_r,Y((P=i(a).result)==null?void 0:P.create_time),1)])):(A(),ae("div",gr,Y(i(M)("expInfo.result")),1))]),(k=i(a).result)!=null&&k.plot_file||(z=i(a).result)!=null&&z.table_file?(A(),ae("div",mr,[i(ct)?(A(),te(f,{key:0,onPositiveClick:ft},{trigger:U(()=>[J(i(he),{loading:i(re),type:"primary",disabled:i(se)},{default:U(()=>[Ie(Y(i(M)("expInfo.uploadOnly")),1)]),_:1},8,["loading","disabled"])]),default:U(()=>[Ie(" "+Y(i(M)("expInfo.updateOnlyTips")),1)]),_:1})):(A(),te(i(he),{key:1,loading:i(re),type:"primary",onClick:o[0]||(o[0]=()=>Fe()),disabled:i(se)},{default:U(()=>[Ie(Y(i(M)("expInfo.uploadOnly")),1)]),_:1},8,["loading","disabled"])),J(i(he),{loading:i(se),type:"primary",onClick:o[1]||(o[1]=()=>Fe(!0)),disabled:i(re)},{default:U(()=>[Ie(Y(i(M)("expInfo.uploadAndModifyParams")),1)]),_:1},8,["loading","disabled"])])):qe("",!0)]),J(I,{class:"!my-2"}),(F=i(a).result)!=null&&F.big_picture_url?(A(),te(h,{key:0,src:i(La)((He=i(a).result)==null?void 0:He.big_picture_url,"t",String(+new Date)),alt:"",class:"max-w-full"},null,8,["src"])):qe("",!0),(A(!0),ae(Et,null,Ot(i(we),(_e,pt)=>(A(),ae("div",{key:pt},[G("div",yr,Y(_e.name),1),_e.oname===v?(A(),te(l,{key:0,columns:_e.columns,data:_e.rows,"checked-row-keys":i(Le),"row-key":_t=>_t.key,"onUpdate:checkedRowKeys":ot},null,8,["columns","data","checked-row-keys","row-key"])):(A(),te(l,{key:1,columns:_e.columns,data:_e.rows},null,8,["columns","data"]))]))),128))]}),_:2},1024))],4)])]),_:2},1032,["name","tab","disabled"]))),128))]),_:2},1032,["value"])]),_:2},1024)]),_:2},1032,["name","tab","disabled"]))),128))]),_:1},8,["value"]),J(B,{show:i(Q).show,"onUpdate:show":o[5]||(o[5]=C=>i(Q).show=C),"mask-closable":!1},{default:U(()=>[J(b,{style:{width:"1000px","min-height":"500px"},size:"huge",bordered:!1},{default:U(()=>[i(Q).info?(A(),te(i(za),{key:0,class:Na(["w-full h-[70vh] overflow-auto",[i(ve).baseColor==="#000"?"jse-theme-dark":""]]),modelValue:i(Q).info.value,"onUpdate:modelValue":o[4]||(o[4]=C=>i(Q).info.value=C),mode:"text"},null,8,["class","modelValue"])):qe("",!0),G("div",hr,[J(i(he),{onClick:Ke},{default:U(()=>[Ie(Y(i(M)("common.cancel")),1)]),_:1}),J(i(he),{type:"primary",onClick:dt},{default:U(()=>[Ie(Y(i(M)("common.OK")),1)]),_:1})])]),_:1})]),_:1},8,["show"])])}}});export{Lr as default};
