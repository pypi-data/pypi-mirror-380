import{d as R,e as y,f as d,h as o,a1 as ee,b as te,C as ae,r as c,a4 as ne,i as u,w as r,v as se,B as oe,l as n,M as A,ab as F,ac as N,E as M,W as le,t as E,ai as re,a7 as ie,z as ue,s as H,L as ce,aZ as K,a8 as P,aY as pe,K as de}from"./index-CvCv8tjC.js";import{b as _e,d as me,e as fe,f as ve}from"./task-BzTCKWl0.js";import{l as ge}from"./exp-BIf1sWJ4.js";import{_ as he}from"./DynamicForm.vue_vue_type_script_setup_true_lang-Ijfe0G_0.js";import{a as xe,b as we}from"./Tabs-CqcYRKXl.js";const ye={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Le=R({name:"RecordStop24Regular",render:function(q,i){return d(),y("svg",ye,i[0]||(i[0]=[o("g",{fill:"none"},[o("path",{d:"M12 3.5a8.5 8.5 0 1 0 0 17a8.5 8.5 0 0 0 0-17zM2 12C2 6.477 6.477 2 12 2s10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12zm6-2.5A1.5 1.5 0 0 1 9.5 8h5A1.5 1.5 0 0 1 16 9.5v5a1.5 1.5 0 0 1-1.5 1.5h-5A1.5 1.5 0 0 1 8 14.5v-5z",fill:"currentColor"})],-1)]))}}),be={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ke=R({name:"CloseCircleOutline",render:function(q,i){return d(),y("svg",be,i[0]||(i[0]=[o("path",{d:"M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192s192-86 192-192z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),o("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M320 320L192 192"},null,-1),o("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M192 320l128-128"},null,-1)]))}}),Ce={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Oe=R({name:"Duplicate",render:function(q,i){return d(),y("svg",Ce,i[0]||(i[0]=[o("path",{d:"M408 112H184a72 72 0 0 0-72 72v224a72 72 0 0 0 72 72h224a72 72 0 0 0 72-72V184a72 72 0 0 0-72-72zm-32.45 200H312v63.55c0 8.61-6.62 16-15.23 16.43A16 16 0 0 1 280 376v-64h-63.55c-8.61 0-16-6.62-16.43-15.23A16 16 0 0 1 216 280h64v-63.55c0-8.61 6.62-16 15.23-16.43A16 16 0 0 1 312 216v64h64a16 16 0 0 1 16 16.77c-.42 8.61-7.84 15.23-16.45 15.23z",fill:"currentColor"},null,-1),o("path",{d:"M395.88 80A72.12 72.12 0 0 0 328 32H104a72 72 0 0 0-72 72v224a72.12 72.12 0 0 0 48 67.88V160a80 80 0 0 1 80-80z",fill:"currentColor"},null,-1)]))}}),Se={class:"absolute top-1 right-1"},Te={class:"pl-5 h-full tpl-s-g"},qe={class:"mb-5"},ze={class:"text-xl"},Ee={class:"text-sm opacity-80"},Re={class:"flex justify-end items-center gap-2 mt-2 mr-[20px]"},Be=R({__name:"ExpsTpl",setup(B,{expose:q}){const i=ee(),{t:$}=te(),l=ae(),b=c(),g=c(!1),h=c(!1),_=c(!1),x=c(!1),G=()=>{x.value=!0},z=()=>{x.value=!1},p=c(),I=c(),L=c(),J=async()=>{const[a,e]=await _e();!a&&(e==null?void 0:e.status)===0&&(L.value=e.data,p.value=Object.keys(e.data)[0],O(p.value))},m=c(),V=c(),O=async a=>{const[e,t]=await me({template_group_name:a});!e&&(t==null?void 0:t.status)===0&&(I.value=t.data,m.value=Object.keys(t.data)[0],U(Object.keys(t.data)[0]))},U=async a=>{if(_.value)return;_.value=!0;const[e,t]=await fe({template_group_name:p.value,template_name:a,group_name:l.query.device_group_name,space_id:l.query.space_id});_.value=!1,!e&&(t==null?void 0:t.status)===0&&(V.value=t.data)},W=a=>{O(a)},Y=a=>{U(a)},Z=async()=>{var f;if(g.value||!b.value)return;g.value=!0;let a={};try{a=await((f=b.value[0])==null?void 0:f.submit())}catch{g.value=!1;return}const e=K(a);if(P(e))return;const{device_group_name:t,space_id:k,task_id:C}=l.query,[w,s]=await ve({setting:e,task_id:C,group_name:t,space_id:k,template_group:p.value,template_name:m.value});g.value=!1,!w&&(s==null?void 0:s.status)===0&&(s.data.exp.template=s.data.exp.template||`${p.value}/${m.value}`,pe(()=>{setTimeout(()=>{localStorage.setItem("t",JSON.stringify(s));const v=new URLSearchParams({device_group_name:l.query.device_group_name,task_id:l.query.task_id,task_title:l.query.task_title,space_id:l.query.space_id,create:"1"});window.open(`/experiment/expSettings?${v.toString()}`,i.expOpenForm)},100),z()}))},Q=async()=>{var f;if(h.value||!b.value)return;h.value=!0;let a={};try{a=await((f=b.value[0])==null?void 0:f.submit())}catch{h.value=!1;return}const e=K(a);if(P(e))return;const{device_group_name:t,space_id:k,task_id:C}=l.query,[w,s]=await ge({setting:e,task_id:C,group_name:t,space_id:k,template_group:p.value,template_name:m.value});h.value=!1,!w&&(s==null?void 0:s.status)===0&&(setTimeout(()=>{const v=new URLSearchParams({device_group_name:l.query.device_group_name,task_id:l.query.task_id,task_title:l.query.task_title,space_id:l.query.space_id,exp_id:String(s.data.exp_id)});window.open(`/experiment/plotter?${v.toString()}`,i.expOpenForm)},100),z())};return ne(x,a=>{a&&J()},{immediate:!0}),q({open:G,close:z}),(a,e)=>{const t=oe,k=ie,C=re,w=we,s=xe,f=le,v=se,X=ce;return d(),y("div",null,[u(X,{show:n(x),"onUpdate:show":e[2]||(e[2]=S=>A(x)?x.value=S:null),size:"huge"},{default:r(()=>[u(v,{style:{"min-height":"700px",height:"calc(100vh - 100px)","box-sizing":"border-box",overflow:"hidden",width:"80vw","min-width":"600px",padding:"12px",position:"relative"},"content-class":"!pb-0"},{default:r(()=>[o("div",Se,[u(t,{type:"primary",onClick:z,size:"small",circle:""},{icon:r(()=>[u(n(ke))]),_:1})]),u(s,{type:"card",placement:"left",animated:"",onUpdateValue:W,value:n(p),"onUpdate:value":e[1]||(e[1]=S=>A(p)?p.value=S:null),style:{height:"calc(100vh - 160px)"}},{default:r(()=>[(d(!0),y(F,null,N(n(L),(S,j)=>(d(),M(w,{key:j,name:j,tab:S.title,disabled:n(_)},{default:r(()=>[u(f,{style:{height:"100%","padding-top":"10px","box-sizing":"border-box"}},{default:r(()=>[u(s,{type:"line",placement:"left",value:n(m),"onUpdate:value":e[0]||(e[0]=T=>A(m)?m.value=T:null),onUpdateValue:Y,style:{height:"100%"}},{default:r(()=>[(d(!0),y(F,null,N(n(I),(T,D)=>(d(),M(w,{key:D,name:D,tab:T.title,disabled:n(_)},{default:r(()=>[o("div",Te,[o("div",qe,[o("div",ze,E(T.title),1),o("div",Ee,E(T.desc),1)]),u(C,{show:n(_)},{default:r(()=>[u(k,{style:{"padding-right":"20px"}},{default:r(()=>[n(V)&&!n(_)?(d(),M(he,{key:0,cfgs:n(V),ref_for:!0,ref_key:"dynamicFormRef",ref:b},null,8,["cfgs"])):ue("",!0)]),_:1}),o("div",Re,[u(t,{loading:n(h),disabled:n(g),type:"primary",onClick:Q},{default:r(()=>[H(E(n($)("groupDetail.exps.createsubmit")),1)]),_:1},8,["loading","disabled"]),u(t,{loading:n(g),disabled:n(h),type:"primary",onClick:Z},{default:r(()=>[H(E(n($)("groupDetail.exps.createExpBtn")),1)]),_:1},8,["loading","disabled"])])]),_:1},8,["show"])])]),_:2},1032,["name","tab","disabled"]))),128))]),_:1},8,["value"])]),_:1})]),_:2},1032,["name","tab","disabled"]))),128))]),_:1},8,["value"])]),_:1})]),_:1},8,["show"])])}}}),Ue=de(Be,[["__scopeId","data-v-ab33ea69"]]);export{Oe as D,Ue as E,Le as R};
