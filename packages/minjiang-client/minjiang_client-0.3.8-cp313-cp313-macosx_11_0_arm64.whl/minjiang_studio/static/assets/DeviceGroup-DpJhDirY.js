import{d as D,b as W,c as Z,C as ee,r as p,R as te,S as ae,o as oe,Q as N,A as P,ae as ne,e as V,f as L,h as g,i as s,s as b,l as t,O as se,N as ie,t as f,w as r,ab as re,ac as le,E as ue,cI as q,M as C,B as de,cJ as ce,U as pe,V as _e,v as me,H as ve,k as ge,m as fe,n as ye,L as he,cK as Ge,cL as ke,X as be,cM as xe,cN as we,aY as ze,K as Ne}from"./index-CvCv8tjC.js";import{A as Le}from"./Add-DSV7m2CF.js";import{N as Ce}from"./Switch-1B_VZ16h.js";import{_ as Ie,a as Me}from"./Tabs-CqcYRKXl.js";import"./Add-D6uUqg2u.js";import"./debounce-D4NDO7dG.js";const Ue={class:"flex"},Re={class:"text-xl mt-[26px] flex items-center gap-1"},$e={class:"flex justify-between items-center w-full"},Be={class:"flex-1"},Pe={class:"text-xl"},Ve={class:"flex justify-end"},qe=D({__name:"DeviceGroup",setup(Se){const{t:n}=W(),S=Z(),I=ee(),_=p(!1),M=p(),c=p({description:void 0,device_group_name:void 0}),E={description:{required:!0,message:n("deviceGroup.descriptionErrMsg")},device_group_name:{required:!0,message:n("deviceGroup.groupNameErrMsg")}},U=()=>{_.value=!1,c.value={description:void 0,device_group_name:void 0}},O=()=>{var o;d.value||(d.value=!0,(o=M.value)==null||o.validate(async e=>{if(e){d.value=!1;return}const[i,l]=await Ge({...c.value,organization_id:u.value});d.value=!1,!i&&l&&l.status===0&&m()}))},T=o=>{o||U()},x=p(),y=te({page:1,per_page:ae,total:0}),d=p(!1),u=p(),m=async o=>{d.value=!0,x.value=void 0;const[e,i]=await ke({...be(y),org_id:o||u.value});d.value=!1,!e&&i&&i.status===0&&(x.value=i.data.list,y.total=i.data.total),_.value&&U()},A=async(o,e)=>{const[i,l]=await xe({device_id:e,hidden:!o});!i&&(l==null?void 0:l.status)===0&&m()},h=p(),K=async()=>{var i,l;const[o,e]=await we();if(!o&&(e==null?void 0:e.status)===0){h.value=(i=e.data)==null?void 0:i.organizations;const G=(l=e.data)==null?void 0:l.organizations;if(I.query.org)u.value=+I.query.org,ze(()=>{m()});else if(G&&G.length>0){const v=G[0].organization_id;v&&(u.value=v,m(v))}}};oe(()=>{K()});const j=[{title:n("deviceGroup.id"),key:"create_uid"},{title:n("deviceGroup.groupId"),key:"device_group_id"},{title:n("deviceGroup.groupName"),key:"device_group_name"},{title:n("deviceGroup.description"),key:"description"},{title:n("deviceGroup.createTime"),key:"create_time"},{title:n("createuser"),key:"user_name"},{title:n("deviceGroup.status"),key:"status",render:o=>{var e;if(o.status)return N(ne,{type:((e=P[o.status])==null?void 0:e.type)||"default",bordered:!1},{default:()=>{var i;return n((i=P[o.status])==null?void 0:i.text)}})}},{title:n("deviceGroup.show2desktop"),key:"status",render:o=>{if(o.status)return N("div",{onClick:e=>e.stopPropagation()},N(Ce,{value:!o.hidden,onUpdateValue:e=>A(e,o.device_group_id)}))}}],H=({device_group_name:o})=>({class:"cursor-pointer",onClick:()=>{S.push({name:"taskList",query:{device_group_name:o}})}});return(o,e)=>{var $,B;const i=ie,l=Ie,G=Me,v=de,F=pe,J=ve,w=fe,R=ye,Q=ge,X=me,Y=he;return L(),V("div",Ue,[g("div",null,[g("div",Re,[s(i,{component:t(se)},null,8,["component"]),b(" "+f(t(n)("org.orgList")),1)]),s(G,{placement:"left","bar-width":300,type:"card",value:t(u),"onUpdate:value":[e[0]||(e[0]=a=>C(u)?u.value=a:null),m],class:"pr-5 mt-7"},{default:r(()=>[(L(!0),V(re,null,le(t(h),a=>(L(),ue(l,{key:a.organization_id,name:a.organization_id,disabled:t(d),class:"min-w-[200px]"},{default:r(()=>[g("div",$e,[b(f(a.organization_name)+" ",1),s(q,{role:a.user_role},null,8,["role"])])]),_:2},1032,["name","disabled"]))),128))]),_:1},8,["value"])]),g("div",Be,[s(ce,{title:(B=($=t(h))==null?void 0:$.find(a=>a.organization_id==t(u)))==null?void 0:B.organization_name},{tag:r(()=>{var a,k;return[s(q,{role:(k=(a=t(h))==null?void 0:a.find(z=>z.organization_id==t(u)))==null?void 0:k.user_role},null,8,["role"])]}),extra:r(()=>[s(v,{type:"primary",onClick:e[1]||(e[1]=a=>_.value=!0)},{icon:r(()=>[s(t(Le))]),default:r(()=>[b(" "+f(t(n)("deviceGroup.create")),1)]),_:1})]),_:1},8,["title"]),s(F,{columns:j,data:t(x),pagination:!1,loading:t(d),"row-props":H},null,8,["data","loading"]),s(_e,{"page-info":t(y),"onUpdate:pageInfo":e[2]||(e[2]=a=>C(y)?y.value=a:null),onUpdateList:m},null,8,["page-info"]),s(Y,{show:t(_),"onUpdate:show":e[5]||(e[5]=a=>C(_)?_.value=a:null),"on-update:show":T},{default:r(()=>[s(X,{style:{width:"600px"},size:"huge",bordered:!1,role:"dialog","aria-modal":"true"},{default:r(()=>[s(J,{type:"info",class:"mb-5",bordered:!1},{default:r(()=>[b(f(t(n)("deviceGroup.tips")),1)]),_:1}),s(Q,{ref_key:"formRef",ref:M,model:t(c),rules:E},{default:r(()=>[s(w,{label:t(n)("deviceGroup.orgName"),path:"device_group_name"},{default:r(()=>{var a,k;return[g("div",Pe,f((k=(a=t(h))==null?void 0:a.find(z=>z.organization_id==t(u)))==null?void 0:k.organization_name),1)]}),_:1},8,["label"]),s(w,{label:t(n)("deviceGroup.groupNameLabel"),path:"device_group_name"},{default:r(()=>[s(R,{value:t(c).device_group_name,"onUpdate:value":e[3]||(e[3]=a=>t(c).device_group_name=a),placeholder:t(n)("deviceGroup.groupNamePlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),s(w,{label:t(n)("deviceGroup.descriptionLabel"),path:"description"},{default:r(()=>[s(R,{value:t(c).description,"onUpdate:value":e[4]||(e[4]=a=>t(c).description=a),placeholder:t(n)("deviceGroup.descriptionPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),g("div",Ve,[s(v,{type:"primary",loading:t(d),onClick:O},{default:r(()=>[b(f(t(n)("deviceGroup.create")),1)]),_:1},8,["loading"])])]),_:1},8,["model"])]),_:1})]),_:1},8,["show"])])])}}}),He=Ne(qe,[["__scopeId","data-v-8aa88ca5"]]);export{He as default};
