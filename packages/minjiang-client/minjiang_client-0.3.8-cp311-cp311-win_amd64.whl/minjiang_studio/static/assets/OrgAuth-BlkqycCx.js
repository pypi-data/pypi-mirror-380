import{d as M,r as d,b as $,o as I,E as U,f as w,L as j,l as e,M as F,w as o,i as n,v as H,h as C,k as J,m as P,n as Q,p as Y,$ as A,B as T,s as v,t as u,cO as G,cP as W,c as X,a2 as Z,e as q,z as ee,cJ as ne,ab as oe,ac as se,ad as te,a6 as V,cQ as ae,N as le,O as re,ae as ie,a9 as ce,cR as _e,aY as ue}from"./index-CvCv8tjC.js";import{A as de}from"./Add-DSV7m2CF.js";import{U as B}from"./UserMultiple-DRmqOSrm.js";const me={class:"flex justify-end"},pe=M({__name:"OrgModal",props:{type:{}},emits:["success"],setup(D,{expose:L,emit:O}){const m=d(),{t:l}=$(),y=O,b=d(!1),p=d(!1),h=()=>{p.value=!1,t.value={name:void 0,user_ids:void 0,admin_ids:void 0}},N=()=>{p.value=!0},c=d({name:{required:!0,message:l("common.required")},user_ids:{required:!0,message:l("common.required")},admin_ids:{required:!0,message:l("common.required")}}),r=d(null),t=d({name:void 0,user_ids:void 0,admin_ids:void 0}),x=()=>{var i;(i=r.value)==null||i.validate(async s=>{if(s)return;const[f,a]=await G(t.value);!f&&(a==null?void 0:a.status)===0&&(y("success"),h())})},R=async()=>{var f;const[i,s]=await W();!i&&(s==null?void 0:s.status)===0&&(m.value=(f=s.data)==null?void 0:f.map(a=>({...a,label:a.user_name,value:a.user_id})))};return I(()=>{R()}),L({open:N,close:h}),(i,s)=>{const f=Q,a=P,k=Y,z=J,_=T,S=A,E=H,K=j;return w(),U(K,{show:e(p),"onUpdate:show":s[3]||(s[3]=g=>F(p)?p.value=g:null),"mask-closable":!1,"close-on-esc":!1},{default:o(()=>[n(E,{bordered:!1,"content-class":"!px-5",style:{width:"700px"}},{default:o(()=>[n(z,{ref_key:"formRef",ref:r,model:e(t),rules:e(c),size:"small"},{default:o(()=>[n(a,{label:e(l)("org.orgName"),path:"name"},{default:o(()=>[n(f,{disabled:i.type==="edit",value:e(t).name,"onUpdate:value":s[0]||(s[0]=g=>e(t).name=g)},null,8,["disabled","value"])]),_:1},8,["label"]),n(a,{label:e(l)("org.admin"),path:"admin_ids"},{default:o(()=>[n(k,{value:e(t).admin_ids,"onUpdate:value":s[1]||(s[1]=g=>e(t).admin_ids=g),filterable:"",multiple:"",options:e(m)},null,8,["value","options"])]),_:1},8,["label"]),n(a,{label:e(l)("org.member"),path:"user_ids"},{default:o(()=>[n(k,{value:e(t).user_ids,"onUpdate:value":s[2]||(s[2]=g=>e(t).user_ids=g),filterable:"",multiple:"",options:e(m)},null,8,["value","options"])]),_:1},8,["label"])]),_:1},8,["model","rules"]),C("div",me,[n(S,null,{default:o(()=>[n(_,{onClick:h,loading:e(b)},{default:o(()=>[v(u(e(l)("common.cancel")),1)]),_:1},8,["loading"]),n(_,{type:"primary",onClick:x,loading:e(b)},{default:o(()=>[v(u(e(l)("common.OK")),1)]),_:1},8,["loading"])]),_:1})])]),_:1})]),_:1},8,["show"])}}}),fe=["onClick"],ge={class:"flex items-center gap-1"},ve={class:"flex items-center gap-1"},xe=M({__name:"OrgAuth",setup(D){const L=X(),O=Z(),{t:m}=$(),l=d(),y=d(),b=d(),p=async()=>{var t;const[c,r]=await _e();!c&&(r==null?void 0:r.status)===0&&(b.value=(t=r==null?void 0:r.data)==null?void 0:t.organizations)},h=()=>{y.value={type:"insert",show:!0},ue(()=>{var c;(c=l.value)==null||c.open()})},N=c=>{L.push({name:"org",query:{id:c}})};return I(()=>{p()}),(c,r)=>{var k,z;const t=T,x=le,R=ae,i=ie,s=A,f=te,a=ce;return w(),q("div",null,[n(ne,{title:e(m)("org.orgList")},{extra:o(()=>[n(t,{type:"primary",onClick:h},{icon:o(()=>[n(e(de))]),default:o(()=>[v(" "+u(e(m)("org.createOrg")),1)]),_:1})]),_:1},8,["title"]),n(a,{cols:4,"x-gap":16,"y-gap":16},{default:o(()=>[(w(!0),q(oe,null,se(e(b),_=>(w(),U(f,{key:_.organization_id},{default:o(()=>[C("div",{class:"border rounded-xl cursor-pointer",style:V({borderColor:e(O).dividerColor}),onClick:()=>N(_.organization_id)},[n(R,{class:"px-3 py-2 min-h-20 flex items-center"},{default:o(()=>[n(x,{class:"mr-1",component:e(re)},null,8,["component"]),v(" "+u(_.organization_name),1)]),_:2},1024),C("div",{class:"px-2 py-3 border-t",style:V({borderColor:e(O).dividerColor})},[n(s,null,{default:o(()=>[n(i,{bordered:!1,type:"success",round:""},{default:o(()=>[v(" ID "+u(_.organization_id),1)]),_:2},1024),n(i,{bordered:!1,type:"warning",round:""},{default:o(()=>[C("div",ge,[n(x,{component:e(B)},null,8,["component"]),v(" "+u(_.member_count)+" "+u(e(m)("org.cmember")),1)])]),_:2},1024),n(i,{bordered:!1,type:"info",round:""},{default:o(()=>[C("div",ve,[n(x,{component:e(B)},null,8,["component"]),v(" "+u(_.device_count)+" "+u(e(m)("org.cdevice")),1)])]),_:2},1024)]),_:2},1024)],4)],12,fe)]),_:2},1024))),128))]),_:1}),(k=e(y))!=null&&k.show?(w(),U(pe,{key:0,type:(z=e(y))==null?void 0:z.type,ref_key:"orgModalRef",ref:l,onSuccess:p},null,8,["type"])):ee("",!0)])}}});export{xe as default};
