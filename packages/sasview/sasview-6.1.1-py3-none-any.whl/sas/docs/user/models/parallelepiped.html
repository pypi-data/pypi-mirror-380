<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>parallelepiped &#8212; SasView 6.1.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/classic.css?v=2bf1fcf8" />
    
    <script src="../../_static/documentation_options.js?v=c7384f69"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="rectangular_prism" href="rectangular_prism.html" />
    <link rel="prev" title="hollow_rectangular_prism_thin_walls" href="hollow_rectangular_prism_thin_walls.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="rectangular_prism.html" title="rectangular_prism"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="hollow_rectangular_prism_thin_walls.html" title="hollow_rectangular_prism_thin_walls"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">SasView 6.1.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../user.html" >SasView User Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../qtgui/Perspectives/Fitting/models/index.html" >Model Functions</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../qtgui/Perspectives/Fitting/models/shape-parallelepiped.html" accesskey="U">Parallelepiped Functions</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">parallelepiped</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="parallelepiped">
<span id="id1"></span><h1>parallelepiped<a class="headerlink" href="#parallelepiped" title="Link to this heading">¶</a></h1>
<p>Rectangular parallelepiped with uniform scattering length density.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Default value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>scale</p></td>
<td><p>Scale factor or Volume fraction</p></td>
<td><p>None</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>background</p></td>
<td><p>Source background</p></td>
<td><p>cm<sup>-1</sup></p></td>
<td><p>0.001</p></td>
</tr>
<tr class="row-even"><td><p>sld</p></td>
<td><p>Parallelepiped scattering length density</p></td>
<td><p>10<sup>-6</sup>Å<sup>-2</sup></p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td><p>sld_solvent</p></td>
<td><p>Solvent scattering length density</p></td>
<td><p>10<sup>-6</sup>Å<sup>-2</sup></p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>length_a</p></td>
<td><p>Shorter side of the parallelepiped</p></td>
<td><p>Å</p></td>
<td><p>35</p></td>
</tr>
<tr class="row-odd"><td><p>length_b</p></td>
<td><p>Second side of the parallelepiped</p></td>
<td><p>Å</p></td>
<td><p>75</p></td>
</tr>
<tr class="row-even"><td><p>length_c</p></td>
<td><p>Larger side of the parallelepiped</p></td>
<td><p>Å</p></td>
<td><p>400</p></td>
</tr>
<tr class="row-odd"><td><p>theta</p></td>
<td><p>c axis to beam angle</p></td>
<td><p>degree</p></td>
<td><p>60</p></td>
</tr>
<tr class="row-even"><td><p>phi</p></td>
<td><p>rotation about beam</p></td>
<td><p>degree</p></td>
<td><p>60</p></td>
</tr>
<tr class="row-odd"><td><p>psi</p></td>
<td><p>rotation about c axis</p></td>
<td><p>degree</p></td>
<td><p>60</p></td>
</tr>
</tbody>
</table>
<p>The returned value is scaled to units of cm<sup>-1</sup> sr<sup>-1</sup>, absolute scale.</p>
<p><strong>Definition</strong></p>
<p>This model calculates the scattering from a rectangular solid
(<a class="reference internal" href="#parallelepiped-image"><span class="std std-numref">Fig. 69</span></a>).
If you need to apply polydispersity, see also <a class="reference internal" href="rectangular_prism.html#rectangular-prism"><span class="std std-ref">rectangular_prism</span></a>. For
information about polarised and magnetic scattering, see
the <a class="reference internal" href="../qtgui/Perspectives/Fitting/magnetism/magnetism.html#magnetism"><span class="std std-ref">Polarisation/Magnetic Scattering</span></a> documentation.</p>
<figure class="align-default" id="id5">
<span id="parallelepiped-image"></span><img alt="../../_images/parallelepiped_geometry.jpg" src="../../_images/parallelepiped_geometry.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 69 </span><span class="caption-text">Parallelepiped with the corresponding definition of sides.</span><a class="headerlink" href="#id5" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>The three dimensions of the parallelepiped (strictly here a cuboid) may be
given in <em>any</em> size order as long as the particles are randomly oriented (i.e.
take on all possible orientations see notes on 2D below). To avoid multiple fit
solutions, especially with Monte-Carlo fit methods, it may be advisable to
restrict their ranges. There may be a number of closely similar “best fits”, so
some trial and error, or fixing of some dimensions at expected values, may
help.</p>
<p>The form factor is normalized by the particle volume and the 1D scattering
intensity <span class="math notranslate nohighlight">\(I(q)\)</span> is then calculated as:</p>
<div class="math notranslate nohighlight">
\[I(q) = \frac{\text{scale}}{V} (\Delta\rho \cdot V)^2
       \left&lt; P(q, \alpha, \beta) \right&gt; + \text{background}\]</div>
<p>where the volume <span class="math notranslate nohighlight">\(V = A B C\)</span>, the contrast is defined as
<span class="math notranslate nohighlight">\(\Delta\rho = \rho_\text{p} - \rho_\text{solvent}\)</span>, <span class="math notranslate nohighlight">\(P(q, \alpha, \beta)\)</span>
is the form factor corresponding to a parallelepiped oriented
at an angle <span class="math notranslate nohighlight">\(\alpha\)</span> (angle between the long axis C and <span class="math notranslate nohighlight">\(\vec q\)</span>), and <span class="math notranslate nohighlight">\(\beta\)</span>
(the angle between the projection of the particle in the <span class="math notranslate nohighlight">\(xy\)</span> detector plane
and the <span class="math notranslate nohighlight">\(y\)</span> axis) and the averaging <span class="math notranslate nohighlight">\(\left&lt;\ldots\right&gt;\)</span> is applied over all
orientations.</p>
<p>Assuming <span class="math notranslate nohighlight">\(a = A/B &lt; 1\)</span>, <span class="math notranslate nohighlight">\(b = B /B = 1\)</span>, and <span class="math notranslate nohighlight">\(c = C/B &gt; 1\)</span>, the
form factor is given by (Mittelbach and Porod, 1961 <a class="footnote-reference brackets" href="#mittelbach1961" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>)</p>
<div class="math notranslate nohighlight">
\[P(q, \alpha) = \int_0^1 \phi_Q\left(\mu \sqrt{1-\sigma^2},a\right)
    \left[S(\mu c \sigma/2)\right]^2 d\sigma\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[\begin{split}\phi_Q(\mu,a) &amp;= \int_0^1
    \left\{S\left[\frac{\mu}{2}\cos\left(\frac{\pi}{2}u\right)\right]
           S\left[\frac{\mu a}{2}\sin\left(\frac{\pi}{2}u\right)\right]
           \right\}^2 du \\
S(x) &amp;= \frac{\sin x}{x} \\
\mu &amp;= qB\end{split}\]</div>
<p>where substitution of <span class="math notranslate nohighlight">\(\sigma = cos\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta = \pi/2 \ u\)</span> have been
applied.</p>
<p>For <strong>oriented</strong> particles, the 2D scattering intensity, <span class="math notranslate nohighlight">\(I(q_x, q_y)\)</span>, is
given as:</p>
<div class="math notranslate nohighlight">
\[I(q_x, q_y) = \frac{\text{scale}}{V} (\Delta\rho \cdot V)^2 P(q_x, q_y)
        + \text{background}\]</div>
<p>Where <span class="math notranslate nohighlight">\(P(q_x, q_y)\)</span> for a given orientation of the form factor is calculated as</p>
<div class="math notranslate nohighlight">
\[P(q_x, q_y) = \left[\frac{\sin(\tfrac{1}{2}qA\cos\alpha)}{(\tfrac{1}
               {2}qA\cos\alpha)}\right]^2
              \left[\frac{\sin(\tfrac{1}{2}qB\cos\beta)}{(\tfrac{1}
               {2}qB\cos\beta)}\right]^2
              \left[\frac{\sin(\tfrac{1}{2}qC\cos\gamma)}{(\tfrac{1}
               {2}qC\cos\gamma)}\right]^2\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[\begin{split}\cos\alpha &amp;= \hat A \cdot \hat q, \\
\cos\beta  &amp;= \hat B \cdot \hat q, \\
\cos\gamma &amp;= \hat C \cdot \hat q\end{split}\]</div>
<p><strong>FITTING NOTES</strong></p>
<ol class="arabic simple">
<li><p>The 2nd virial coefficient of the parallelepiped is calculated based on
the averaged effective radius, after appropriately sorting the three
dimensions, to give an oblate or prolate particle, <span class="math notranslate nohighlight">\((=\sqrt{AB/\pi})\)</span> and
length <span class="math notranslate nohighlight">\((= C)\)</span> values, and used as the effective radius for
<span class="math notranslate nohighlight">\(S(q)\)</span> when <span class="math notranslate nohighlight">\(P(q) \cdot S(q)\)</span> is applied.</p></li>
<li><p>For 2d data the orientation of the particle is required, described using
angles <span class="math notranslate nohighlight">\(\theta\)</span>, <span class="math notranslate nohighlight">\(\phi\)</span> and <span class="math notranslate nohighlight">\(\Psi\)</span> as in the diagrams below, where <span class="math notranslate nohighlight">\(\theta\)</span>
and <span class="math notranslate nohighlight">\(\phi\)</span> define the orientation of the director in the laboratory reference
frame of the beam direction (<span class="math notranslate nohighlight">\(z\)</span>) and detector plane (<span class="math notranslate nohighlight">\(x-y\)</span> plane), while
the angle <span class="math notranslate nohighlight">\(\Psi\)</span> is effectively the rotational angle around the particle
<span class="math notranslate nohighlight">\(C\)</span> axis. For <span class="math notranslate nohighlight">\(\theta = 0\)</span> and <span class="math notranslate nohighlight">\(\phi = 0\)</span>, <span class="math notranslate nohighlight">\(\Psi = 0\)</span> corresponds to the
<span class="math notranslate nohighlight">\(B\)</span> axis oriented parallel to the y-axis of the detector with <span class="math notranslate nohighlight">\(A\)</span> along
the x-axis. For other <span class="math notranslate nohighlight">\(\theta\)</span>, <span class="math notranslate nohighlight">\(\phi\)</span> values, the order of rotations
matters. In particular, the parallelepiped must first be rotated <span class="math notranslate nohighlight">\(\theta\)</span>
degrees in the <span class="math notranslate nohighlight">\(x-z\)</span> plane before rotating <span class="math notranslate nohighlight">\(\phi\)</span> degrees around the <span class="math notranslate nohighlight">\(z\)</span>
axis (in the <span class="math notranslate nohighlight">\(x-y\)</span> plane). Applying orientational distribution to the
particle orientation (i.e  <cite>jitter</cite> to one or more of these angles) can get
more confusing as <cite>jitter</cite> is defined <strong>NOT</strong> with respect to the laboratory
frame but the particle reference frame. It is thus highly recommended to
read <a class="reference internal" href="../qtgui/Perspectives/Fitting/orientation/orientation.html#orientation"><span class="std std-ref">Oriented Particles</span></a> for further details of the calculation and angular
dispersions.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For 2d, constraints must be applied during fitting to ensure that the
order of sides chosen is not altered, and hence that the correct definition
of angles is preserved. For the default choice shown here, that means
ensuring that the inequality <span class="math notranslate nohighlight">\(A &lt; B &lt; C\)</span> is not violated,  The calculation
will not report an error, but the results may be not correct.</p>
</div>
<figure class="align-default" id="id6">
<span id="parallelepiped-orientation"></span><img alt="../../_images/parallelepiped_angle_definition.png" src="../../_images/parallelepiped_angle_definition.png" />
<figcaption>
<p><span class="caption-number">Fig. 70 </span><span class="caption-text">Definition of the angles for oriented parallelepiped, shown with <span class="math notranslate nohighlight">\(A&lt;B&lt;C\)</span>.</span><a class="headerlink" href="#id6" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id7">
<img alt="../../_images/parallelepiped_angle_projection.png" src="../../_images/parallelepiped_angle_projection.png" />
<figcaption>
<p><span class="caption-number">Fig. 71 </span><span class="caption-text">Examples of the angles for an oriented parallelepiped against the
detector plane.</span><a class="headerlink" href="#id7" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p><strong>Validation</strong></p>
<p>Validation of the code was done by comparing the output of the 1D calculation
to the angular average of the output of a 2D calculation over all possible
angles.</p>
<figure class="align-default" id="id8">
<img alt="../../_images/parallelepiped_autogenfig.png" src="../../_images/parallelepiped_autogenfig.png" />
<figcaption>
<p><span class="caption-number">Fig. 72 </span><span class="caption-text">1D and 2D plots corresponding to the default parameters of the model.</span><a class="headerlink" href="#id8" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p><strong>Source</strong></p>
<p><a class="reference download internal" download="" href="../../_downloads/4b46e283bf87246a470c8278bc4fd5dc/parallelepiped.py"><code class="xref download docutils literal notranslate"><span class="pre">parallelepiped.py</span></code></a>
<span class="math notranslate nohighlight">\(\ \star\ \)</span> <a class="reference download internal" download="" href="../../_downloads/6d56a41815340100ed409e6dd1651662/parallelepiped.c"><code class="xref download docutils literal notranslate"><span class="pre">parallelepiped.c</span></code></a>
<span class="math notranslate nohighlight">\(\ \star\ \)</span> <a class="reference download internal" download="" href="../../_downloads/9ee45b8c6371b0a130036ee53e1f050e/gauss76.c"><code class="xref download docutils literal notranslate"><span class="pre">gauss76.c</span></code></a></p>
<p><strong>References</strong></p>
<p>See also Nayuk <a class="footnote-reference brackets" href="#nayuk2012" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> and Onsager <a class="footnote-reference brackets" href="#onsager1949" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>.</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="mittelbach1961" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">1</a><span class="fn-bracket">]</span></span>
<p>P Mittelbach and G Porod, <em>Acta Physica Austriaca</em>,
14 (1961) 185-211</p>
</aside>
<aside class="footnote brackets" id="nayuk2012" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">2</a><span class="fn-bracket">]</span></span>
<p>R Nayuk and K Huber, <em>Z. Phys. Chem.</em>, 226 (2012) 837-854</p>
</aside>
<aside class="footnote brackets" id="onsager1949" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">3</a><span class="fn-bracket">]</span></span>
<ol class="upperalpha simple" start="12">
<li><p>Onsager, <em>Ann. New York Acad. Sci.</em>, 51 (1949) 627-659</p></li>
</ol>
</aside>
</aside>
<p><strong>Authorship and Verification</strong></p>
<ul class="simple">
<li><p><strong>Author:</strong> NIST IGOR/DANSE <strong>Date:</strong> pre 2010</p></li>
<li><p><strong>Last Modified by:</strong>  Paul Kienzle <strong>Date:</strong> April 05, 2017</p></li>
<li><p><strong>Last Reviewed by:</strong>  Miguel Gonzales and Paul Butler <strong>Date:</strong> May 24,
2018 - documentation updated</p></li>
</ul>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="hollow_rectangular_prism_thin_walls.html"
                          title="previous chapter">hollow_rectangular_prism_thin_walls</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="rectangular_prism.html"
                          title="next chapter">rectangular_prism</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/user/models/parallelepiped.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="rectangular_prism.html" title="rectangular_prism"
             >next</a> |</li>
        <li class="right" >
          <a href="hollow_rectangular_prism_thin_walls.html" title="hollow_rectangular_prism_thin_walls"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">SasView 6.1.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../user.html" >SasView User Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../qtgui/Perspectives/Fitting/models/index.html" >Model Functions</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../qtgui/Perspectives/Fitting/models/shape-parallelepiped.html" >Parallelepiped Functions</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">parallelepiped</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2025, The SasView Project.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>