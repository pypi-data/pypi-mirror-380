alias:
  type: string
  regex: '^[a-zA-Z0-9_/-]+$'
  noneof_regex:
    - '^[0-9]/.*$' # does not start with a single digit and /
    - '^/.*$'      # does not start with /
    - '^.*/$'      # does not end with /

machine:
  type: string
code:
  type: dict
  required: true
  schema:
    name:
      type: string
time:
  type: numpy
  coerce: numpy
global_quantities:
  type: dict
  schema:
    b0:
      type: dict
      required: true
      schema:
        value:
          type: numpy
          coerce: numpy
          lt: 0
    r0:
      type: dict
      schema:
        value:
          type: float
#         coerce: numpy
          gt: 0
    beta_pol:
      type: dict
      schema:
        value:
          type: numpy
          coerce: numpy
          ge: 0
    current_bootstrap:
      type: dict
      schema:
        value:
          type: numpy
          coerce: numpy
    current_non_inductive:
      type: dict
      schema:
        value:
          type: numpy
          coerce: numpy
    current_ohm:
      type: dict
      schema:
        value:
          type: numpy
          coerce: numpy
    energy_diamagnetic:
      type: dict
      schema:
        value:
          type: numpy
          coerce: numpy
          ge: 0
    energy_thermal:
      type: dict
      schema:
        value:
          type: numpy
          coerce: numpy
    energy_total:
      type: dict
      schema:
        value:
          type: numpy
          coerce: numpy
      # h_98 validation temporarily disabled due to ambiguous specification.
      # Later it will be replaced by imas-validator.
      #h_98:
        #  type: dict
        #  schema:
        #    value:
        #      type: numpy
        #      coerce: numpy
        #      ge: 0
    h_mode:
      type: dict
      schema:
        value:
          type: numpy
          coerce: numpy
    ip:
      type: dict
      required: true
      schema:
        value:
          type: numpy
          coerce: numpy
          ge: -17000000
          le: 0
    tau_energy:
      type: dict
      schema:
        value:
          type: numpy
          coerce: numpy
          # ge: 0
    v_loop:
      type: dict
      schema:
        value:
          type: numpy
          coerce: numpy
          # le: 0
local:
  type: dict
  schema:
    separatrix:
      type: dict
      schema:
        n_e:
          type: dict
          schema:
            value:
              type: numpy
              coerce: numpy
              ge: 0
        zeff:
          type: dict
          schema:
            value:
              type: numpy
              coerce: numpy
              # Tolerance set to 0.999999999999 for floating point precision handling when comparing to 1
              ge: 0.999999999999
equilibrium:
#  required: true
  type: dict
  schema:
    time_slice:
      type: list
      schema:
        global_quantities:
          type: dict
          schema:
            ip:
              type: numpy
              coerce: numpy
              le: -17000000
              gt: 0
        profiles_2d:
          type: list
          schema:
            phi:
              type: float
            psi:
              type: float
            r:
              type: float
              gt: 0
            z:
              type: float
    vacuum_toroidal_field:
      type: dict
      schema:
        r0:
          type: float
          gt: 0
        b0:
          type: float
          lt: 0
core_profiles:
#  required: true
  type: dict
  schema:
    global_quantities:
      type: dict
      schema:
        beta_pol:
          type: float
        beta_tor_norm:
          type: float
          min: 0
          max: 1
        current_bootstrap:
          type: float
        current_non_inductive:
          type: float
        energy_diamagnetic:
          type: float
        ip:
          type: float
          min: -17000000
          max: 0
        v_loop:
          type: float
    profiles_1d:
      type: list
      schema:
        e_field:
          type: dict
          schema:
            radial:
              type: float
        electrons:
          type: dict
          schema:
            density:
              type: float
              ge: 0
            pressure:
              type: float
              ge: 0
            pressure_fast_parallel:
              type: float
            pressure_fast_perpendicular:
              type: float
            pressure_thermal:
              type: float
            temperature:
              type: float
              ge: 0
        grid:
          type: dict
          schema:
            rho_tor:
              type: float
            rho_tor_norm:
              type: float
              ge: 0
              le: 1
            psi:
              type: float
            volume:
              type: float
              ge: 0
        ion:
          type: list
          schema:
            density:
              type: float
            element:
              type: list
              schema:
                a:
                  type: float
                  gt: 0
                z_n:
                  type: float
                  gt: 0
            pressure:
              type: float
              ge: 0
            pressure_fast_parallel:
              type: float
              ge: 0
            pressure_fast_perpendicular:
              type: float
              ge: 0
            pressure_thermal:
              type: float
              ge: 0
            temperature:
              type: float
              ge: 0
            velocity:
              type: dict
              schema:
                diamagnetic:
                  type: float
                poloidal:
                  type: float
                toroidal:
                  type: float
        j_bootstrap:
          type: float
        j_non_inductive:
          type: float
        j_ohmic:
          type: float
        j_total:
          type: float
        magnetic_shear:
          type: float
        pressure_ion_total:
          type: float
          ge: 0
        pressure_parallel:
          type: float
          ge: 0
        pressure_perpendicular:
          type: float
          ge: 0
        pressure_thermal:
          type: float
          ge: 0
        q:
          type: float
        t_i_average:
          type: float
        zeff:
          type: float
          ge: 0

