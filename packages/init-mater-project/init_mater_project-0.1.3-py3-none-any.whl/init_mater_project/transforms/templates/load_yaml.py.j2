# YAML data
    with open("{{ dataset_path }}", "r", encoding="utf-8") as file:
        raw_data = yaml.safe_load(file)

    # Convert to DataFrame
    if isinstance(raw_data, list):
        df = pd.DataFrame(raw_data)
    else:
        # Handle dict structure - adjust as needed
        df = pd.json_normalize(raw_data)

    print(f"Loaded {len(df)} records from YAML file")

    # Optional: filter columns after loading
    # df = df[["col1", "col2", "col3"]]