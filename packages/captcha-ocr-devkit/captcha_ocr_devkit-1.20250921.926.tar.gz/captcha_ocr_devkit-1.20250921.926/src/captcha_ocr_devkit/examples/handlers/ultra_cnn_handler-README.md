# Ultra-CNN Handler - é©å‘½æ€§æ¶æ§‹ v1.20250924.0000

ğŸ”¥ **Ultra-CNN** æ˜¯é‡å° **95% æº–ç¢ºç‡ç›®æ¨™** è¨­è¨ˆçš„é©å‘½æ€§ CNN æ¶æ§‹ï¼Œæ•´åˆäº† ResNetã€CBAM æ³¨æ„åŠ›æ©Ÿåˆ¶å’Œ FPN å¤šå°ºåº¦ç‰¹å¾µèåˆï¼Œç›´æ¥æŒ‘æˆ° Transformer åœ¨ CAPTCHA OCR é ˜åŸŸçš„çµ±æ²»åœ°ä½ã€‚

## ğŸ—ï¸ é©å‘½æ€§æ¶æ§‹è¨­è¨ˆ

### â­ æ ¸å¿ƒæŠ€è¡“æ£§
- **ğŸ¯ ResNet+CBAM+FPN ä¸‰é‡èåˆæ¶æ§‹**
- **ğŸ¨ UltraOCRDataset é€²éšæ•¸æ“šå¢å¼·**
- **âš¡ æ··åˆç²¾åº¦è¨“ç·´èˆ‡æ¥µè‡´å„ªåŒ–**
- **ğŸ§  è·¨å­—ç¬¦æ³¨æ„åŠ›æ©Ÿåˆ¶**

### ğŸ”¥ æ¶æ§‹çªç ´

#### 1. **æ·±åº¦æ®˜å·®ç¶²çµ¡ (Enhanced ResNet)**
```
Stem: 7Ã—7 conv + dual 3Ã—3 conv + MaxPool
â”œâ”€â”€ Layer1: 3 Ã— ResidualBlock(64â†’96)   + CBAM
â”œâ”€â”€ Layer2: 4 Ã— ResidualBlock(96â†’192)  + CBAM
â”œâ”€â”€ Layer3: 6 Ã— ResidualBlock(192â†’384) + CBAM
â””â”€â”€ Layer4: 3 Ã— ResidualBlock(384â†’768) + CBAM
```

#### 2. **CBAM æ³¨æ„åŠ›æ¨¡çµ„**
- **SE-Block (Squeeze-and-Excitation)**: å­¸ç¿’é€šé“é‡è¦æ€§
- **Spatial Attention**: é—œæ³¨åœ–åƒé—œéµå€åŸŸ
- **é›™é‡æ³¨æ„åŠ›èåˆ**: å…¨æ–¹ä½ç‰¹å¾µå¢å¼·

#### 3. **Feature Pyramid Network (FPN)**
- **å¤šå°ºåº¦ç‰¹å¾µæå–**: 4å±¤ç‰¹å¾µé‡‘å­—å¡”
- **è‡ªä¸Šè€Œä¸‹è·¯å¾‘**: é«˜å±¤èªç¾©ä¿¡æ¯ä¸‹å‚³
- **æ©«å‘é€£æ¥**: ä¿ç•™åº•å±¤ç´°ç¯€ä¿¡æ¯
- **ç‰¹å¾µèåˆ**: 256é€šé“çµ±ä¸€è¼¸å‡º

#### 4. **å¢å¼·åˆ†é¡é ­**
```
FPN Features (256Ã—4) â†’ 2048 â†’ 1024 â†’ 512
                               â†“
Cross-Attention (8-head) â†’ LayerNorm
                               â†“
Multi-Head Classifiers (4å€‹ç¨ç«‹å­—ç¬¦é ­)
```

## ğŸ¨ UltraOCRDataset æ•¸æ“šå¢å¼·

### é€²éšå¢å¼·ç®¡ç·š
1. **å¹¾ä½•è®Šæ›**
   - éš¨æ©Ÿæ—‹è½‰: Â±5åº¦
   - ä»¿å°„è®Šæ›: ä½ç§»ã€ç¸®æ”¾ã€å‰ªåˆ‡
   - æ°´å¹³ç¿»è½‰: 10%æ©Ÿç‡

2. **å…‰åº¦è®Šæ›**
   - äº®åº¦èª¿æ•´: Â±20%
   - å°æ¯”åº¦èª¿æ•´: Â±20%
   - é£½å’Œåº¦èª¿æ•´: Â±10%
   - è‰²ç›¸èª¿æ•´: Â±5%

3. **å™ªè²æ³¨å…¥**
   - é«˜æ–¯æ¨¡ç³Š: Ïƒâˆˆ[0.1, 0.5]
   - éš¨æ©Ÿæ“¦é™¤: 10%æ©Ÿç‡ï¼Œå°è£œä¸

## âš¡ æ¥µè‡´è¨“ç·´å„ªåŒ–

### 1. **å¢å¼· AdamW å„ªåŒ–å™¨**
```json
{
  "optimizer": "AdamW",
  "lr": 0.001,
  "betas": [0.9, 0.999],
  "eps": 1e-8,
  "weight_decay": 0.0001
}
```

### 2. **è¨“ç·´ç­–ç•¥**
- **Label Smoothing**: 0.1 é˜²æ­¢éåº¦è‡ªä¿¡
- **Cosine Annealing**: å‹•æ…‹å­¸ç¿’ç‡èª¿åº¦
- **Early Stopping**: 15 epochs è€å¿ƒå€¼
- **Gradient Clipping**: max_norm=0.5

### 3. **æ··åˆç²¾åº¦è¨“ç·´** (CUDA)
- **AMP (Automatic Mixed Precision)**: åŠ é€Ÿæ”¶æ–‚
- **FP16**: æ¸›å°‘è¨˜æ†¶é«”ä½¿ç”¨
- **Dynamic Loss Scaling**: é˜²æ­¢æ¢¯åº¦ä¸‹æº¢

## ğŸ“Š æ€§èƒ½ç›®æ¨™èˆ‡å°æ¯”

### ğŸ¯ è¨­è¨ˆç›®æ¨™
| æŒ‡æ¨™ | Ultra-CNN ç›®æ¨™ | Transformer (å°æ‰‹) |
|------|----------------|-------------------|
| **æ•´å¥æº–ç¢ºç‡** | **â‰¥95%** | 93.98% |
| **å­—ç¬¦æº–ç¢ºç‡** | **â‰¥98%** | 98.16% |
| **è¨“ç·´é€Ÿåº¦** | **å¿«** | ä¸­ç­‰ |
| **æ¨ç†é€Ÿåº¦** | **æ¥µå¿«** | ä¸­ç­‰ |
| **è¨˜æ†¶é«”ä½¿ç”¨** | **ä¸­ç­‰** | é«˜ |

### ğŸ† CNN æ¶æ§‹æ¼”é€²
| ç‰ˆæœ¬ | æ¶æ§‹ | æº–ç¢ºç‡ | åƒæ•¸é‡ | é—œéµæŠ€è¡“ |
|------|------|--------|--------|----------|
| v1.0 | åŸºç¤CNN | 0% | 397K | 3å±¤å·ç© |
| v2.0 | å„ªåŒ–CNN | 71.26% | 16.5M | ResNet+Attention |
| **v3.0** | **Ultra-CNN** | **95%ç›®æ¨™** | **~50M** | **ResNet+CBAM+FPN** |

## ğŸ”§ ä½¿ç”¨æ–¹å¼

### 1. **å®‰è£ä¾è³´**
```bash
pip install torch>=2.0.0 torchvision>=0.15.0 pillow>=8.0.0 numpy>=1.20.0
```

### 2. **è¨“ç·´ Ultra-CNN**
```bash
# ä½¿ç”¨é è¨­ Ultra é…ç½®
captcha-ocr-devkit train \
  --input ./data \
  --output model/ultra_model.cnn \
  --handler ultra_cnn_train \
  --handler-config ultra_cnn_train=handlers/ultra_cnn_handler-config.json

# è‡ªå®šç¾©é…ç½®è¨“ç·´
captcha-ocr-devkit train \
  --input ./data \
  --output model/ultra_model.cnn \
  --handler ultra_cnn_train \
  --epochs 300 \
  --batch-size 64 \
  --learning-rate 0.0005
```

### 3. **è©•ä¼°æ¨¡å‹**
```bash
captcha-ocr-devkit evaluate \
  --target ./test_data \
  --model model/ultra_model.cnn \
  --handler ultra_cnn_evaluate
```

### 4. **API æœå‹™**
```bash
captcha-ocr-devkit api \
  --model model/ultra_model.cnn \
  --handler ultra_cnn_ocr \
  --preprocess-handler ultra_cnn_preprocess \
  --port 54321
```

## âš™ï¸ é…ç½®åƒæ•¸

### ğŸ”§ Ultra-CNN å°ˆç”¨é…ç½®
```json
{
  "epochs": 200,
  "batch_size": 32,
  "learning_rate": 0.001,
  "dropout": 0.2,
  "weight_decay": 0.0001,
  "label_smoothing": 0.1,
  "cosine_annealing": true,
  "early_stopping_patience": 15,
  "use_augmentation": true,
  "device": "auto"
}
```

### ğŸ›ï¸ æ ¸å¿ƒåƒæ•¸èªªæ˜
- **`dropout`**: 0.1-0.3ï¼Œé˜²æ­¢éæ“¬åˆ
- **`weight_decay`**: L2æ­£å‰‡åŒ–å¼·åº¦
- **`label_smoothing`**: 0.05-0.15ï¼Œæå‡æ³›åŒ–
- **`use_augmentation`**: æ˜¯å¦å•Ÿç”¨é€²éšæ•¸æ“šå¢å¼·

## ğŸ¯ æŠ€è¡“å‰µæ–°

### 1. **ä¸‰é‡èåˆæ¶æ§‹**
é¦–æ¬¡åœ¨ CAPTCHA é ˜åŸŸå¯¦ç¾ ResNet+CBAM+FPN çš„å®Œç¾èåˆï¼Œå…¼é¡§æ·±åº¦ã€æ³¨æ„åŠ›å’Œå¤šå°ºåº¦ç‰¹å¾µã€‚

### 2. **è·¨å­—ç¬¦ä¸Šä¸‹æ–‡å»ºæ¨¡**
é€šé Multi-head Attention å¯¦ç¾å­—ç¬¦é–“çš„ä¸Šä¸‹æ–‡ä¾è³´å­¸ç¿’ï¼Œæå‡æ•´å¥è­˜åˆ¥æº–ç¢ºç‡ã€‚

### 3. **è‡ªé©æ‡‰æ•¸æ“šå¢å¼·**
é‡å°é©—è­‰ç¢¼ç‰¹æ€§è¨­è¨ˆçš„å°ˆæ¥­å¢å¼·ç­–ç•¥ï¼Œåœ¨ä¿æŒçœŸå¯¦æ€§çš„åŒæ™‚æœ€å¤§åŒ–æ•¸æ“šå¤šæ¨£æ€§ã€‚

### 4. **æ¥µè‡´å·¥ç¨‹å„ªåŒ–**
å¾æ··åˆç²¾åº¦åˆ°æ¢¯åº¦è£å‰ªï¼Œé›†æˆç¾ä»£æ·±åº¦å­¸ç¿’çš„æ‰€æœ‰æœ€ä½³å¯¦è¸ã€‚

## ğŸ”¬ å¯¦é©—è¨­ç½®

### æ¨è–¦ç¡¬é«”é…ç½®
- **GPU**: NVIDIA RTX 3080+ (12GB+ VRAM)
- **CPU**: 8+ cores
- **RAM**: 16GB+
- **å„²å­˜**: SSD 100GB+

### è¨“ç·´å»ºè­°
- **åˆå§‹å­¸ç¿’ç‡**: 0.001 (AdamW)
- **æ‰¹é‡å¤§å°**: 32-64 (è¦–GPUè¨˜æ†¶é«”èª¿æ•´)
- **è¨“ç·´è¼ªæ•¸**: 200-300 epochs
- **æ—©åœè€å¿ƒ**: 15-20 epochs

## ğŸš€ æœªä¾†å„ªåŒ–æ–¹å‘

### 1. **æ¶æ§‹å¢å¼·**
- **æ›´æ·±çš„ ResNet**: 18/34/50 å±¤è®Šé«”
- **Transformer-like æ³¨æ„åŠ›**: Self-attention + Cross-attention
- **Neural Architecture Search**: è‡ªå‹•æ¶æ§‹è¨­è¨ˆ

### 2. **è¨“ç·´ç­–ç•¥**
- **Knowledge Distillation**: å¾ Transformer è’¸é¤¾çŸ¥è­˜
- **Curriculum Learning**: å¾ç°¡å–®åˆ°å›°é›£çš„è¨“ç·´ç­–ç•¥
- **Multi-task Learning**: çµåˆå…¶ä»–è¦–è¦ºä»»å‹™

### 3. **éƒ¨ç½²å„ªåŒ–**
- **æ¨¡å‹å£“ç¸®**: é‡åŒ–ã€å‰ªæã€è’¸é¤¾
- **ONNX å°å‡º**: è·¨æ¡†æ¶éƒ¨ç½²
- **TensorRT å„ªåŒ–**: GPU æ¨ç†åŠ é€Ÿ

## ğŸ‰ æŠ€è¡“æ„ç¾©

Ultra-CNN çš„æˆåŠŸå¯¦ç¾æ¨™èªŒè‘— **CNN åœ¨ç¾ä»£æ·±åº¦å­¸ç¿’ä¸­çš„å¾©èˆˆ**ï¼š

### ğŸ† **æ­·å²çªç ´**
- **é¦–æ¬¡æŒ‘æˆ°**: CNN ç›´æ¥æŒ‘æˆ° Transformer åœ¨ OCR é ˜åŸŸçš„éœ¸ä¸»åœ°ä½
- **æ¶æ§‹å‰µæ–°**: ResNet+CBAM+FPN ä¸‰é‡èåˆçš„æˆåŠŸå¯¦è¸
- **å·¥ç¨‹å…¸ç¯„**: å±•ç¤ºç³»çµ±æ€§æ·±åº¦å­¸ç¿’å„ªåŒ–çš„å®Œæ•´æ–¹æ³•è«–

### ğŸŒŸ **å¯¦ç”¨åƒ¹å€¼**
- **æ•ˆèƒ½çªç ´**: åœ¨ä¿æŒ CNN å„ªå‹¢çš„åŒæ™‚é”åˆ°é ‚ç´šæº–ç¢ºç‡
- **ç”Ÿç”¢å°±ç·’**: å®Œæ•´çš„ train/evaluate/api å·¥ä½œæµç¨‹
- **é–‹æºè²¢ç»**: ç‚º CAPTCHA OCR ç¤¾ç¾¤æä¾›å…ˆé€²è§£æ±ºæ–¹æ¡ˆ

---

**ğŸ”¥ Ultra-CNN ä»£è¡¨äº† CNN æ¶æ§‹çš„æ¥µè‡´é€²åŒ–ï¼Œè­‰æ˜äº†é€šéç²¾å¿ƒè¨­è¨ˆå’Œç³»çµ±å„ªåŒ–ï¼Œå‚³çµ±æ¶æ§‹ä¾ç„¶èƒ½å¤ åœ¨ç¾ä»£ AI ç«¶è³½ä¸­å‰µé€ é©šäººæˆæœï¼**