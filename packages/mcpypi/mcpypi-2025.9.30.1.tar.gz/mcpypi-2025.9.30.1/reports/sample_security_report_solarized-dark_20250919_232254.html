<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Security Test Report - Solarized-Dark Theme">
    <title>Security Test Report - Solarized-Dark Theme - MCPyPI Security Test Suite</title>

    <style>
/* CSS Reset and Base Styles */
*, *::before, *::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

/* Theme Variables - Gruvbox Dark */
:root {
    --gruvbox-dark0: #282828;
    --gruvbox-dark1: #3c3836;
    --gruvbox-dark2: #504945;
    --gruvbox-dark3: #665c54;
    --gruvbox-light0: #ebdbb2;
    --gruvbox-light1: #d5c4a1;
    --gruvbox-light2: #bdae93;
    --gruvbox-light4: #928374;
    --gruvbox-red: #fb4934;
    --gruvbox-green: #b8bb26;
    --gruvbox-yellow: #fabd2f;
    --gruvbox-blue: #83a598;
    --gruvbox-purple: #d3869b;
    --gruvbox-aqua: #8ec07c;
    --gruvbox-orange: #fe8019;
    --gruvbox-red-dim: #cc241d;
    --gruvbox-green-dim: #98971a;
    --gruvbox-yellow-dim: #d79921;
    --gruvbox-blue-dim: #458588;
    --gruvbox-purple-dim: #b16286;
    --gruvbox-aqua-dim: #689d6a;
    --gruvbox-orange-dim: #d65d0e;
}

/* Theme Application */
.theme-gruvbox-dark {
    --bg-primary: var(--gruvbox-dark0);
    --bg-secondary: var(--gruvbox-dark1);
    --bg-tertiary: var(--gruvbox-dark2);
    --bg-quaternary: var(--gruvbox-dark3);
    --text-primary: var(--gruvbox-light0);
    --text-secondary: var(--gruvbox-light1);
    --text-muted: var(--gruvbox-light4);
    --border-color: var(--gruvbox-dark3);
    --accent-success: var(--gruvbox-green);
    --accent-warning: var(--gruvbox-yellow);
    --accent-error: var(--gruvbox-red);
    --accent-info: var(--gruvbox-blue);
    --accent-primary: var(--gruvbox-orange);
    --accent-secondary: var(--gruvbox-purple);
    --accent-tertiary: var(--gruvbox-aqua);
}

/* Solarized Dark Theme */
.theme-solarized-dark {
    --bg-primary: #002b36;
    --bg-secondary: #073642;
    --bg-tertiary: #586e75;
    --bg-quaternary: #657b83;
    --text-primary: #839496;
    --text-secondary: #93a1a1;
    --text-muted: #586e75;
    --border-color: #073642;
    --accent-success: #859900;
    --accent-warning: #b58900;
    --accent-error: #dc322f;
    --accent-info: #268bd2;
    --accent-primary: #cb4b16;
    --accent-secondary: #d33682;
    --accent-tertiary: #2aa198;
}

/* Dracula Theme */
.theme-dracula {
    --bg-primary: #282a36;
    --bg-secondary: #44475a;
    --bg-tertiary: #6272a4;
    --bg-quaternary: #8be9fd;
    --text-primary: #f8f8f2;
    --text-secondary: #6272a4;
    --text-muted: #6272a4;
    --border-color: #44475a;
    --accent-success: #50fa7b;
    --accent-warning: #f1fa8c;
    --accent-error: #ff5555;
    --accent-info: #8be9fd;
    --accent-primary: #bd93f9;
    --accent-secondary: #ff79c6;
    --accent-tertiary: #ffb86c;
}

/* Base Styles */
body {
    font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', 'Source Code Pro', monospace;
    background: var(--bg-primary);
    color: var(--text-primary);
    line-height: 1.6;
    font-size: 14px;
    overflow-x: auto;
}

/* Terminal Window */
.terminal-window {
    background: var(--bg-primary);
    min-height: 100vh;
    position: relative;
}

/* Header */
.terminal-header {
    background: var(--bg-secondary);
    padding: 1rem 2rem;
    border-bottom: 2px solid var(--border-color);
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 1rem;
}

.terminal-title {
    font-size: 1.5rem;
    font-weight: bold;
    color: var(--accent-primary);
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.terminal-title::before {
    content: "🔒";
    font-size: 1.2em;
}

.terminal-meta {
    color: var(--text-muted);
    font-size: 0.9rem;
    display: flex;
    gap: 2rem;
    flex-wrap: wrap;
}

/* Status Line */
.status-line {
    background: var(--accent-info);
    color: var(--bg-primary);
    padding: 0.5rem 2rem;
    font-weight: bold;
    font-size: 0.9rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 1rem;
}

.status-indicator {
    display: flex;
    align-items: center;
    gap: 0.25rem;
}

/* Terminal Body */
.terminal-body {
    padding: 2rem;
    background: var(--bg-primary);
}

/* Cards and Sections */
.card {
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    margin: 1rem 0;
    overflow: hidden;
}

.card-header {
    background: var(--bg-tertiary);
    padding: 1rem 1.5rem;
    border-bottom: 1px solid var(--border-color);
    font-weight: bold;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.card-body {
    padding: 1.5rem;
}

/* Grid Layouts */
.grid {
    display: grid;
    gap: 1rem;
}

.grid-2 { grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); }
.grid-3 { grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); }
.grid-4 { grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); }

/* Summary Dashboard */
.summary-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 1rem;
    margin: 1rem 0;
}

.stat-card {
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    padding: 1.5rem 1rem;
    text-align: center;
    border-radius: 4px;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.stat-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.stat-value {
    font-size: 2rem;
    font-weight: bold;
    line-height: 1;
    margin-bottom: 0.5rem;
}

.stat-label {
    color: var(--text-muted);
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.stat-success { color: var(--accent-success); }
.stat-error { color: var(--accent-error); }
.stat-warning { color: var(--accent-warning); }
.stat-info { color: var(--accent-info); }

/* Progress Bars */
.progress-bar {
    background: var(--bg-tertiary);
    height: 8px;
    border-radius: 4px;
    overflow: hidden;
    margin: 0.5rem 0;
}

.progress-fill {
    height: 100%;
    border-radius: 4px;
    transition: width 0.5s ease;
}

.progress-success { background: var(--accent-success); }
.progress-error { background: var(--accent-error); }

/* Tables */
.table {
    width: 100%;
    border-collapse: collapse;
    margin: 1rem 0;
}

.table th,
.table td {
    padding: 0.75rem 1rem;
    text-align: left;
    border-bottom: 1px solid var(--border-color);
    vertical-align: top;
}

.table th {
    background: var(--bg-tertiary);
    font-weight: bold;
    position: sticky;
    top: 0;
    z-index: 10;
}

.table tr:hover {
    background: var(--bg-tertiary);
}

/* Status Badges */
.status-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.25rem 0.75rem;
    border-radius: 12px;
    font-size: 0.8rem;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.status-passed {
    background: var(--accent-success);
    color: var(--bg-primary);
}

.status-failed {
    background: var(--accent-error);
    color: var(--bg-primary);
}

.status-error {
    background: var(--accent-warning);
    color: var(--bg-primary);
}

.status-running {
    background: var(--accent-info);
    color: var(--bg-primary);
    animation: pulse 2s infinite;
}

/* Collapsible Sections */
.collapsible {
    cursor: pointer;
    user-select: none;
}

.collapsible-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem 1.5rem;
    background: var(--bg-tertiary);
    border-bottom: 1px solid var(--border-color);
}

.collapsible-content {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease;
}

.collapsible.expanded .collapsible-content {
    max-height: 1000px;
}

.collapse-icon {
    transition: transform 0.3s ease;
    font-family: monospace;
    font-size: 1.2rem;
}

.collapsible.expanded .collapse-icon {
    transform: rotate(90deg);
}

/* Code and Logs */
.code-block {
    background: var(--bg-primary);
    border: 1px solid var(--border-color);
    padding: 1rem;
    border-radius: 4px;
    overflow-x: auto;
    font-family: inherit;
    white-space: pre-wrap;
    max-height: 300px;
    overflow-y: auto;
}

.log-entry {
    padding: 0.25rem 0;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    font-family: inherit;
}

.log-timestamp {
    color: var(--text-muted);
    margin-right: 0.5rem;
}

/* Performance Charts */
.chart-container {
    height: 300px;
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    padding: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-muted);
}

/* Interactive Elements */
.btn {
    background: var(--accent-primary);
    color: var(--bg-primary);
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 4px;
    cursor: pointer;
    font-family: inherit;
    font-weight: bold;
    transition: all 0.2s ease;
}

.btn:hover {
    background: var(--accent-secondary);
    transform: translateY(-1px);
}

.btn-secondary {
    background: var(--bg-tertiary);
    color: var(--text-primary);
}

.btn-small {
    padding: 0.25rem 0.5rem;
    font-size: 0.8rem;
}

/* Filters and Controls */
.controls {
    display: flex;
    gap: 1rem;
    margin: 1rem 0;
    flex-wrap: wrap;
    align-items: center;
}

.filter-group {
    display: flex;
    gap: 0.5rem;
    align-items: center;
}

.filter-label {
    color: var(--text-muted);
    font-size: 0.9rem;
}

select, input[type="text"] {
    background: var(--bg-secondary);
    color: var(--text-primary);
    border: 1px solid var(--border-color);
    padding: 0.5rem;
    border-radius: 4px;
    font-family: inherit;
}

/* Animations */
@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}

@keyframes slideIn {
    from { transform: translateY(-10px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
}

.slide-in {
    animation: slideIn 0.3s ease-out;
}

/* Responsive Design */
@media (max-width: 768px) {
    .terminal-header,
    .status-line,
    .terminal-body {
        padding: 1rem;
    }

    .summary-stats {
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    }

    .controls {
        flex-direction: column;
        align-items: stretch;
    }

    .table {
        font-size: 0.8rem;
    }

    .table th,
    .table td {
        padding: 0.5rem;
    }
}

/* Print Styles */
@media print {
    body {
        background: white !important;
        color: black !important;
        font-size: 12pt;
    }

    .terminal-window {
        background: white !important;
    }

    .card,
    .stat-card {
        border: 1px solid #ccc !important;
        background: white !important;
    }

    .btn,
    .controls {
        display: none !important;
    }

    .collapsible-content {
        max-height: none !important;
    }
}

/* Accessibility */
@media (prefers-reduced-motion: reduce) {
    * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
}

.sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}
</style>
</head>
<body class="theme-solarized-dark">
    <div class="terminal-window">
        <div class="terminal-header">
    <div class="terminal-title">
        Security Test Report - Solarized-Dark Theme
        <span style="color: var(--text-muted); font-size: 0.8em;">v1.0</span>
    </div>
    <div class="terminal-meta">
        <div>Suite: MCPyPI Security Test Suite</div>
        <div>Started: 2025-09-19 23:22:09</div>
        <div>Duration: 45.00s</div>
    </div>
</div>

        <div class="terminal-body">
            <div class="status-line">
    <div class="status-indicator">
        <span>NORMAL</span>
        <span>|</span>
        <span>MCPyPI Security Test Suite.py</span>
        <span>|</span>
        <span>8L, 6P</span>
    </div>
    <div class="status-indicator">
        <span>Success Rate: 75.0%</span>
        <span>|</span>
        <span>Tests: 8</span>
    </div>
</div>
            <div class="card">
    <div class="card-header">
        <span>📊 Test Summary Dashboard</span>
        <div class="controls">
            <button class="btn btn-small" onclick="toggleAutoRefresh()">Auto Refresh: OFF</button>
            <button class="btn btn-small" onclick="exportResults()">Export JSON</button>
        </div>
    </div>
    <div class="card-body">
        <div class="summary-stats">
            <div class="stat-card">
                <div class="stat-value stat-info">8</div>
                <div class="stat-label">Total Tests</div>
                <div class="progress-bar">
                    <div class="progress-fill progress-success" style="width: 100%"></div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-value stat-success">6</div>
                <div class="stat-label">Passed</div>
                <div class="progress-bar">
                    <div class="progress-fill progress-success" style="width: 75.0%"></div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-value stat-error">1</div>
                <div class="stat-label">Failed</div>
                <div class="progress-bar">
                    <div class="progress-fill progress-error" style="width: 12.5%"></div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-value stat-warning">1</div>
                <div class="stat-label">Errors</div>
                <div class="progress-bar">
                    <div class="progress-fill progress-error" style="width: 12.5%"></div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-value stat-info">75.0%</div>
                <div class="stat-label">Success Rate</div>
                <div class="progress-bar">
                    <div class="progress-fill progress-success" style="width: 75.0%"></div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-value stat-info">45.00s</div>
                <div class="stat-label">Duration</div>
            </div>
        </div>
    </div>
</div>
            <div class="card collapsible" data-category="input_validation">
    <div class="collapsible-header">
        <div>
            <span>🧪 Input Validation</span>
            <span style="color: var(--text-muted); margin-left: 1rem;">
                2 tests | 2 passed | 0 failed | 0 errors
            </span>
        </div>
        <span class="collapse-icon">▶</span>
    </div>
    <div class="collapsible-content">
        <div class="card-body">
            <table class="table">
                <thead>
                    <tr>
                        <th>Test Name</th>
                        <th>Status</th>
                        <th>Duration</th>
                        <th>Assertions</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody><tr class="test-row" data-test="test_input_validation_attacks">
                        <td>test_input_validation_attacks</td>
                        <td><span class="status-badge status-passed">passed</span></td>
                        <td>2.340s</td>
                        <td>15/15</td>
                        <td>
                            <button class="btn btn-small" onclick="showTestDetails('test_input_validation_attacks')">Details</button>
                        </td>
                    </tr><tr class="test-row" data-test="test_malicious_package_names">
                        <td>test_malicious_package_names</td>
                        <td><span class="status-badge status-passed">passed</span></td>
                        <td>0.780s</td>
                        <td>27/27</td>
                        <td>
                            <button class="btn btn-small" onclick="showTestDetails('test_malicious_package_names')">Details</button>
                        </td>
                    </tr></tbody>
            </table>
        </div>
    </div>
</div>
<div class="card collapsible" data-category="security">
    <div class="collapsible-header">
        <div>
            <span>🧪 Security</span>
            <span style="color: var(--text-muted); margin-left: 1rem;">
                2 tests | 1 passed | 1 failed | 0 errors
            </span>
        </div>
        <span class="collapse-icon">▶</span>
    </div>
    <div class="collapsible-content">
        <div class="card-body">
            <table class="table">
                <thead>
                    <tr>
                        <th>Test Name</th>
                        <th>Status</th>
                        <th>Duration</th>
                        <th>Assertions</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody><tr class="test-row" data-test="test_log_sanitization_comprehensive">
                        <td>test_log_sanitization_comprehensive</td>
                        <td><span class="status-badge status-passed">passed</span></td>
                        <td>1.870s</td>
                        <td>18/18</td>
                        <td>
                            <button class="btn btn-small" onclick="showTestDetails('test_log_sanitization_comprehensive')">Details</button>
                        </td>
                    </tr><tr class="test-row" data-test="test_path_traversal_protection">
                        <td>test_path_traversal_protection</td>
                        <td><span class="status-badge status-failed">failed</span></td>
                        <td>0.950s</td>
                        <td>19/21</td>
                        <td>
                            <button class="btn btn-small" onclick="showTestDetails('test_path_traversal_protection')">Details</button>
                        </td>
                    </tr></tbody>
            </table>
        </div>
    </div>
</div>
<div class="card collapsible" data-category="rate_limiting">
    <div class="collapsible-header">
        <div>
            <span>🧪 Rate Limiting</span>
            <span style="color: var(--text-muted); margin-left: 1rem;">
                1 tests | 1 passed | 0 failed | 0 errors
            </span>
        </div>
        <span class="collapse-icon">▶</span>
    </div>
    <div class="collapsible-content">
        <div class="card-body">
            <table class="table">
                <thead>
                    <tr>
                        <th>Test Name</th>
                        <th>Status</th>
                        <th>Duration</th>
                        <th>Assertions</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody><tr class="test-row" data-test="test_rate_limiting_functionality">
                        <td>test_rate_limiting_functionality</td>
                        <td><span class="status-badge status-passed">passed</span></td>
                        <td>3.210s</td>
                        <td>24/24</td>
                        <td>
                            <button class="btn btn-small" onclick="showTestDetails('test_rate_limiting_functionality')">Details</button>
                        </td>
                    </tr></tbody>
            </table>
        </div>
    </div>
</div>
<div class="card collapsible" data-category="performance">
    <div class="collapsible-header">
        <div>
            <span>🧪 Performance</span>
            <span style="color: var(--text-muted); margin-left: 1rem;">
                1 tests | 1 passed | 0 failed | 0 errors
            </span>
        </div>
        <span class="collapse-icon">▶</span>
    </div>
    <div class="collapsible-content">
        <div class="card-body">
            <table class="table">
                <thead>
                    <tr>
                        <th>Test Name</th>
                        <th>Status</th>
                        <th>Duration</th>
                        <th>Assertions</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody><tr class="test-row" data-test="test_performance_under_load">
                        <td>test_performance_under_load</td>
                        <td><span class="status-badge status-passed">passed</span></td>
                        <td>5.670s</td>
                        <td>30/30</td>
                        <td>
                            <button class="btn btn-small" onclick="showTestDetails('test_performance_under_load')">Details</button>
                        </td>
                    </tr></tbody>
            </table>
        </div>
    </div>
</div>
<div class="card collapsible" data-category="integration">
    <div class="collapsible-header">
        <div>
            <span>🧪 Integration</span>
            <span style="color: var(--text-muted); margin-left: 1rem;">
                1 tests | 0 passed | 0 failed | 1 errors
            </span>
        </div>
        <span class="collapse-icon">▶</span>
    </div>
    <div class="collapsible-content">
        <div class="card-body">
            <table class="table">
                <thead>
                    <tr>
                        <th>Test Name</th>
                        <th>Status</th>
                        <th>Duration</th>
                        <th>Assertions</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody><tr class="test-row" data-test="test_concurrent_rate_limiting">
                        <td>test_concurrent_rate_limiting</td>
                        <td><span class="status-badge status-error">error</span></td>
                        <td>2.100s</td>
                        <td>31/33</td>
                        <td>
                            <button class="btn btn-small" onclick="showTestDetails('test_concurrent_rate_limiting')">Details</button>
                        </td>
                    </tr></tbody>
            </table>
        </div>
    </div>
</div>
<div class="card collapsible" data-category="edge_cases">
    <div class="collapsible-header">
        <div>
            <span>🧪 Edge Cases</span>
            <span style="color: var(--text-muted); margin-left: 1rem;">
                1 tests | 1 passed | 0 failed | 0 errors
            </span>
        </div>
        <span class="collapse-icon">▶</span>
    </div>
    <div class="collapsible-content">
        <div class="card-body">
            <table class="table">
                <thead>
                    <tr>
                        <th>Test Name</th>
                        <th>Status</th>
                        <th>Duration</th>
                        <th>Assertions</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody><tr class="test-row" data-test="test_edge_cases_and_corner_cases">
                        <td>test_edge_cases_and_corner_cases</td>
                        <td><span class="status-badge status-passed">passed</span></td>
                        <td>1.450s</td>
                        <td>36/36</td>
                        <td>
                            <button class="btn btn-small" onclick="showTestDetails('test_edge_cases_and_corner_cases')">Details</button>
                        </td>
                    </tr></tbody>
            </table>
        </div>
    </div>
</div>
            <div class="card">
    <div class="card-header">
        <span>🔍 Detailed Test Results</span>
        <div class="controls">
            <div class="filter-group">
                <span class="filter-label">Filter:</span>
                <select id="statusFilter" onchange="filterTests()">
                    <option value="">All Status</option>
                    <option value="passed">Passed</option>
                    <option value="failed">Failed</option>
                    <option value="error">Error</option>
                </select>
            </div>
            <div class="filter-group">
                <span class="filter-label">Search:</span>
                <input type="text" id="searchFilter" placeholder="Search tests..." oninput="filterTests()">
            </div>
        </div>
    </div>
    <div class="card-body">
        <div id="detailed-tests">
            <div class="card test-detail" data-test="test_input_validation_attacks" data-status="passed" data-category="input_validation">
                <div class="card-header">
                    <div>
                        <span>test_input_validation_attacks</span>
                        <span class="status-badge status-passed" style="margin-left: 1rem;">passed</span>
                    </div>
                    <div style="color: var(--text-muted);">
                        Category: input_validation | Duration: 2.340s
                    </div>
                </div>
                <div class="card-body">
                    
                    <div class="collapsible">
                    <div class="collapsible-header">
                        <span>📝 Logs (4 entries)</span>
                        <span class="collapse-icon">▶</span>
                    </div>
                    <div class="collapsible-content">
                        <div class="code-block">
<div class="log-entry">[12:34:56.123] INFO: Testing input validation against attack vectors...</div><div class="log-entry">[12:34:56.150] DEBUG: ✓ Correctly rejected: ../../../etc/passwd</div><div class="log-entry">[12:34:56.175] DEBUG: ✓ Correctly rejected: <script>alert('xss')</script></div><div class="log-entry">[12:34:58.456] INFO: ✅ Input validation successfully blocked all attack vectors</div>
                        </div>
                    </div>
                </div>
                    <div class="collapsible">
                    <div class="collapsible-header">
                        <span>📈 Performance Metrics</span>
                        <span class="collapse-icon">▶</span>
                    </div>
                    <div class="collapsible-content">
                        <table class="table"><thead><tr><th>Metric</th><th>Value</th><th>Unit</th><th>Status</th></tr></thead><tbody><tr>
                        <td>validation_calls</td>
                        <td>25</td>
                        <td>count</td>
                        <td style="color: var(--accent-success);">ok</td>
                    </tr><tr>
                        <td>avg_response_time</td>
                        <td>0.045</td>
                        <td>ms</td>
                        <td style="color: var(--accent-success);">ok</td>
                    </tr></tbody></table>
                    </div>
                </div>
                </div>
            </div>
<div class="card test-detail" data-test="test_log_sanitization_comprehensive" data-status="passed" data-category="security">
                <div class="card-header">
                    <div>
                        <span>test_log_sanitization_comprehensive</span>
                        <span class="status-badge status-passed" style="margin-left: 1rem;">passed</span>
                    </div>
                    <div style="color: var(--text-muted);">
                        Category: security | Duration: 1.870s
                    </div>
                </div>
                <div class="card-body">
                    
                    <div class="collapsible">
                    <div class="collapsible-header">
                        <span>📝 Logs (4 entries)</span>
                        <span class="collapse-icon">▶</span>
                    </div>
                    <div class="collapsible-content">
                        <div class="code-block">
<div class="log-entry">[12:34:58.500] INFO: Testing comprehensive log sanitization...</div><div class="log-entry">[12:34:58.520] DEBUG: ✓ Sanitized: token=pypi-secret → token=***REDACTED***</div><div class="log-entry">[12:34:58.540] DEBUG: ✓ Sanitized: user@example.com → ***REDACTED_EMAIL***</div><div class="log-entry">[12:35:00.370] INFO: ✅ Log sanitization working correctly for all patterns</div>
                        </div>
                    </div>
                </div>
                    <div class="collapsible">
                    <div class="collapsible-header">
                        <span>📈 Performance Metrics</span>
                        <span class="collapse-icon">▶</span>
                    </div>
                    <div class="collapsible-content">
                        <table class="table"><thead><tr><th>Metric</th><th>Value</th><th>Unit</th><th>Status</th></tr></thead><tbody><tr>
                        <td>sanitization_speed</td>
                        <td>1200</td>
                        <td>ops/sec</td>
                        <td style="color: var(--accent-success);">ok</td>
                    </tr></tbody></table>
                    </div>
                </div>
                </div>
            </div>
<div class="card test-detail" data-test="test_path_traversal_protection" data-status="failed" data-category="security">
                <div class="card-header">
                    <div>
                        <span>test_path_traversal_protection</span>
                        <span class="status-badge status-failed" style="margin-left: 1rem;">failed</span>
                    </div>
                    <div style="color: var(--text-muted);">
                        Category: security | Duration: 0.950s
                    </div>
                </div>
                <div class="card-body">
                    <div class="collapsible">
                    <div class="collapsible-header" style="background: var(--accent-error); color: var(--bg-primary);">
                        <span>❌ Error Details</span>
                        <span class="collapse-icon">▶</span>
                    </div>
                    <div class="collapsible-content">
                        <div class="code-block" style="background: rgba(251, 73, 52, 0.1);">
                            <strong>Message:</strong> Path traversal attack not properly blocked: ....//....//....//etc/passwd
                            
                        </div>
                    </div>
                </div>
                    <div class="collapsible">
                    <div class="collapsible-header">
                        <span>📝 Logs (4 entries)</span>
                        <span class="collapse-icon">▶</span>
                    </div>
                    <div class="collapsible-content">
                        <div class="code-block">
<div class="log-entry">[12:35:00.400] INFO: Testing path traversal protection...</div><div class="log-entry">[12:35:00.450] DEBUG: ✓ Correctly rejected: ../../../etc/passwd</div><div class="log-entry">[12:35:00.475] DEBUG: ✓ Correctly rejected: /etc/passwd</div><div class="log-entry">[12:35:01.350] ERROR: ❌ test_path_traversal_protection FAILED: Path traversal attack not properly blocked</div>
                        </div>
                    </div>
                </div>
                    
                </div>
            </div>
<div class="card test-detail" data-test="test_rate_limiting_functionality" data-status="passed" data-category="rate_limiting">
                <div class="card-header">
                    <div>
                        <span>test_rate_limiting_functionality</span>
                        <span class="status-badge status-passed" style="margin-left: 1rem;">passed</span>
                    </div>
                    <div style="color: var(--text-muted);">
                        Category: rate_limiting | Duration: 3.210s
                    </div>
                </div>
                <div class="card-body">
                    
                    <div class="collapsible">
                    <div class="collapsible-header">
                        <span>📝 Logs (4 entries)</span>
                        <span class="collapse-icon">▶</span>
                    </div>
                    <div class="collapsible-content">
                        <div class="code-block">
<div class="log-entry">[12:35:01.400] INFO: Testing rate limiting functionality...</div><div class="log-entry">[12:35:01.450] INFO: Testing token bucket refill mechanism...</div><div class="log-entry">[12:35:02.500] INFO: ✓ Token bucket rate limiting working correctly</div><div class="log-entry">[12:35:04.610] INFO: ✅ Rate limiting tests completed successfully</div>
                        </div>
                    </div>
                </div>
                    <div class="collapsible">
                    <div class="collapsible-header">
                        <span>📈 Performance Metrics</span>
                        <span class="collapse-icon">▶</span>
                    </div>
                    <div class="collapsible-content">
                        <table class="table"><thead><tr><th>Metric</th><th>Value</th><th>Unit</th><th>Status</th></tr></thead><tbody><tr>
                        <td>token_bucket_capacity</td>
                        <td>5</td>
                        <td>tokens</td>
                        <td style="color: var(--accent-success);">ok</td>
                    </tr><tr>
                        <td>refill_rate</td>
                        <td>2.0</td>
                        <td>tokens/sec</td>
                        <td style="color: var(--accent-success);">ok</td>
                    </tr><tr>
                        <td>rate_limit_effectiveness</td>
                        <td>98.5</td>
                        <td>%</td>
                        <td style="color: var(--accent-success);">ok</td>
                    </tr></tbody></table>
                    </div>
                </div>
                </div>
            </div>
<div class="card test-detail" data-test="test_malicious_package_names" data-status="passed" data-category="input_validation">
                <div class="card-header">
                    <div>
                        <span>test_malicious_package_names</span>
                        <span class="status-badge status-passed" style="margin-left: 1rem;">passed</span>
                    </div>
                    <div style="color: var(--text-muted);">
                        Category: input_validation | Duration: 0.780s
                    </div>
                </div>
                <div class="card-body">
                    
                    <div class="collapsible">
                    <div class="collapsible-header">
                        <span>📝 Logs (4 entries)</span>
                        <span class="collapse-icon">▶</span>
                    </div>
                    <div class="collapsible-content">
                        <div class="code-block">
<div class="log-entry">[12:35:04.650] INFO: Testing advanced malicious package name detection...</div><div class="log-entry">[12:35:04.680] DEBUG: ✓ Correctly rejected Unicode attack: 'package\u0000hidden'</div><div class="log-entry">[12:35:04.705] DEBUG: ✓ Correctly accepted: requests</div><div class="log-entry">[12:35:05.430] INFO: ✅ Advanced package name validation working correctly</div>
                        </div>
                    </div>
                </div>
                    
                </div>
            </div>
<div class="card test-detail" data-test="test_performance_under_load" data-status="passed" data-category="performance">
                <div class="card-header">
                    <div>
                        <span>test_performance_under_load</span>
                        <span class="status-badge status-passed" style="margin-left: 1rem;">passed</span>
                    </div>
                    <div style="color: var(--text-muted);">
                        Category: performance | Duration: 5.670s
                    </div>
                </div>
                <div class="card-body">
                    
                    <div class="collapsible">
                    <div class="collapsible-header">
                        <span>📝 Logs (4 entries)</span>
                        <span class="collapse-icon">▶</span>
                    </div>
                    <div class="collapsible-content">
                        <div class="code-block">
<div class="log-entry">[12:35:05.470] INFO: Testing performance under load...</div><div class="log-entry">[12:35:08.123] INFO: ✓ Log sanitization performance good: 0.456s for 1000 ops</div><div class="log-entry">[12:35:10.789] INFO: ✓ Input validation performance good: 1.234s for 1000 ops</div><div class="log-entry">[12:35:11.140] INFO: ✅ Performance testing completed</div>
                        </div>
                    </div>
                </div>
                    <div class="collapsible">
                    <div class="collapsible-header">
                        <span>📈 Performance Metrics</span>
                        <span class="collapse-icon">▶</span>
                    </div>
                    <div class="collapsible-content">
                        <table class="table"><thead><tr><th>Metric</th><th>Value</th><th>Unit</th><th>Status</th></tr></thead><tbody><tr>
                        <td>log_sanitization_throughput</td>
                        <td>2193</td>
                        <td>ops/sec</td>
                        <td style="color: var(--accent-success);">ok</td>
                    </tr><tr>
                        <td>input_validation_throughput</td>
                        <td>810</td>
                        <td>ops/sec</td>
                        <td style="color: var(--accent-success);">ok</td>
                    </tr><tr>
                        <td>memory_usage_peak</td>
                        <td>45.7</td>
                        <td>MB</td>
                        <td style="color: var(--accent-success);">ok</td>
                    </tr><tr>
                        <td>cpu_usage_avg</td>
                        <td>23.4</td>
                        <td>%</td>
                        <td style="color: var(--accent-success);">ok</td>
                    </tr></tbody></table>
                    </div>
                </div>
                </div>
            </div>
<div class="card test-detail" data-test="test_concurrent_rate_limiting" data-status="error" data-category="integration">
                <div class="card-header">
                    <div>
                        <span>test_concurrent_rate_limiting</span>
                        <span class="status-badge status-error" style="margin-left: 1rem;">error</span>
                    </div>
                    <div style="color: var(--text-muted);">
                        Category: integration | Duration: 2.100s
                    </div>
                </div>
                <div class="card-body">
                    <div class="collapsible">
                    <div class="collapsible-header" style="background: var(--accent-error); color: var(--bg-primary);">
                        <span>❌ Error Details</span>
                        <span class="collapse-icon">▶</span>
                    </div>
                    <div class="collapsible-content">
                        <div class="code-block" style="background: rgba(251, 73, 52, 0.1);">
                            <strong>Message:</strong> ConnectionError: Failed to establish mock HTTP connection
                            <br><br><strong>Traceback:</strong><br>Traceback (most recent call last):
  File "test_security_comprehensive.py", line 489, mock_client.request.side_effect = ConnectionError("Mock connection failed")
  ConnectionError: Failed to establish mock HTTP connection
                        </div>
                    </div>
                </div>
                    <div class="collapsible">
                    <div class="collapsible-header">
                        <span>📝 Logs (3 entries)</span>
                        <span class="collapse-icon">▶</span>
                    </div>
                    <div class="collapsible-content">
                        <div class="code-block">
<div class="log-entry">[12:35:11.180] INFO: Testing concurrent rate limiting...</div><div class="log-entry">[12:35:12.890] ERROR: Mock HTTP client setup failed</div><div class="log-entry">[12:35:13.280] ERROR: ❌ test_concurrent_rate_limiting ERROR: ConnectionError</div>
                        </div>
                    </div>
                </div>
                    
                </div>
            </div>
<div class="card test-detail" data-test="test_edge_cases_and_corner_cases" data-status="passed" data-category="edge_cases">
                <div class="card-header">
                    <div>
                        <span>test_edge_cases_and_corner_cases</span>
                        <span class="status-badge status-passed" style="margin-left: 1rem;">passed</span>
                    </div>
                    <div style="color: var(--text-muted);">
                        Category: edge_cases | Duration: 1.450s
                    </div>
                </div>
                <div class="card-body">
                    
                    <div class="collapsible">
                    <div class="collapsible-header">
                        <span>📝 Logs (4 entries)</span>
                        <span class="collapse-icon">▶</span>
                    </div>
                    <div class="collapsible-content">
                        <div class="code-block">
<div class="log-entry">[12:35:13.320] INFO: Testing edge cases and corner cases...</div><div class="log-entry">[12:35:13.350] DEBUG: ✓ Sanitization handled None input: 4 chars</div><div class="log-entry">[12:35:13.375] DEBUG: ✓ Sanitization handled Unicode emoji: 12 chars</div><div class="log-entry">[12:35:14.770] INFO: ✅ Edge case testing completed</div>
                        </div>
                    </div>
                </div>
                    
                </div>
            </div>
        </div>
    </div>
</div>
            <div class="card">
    <div class="card-header">
        <span>📈 Performance Analysis</span>
    </div>
    <div class="card-body">
        <div class="grid grid-2">
            <div class="chart-container">
                <div>Test Duration Distribution Chart<br><small style="color: var(--text-muted);">(Chart rendering requires JavaScript)</small></div>
            </div>
            <div class="chart-container">
                <div>Performance Metrics Trend<br><small style="color: var(--text-muted);">(Chart rendering requires JavaScript)</small></div>
            </div>
        </div>
    </div>
</div>
            <div class="card">
    <div class="card-header">
        <span>🖥️ Environment Information</span>
    </div>
    <div class="card-body">
        <table class="table">
            <thead>
                <tr>
                    <th>Property</th>
                    <th>Value</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>Python Version</td><td>3.13.7</td></tr><tr><td>Platform</td><td>Linux-6.16.7-arch1-1-x86_64-with-glibc2.42</td></tr><tr><td>Architecture</td><td>64bit</td></tr><tr><td>Processor</td><td>x86_64</td></tr><tr><td>Host</td><td>rpm-bullet</td></tr><tr><td>Generated</td><td>2025-09-19 23:22:54 UTC</td></tr><tr><td>python_version</td><td>3.12.0</td></tr><tr><td>platform</td><td>Linux-6.16.7-arch1-1-x86_64</td></tr><tr><td>hostname</td><td>dev-machine</td></tr><tr><td>working_directory</td><td>/home/rpm/claude/pypi-query-mcp</td></tr>
            </tbody>
        </table>
    </div>
</div>
        </div>
    </div>

    <script type="application/json" id="test-data">
    {
  "suite_name": "MCPyPI Security Test Suite",
  "start_time": 1758345729.8260171,
  "end_time": 1758345774.8260555,
  "duration": 45.000038385391235,
  "tests": [
    {
      "name": "test_input_validation_attacks",
      "category": "input_validation",
      "status": "passed",
      "start_time": 1758345729.8260171,
      "end_time": 1758345732.166017,
      "duration": 2.34,
      "error_message": null,
      "error_traceback": null,
      "output_logs": [
        "[12:34:56.123] INFO: Testing input validation against attack vectors...",
        "[12:34:56.150] DEBUG: \u2713 Correctly rejected: ../../../etc/passwd",
        "[12:34:56.175] DEBUG: \u2713 Correctly rejected: <script>alert('xss')</script>",
        "[12:34:58.456] INFO: \u2705 Input validation successfully blocked all attack vectors"
      ],
      "performance_metrics": [
        {
          "name": "validation_calls",
          "value": 25,
          "unit": "count",
          "description": "Number of validation calls",
          "threshold": null,
          "status": "ok"
        },
        {
          "name": "avg_response_time",
          "value": 0.045,
          "unit": "ms",
          "description": "Average validation response time",
          "threshold": null,
          "status": "ok"
        }
      ],
      "assertions_passed": 15,
      "assertions_total": 15,
      "metadata": {}
    },
    {
      "name": "test_log_sanitization_comprehensive",
      "category": "security",
      "status": "passed",
      "start_time": 1758345732.8260171,
      "end_time": 1758345734.696017,
      "duration": 1.87,
      "error_message": null,
      "error_traceback": null,
      "output_logs": [
        "[12:34:58.500] INFO: Testing comprehensive log sanitization...",
        "[12:34:58.520] DEBUG: \u2713 Sanitized: token=pypi-secret \u2192 token=***REDACTED***",
        "[12:34:58.540] DEBUG: \u2713 Sanitized: user@example.com \u2192 ***REDACTED_EMAIL***",
        "[12:35:00.370] INFO: \u2705 Log sanitization working correctly for all patterns"
      ],
      "performance_metrics": [
        {
          "name": "sanitization_speed",
          "value": 1200,
          "unit": "ops/sec",
          "description": "Sanitization operations per second",
          "threshold": null,
          "status": "ok"
        }
      ],
      "assertions_passed": 18,
      "assertions_total": 18,
      "metadata": {}
    },
    {
      "name": "test_path_traversal_protection",
      "category": "security",
      "status": "failed",
      "start_time": 1758345735.8260171,
      "end_time": 1758345736.7760172,
      "duration": 0.95,
      "error_message": "Path traversal attack not properly blocked: ....//....//....//etc/passwd",
      "error_traceback": null,
      "output_logs": [
        "[12:35:00.400] INFO: Testing path traversal protection...",
        "[12:35:00.450] DEBUG: \u2713 Correctly rejected: ../../../etc/passwd",
        "[12:35:00.475] DEBUG: \u2713 Correctly rejected: /etc/passwd",
        "[12:35:01.350] ERROR: \u274c test_path_traversal_protection FAILED: Path traversal attack not properly blocked"
      ],
      "performance_metrics": [],
      "assertions_passed": 19,
      "assertions_total": 21,
      "metadata": {}
    },
    {
      "name": "test_rate_limiting_functionality",
      "category": "rate_limiting",
      "status": "passed",
      "start_time": 1758345738.8260171,
      "end_time": 1758345742.0360172,
      "duration": 3.21,
      "error_message": null,
      "error_traceback": null,
      "output_logs": [
        "[12:35:01.400] INFO: Testing rate limiting functionality...",
        "[12:35:01.450] INFO: Testing token bucket refill mechanism...",
        "[12:35:02.500] INFO: \u2713 Token bucket rate limiting working correctly",
        "[12:35:04.610] INFO: \u2705 Rate limiting tests completed successfully"
      ],
      "performance_metrics": [
        {
          "name": "token_bucket_capacity",
          "value": 5,
          "unit": "tokens",
          "description": "Token bucket capacity",
          "threshold": null,
          "status": "ok"
        },
        {
          "name": "refill_rate",
          "value": 2.0,
          "unit": "tokens/sec",
          "description": "Token refill rate",
          "threshold": null,
          "status": "ok"
        },
        {
          "name": "rate_limit_effectiveness",
          "value": 98.5,
          "unit": "%",
          "description": "Rate limiting effectiveness",
          "threshold": null,
          "status": "ok"
        }
      ],
      "assertions_passed": 24,
      "assertions_total": 24,
      "metadata": {}
    },
    {
      "name": "test_malicious_package_names",
      "category": "input_validation",
      "status": "passed",
      "start_time": 1758345741.8260171,
      "end_time": 1758345742.606017,
      "duration": 0.78,
      "error_message": null,
      "error_traceback": null,
      "output_logs": [
        "[12:35:04.650] INFO: Testing advanced malicious package name detection...",
        "[12:35:04.680] DEBUG: \u2713 Correctly rejected Unicode attack: 'package\\u0000hidden'",
        "[12:35:04.705] DEBUG: \u2713 Correctly accepted: requests",
        "[12:35:05.430] INFO: \u2705 Advanced package name validation working correctly"
      ],
      "performance_metrics": [],
      "assertions_passed": 27,
      "assertions_total": 27,
      "metadata": {}
    },
    {
      "name": "test_performance_under_load",
      "category": "performance",
      "status": "passed",
      "start_time": 1758345744.8260171,
      "end_time": 1758345750.4960172,
      "duration": 5.67,
      "error_message": null,
      "error_traceback": null,
      "output_logs": [
        "[12:35:05.470] INFO: Testing performance under load...",
        "[12:35:08.123] INFO: \u2713 Log sanitization performance good: 0.456s for 1000 ops",
        "[12:35:10.789] INFO: \u2713 Input validation performance good: 1.234s for 1000 ops",
        "[12:35:11.140] INFO: \u2705 Performance testing completed"
      ],
      "performance_metrics": [
        {
          "name": "log_sanitization_throughput",
          "value": 2193,
          "unit": "ops/sec",
          "description": "Log sanitization throughput",
          "threshold": null,
          "status": "ok"
        },
        {
          "name": "input_validation_throughput",
          "value": 810,
          "unit": "ops/sec",
          "description": "Input validation throughput",
          "threshold": null,
          "status": "ok"
        },
        {
          "name": "memory_usage_peak",
          "value": 45.7,
          "unit": "MB",
          "description": "Peak memory usage during load test",
          "threshold": null,
          "status": "ok"
        },
        {
          "name": "cpu_usage_avg",
          "value": 23.4,
          "unit": "%",
          "description": "Average CPU usage during test",
          "threshold": null,
          "status": "ok"
        }
      ],
      "assertions_passed": 30,
      "assertions_total": 30,
      "metadata": {}
    },
    {
      "name": "test_concurrent_rate_limiting",
      "category": "integration",
      "status": "error",
      "start_time": 1758345747.8260171,
      "end_time": 1758345749.926017,
      "duration": 2.1,
      "error_message": "ConnectionError: Failed to establish mock HTTP connection",
      "error_traceback": "Traceback (most recent call last):\n  File \"test_security_comprehensive.py\", line 489, mock_client.request.side_effect = ConnectionError(\"Mock connection failed\")\n  ConnectionError: Failed to establish mock HTTP connection",
      "output_logs": [
        "[12:35:11.180] INFO: Testing concurrent rate limiting...",
        "[12:35:12.890] ERROR: Mock HTTP client setup failed",
        "[12:35:13.280] ERROR: \u274c test_concurrent_rate_limiting ERROR: ConnectionError"
      ],
      "performance_metrics": [],
      "assertions_passed": 31,
      "assertions_total": 33,
      "metadata": {}
    },
    {
      "name": "test_edge_cases_and_corner_cases",
      "category": "edge_cases",
      "status": "passed",
      "start_time": 1758345750.8260171,
      "end_time": 1758345752.2760172,
      "duration": 1.45,
      "error_message": null,
      "error_traceback": null,
      "output_logs": [
        "[12:35:13.320] INFO: Testing edge cases and corner cases...",
        "[12:35:13.350] DEBUG: \u2713 Sanitization handled None input: 4 chars",
        "[12:35:13.375] DEBUG: \u2713 Sanitization handled Unicode emoji: 12 chars",
        "[12:35:14.770] INFO: \u2705 Edge case testing completed"
      ],
      "performance_metrics": [],
      "assertions_passed": 36,
      "assertions_total": 36,
      "metadata": {}
    }
  ],
  "global_performance_metrics": [
    {
      "name": "total_execution_time",
      "value": 45.000038385391235,
      "unit": "seconds",
      "description": "Total test suite execution time",
      "threshold": null,
      "status": "ok"
    },
    {
      "name": "tests_per_second",
      "value": 0.17777762613191705,
      "unit": "tests/sec",
      "description": "Test execution rate",
      "threshold": null,
      "status": "ok"
    },
    {
      "name": "memory_efficiency",
      "value": 92.3,
      "unit": "%",
      "description": "Memory efficiency score",
      "threshold": null,
      "status": "ok"
    },
    {
      "name": "security_coverage",
      "value": 87.5,
      "unit": "%",
      "description": "Security test coverage",
      "threshold": null,
      "status": "warning"
    }
  ],
  "environment_info": {
    "python_version": "3.12.0",
    "platform": "Linux-6.16.7-arch1-1-x86_64",
    "hostname": "dev-machine",
    "working_directory": "/home/rpm/claude/pypi-query-mcp"
  },
  "configuration": {
    "theme": "gruvbox-dark",
    "auto_refresh": false,
    "performance_monitoring": true
  },
  "summary": {
    "total_tests": 8,
    "passed_tests": 6,
    "failed_tests": 1,
    "error_tests": 1,
    "skipped_tests": 0,
    "success_rate": 75.0
  }
}
    </script>

    <script>
// Enhanced Test Report JavaScript with Modern Features
(function() {
    'use strict';

    // Global state
    let autoRefreshEnabled = false;
    let autoRefreshInterval = null;
    let testData = null;

    // Initialize when DOM is ready
    document.addEventListener('DOMContentLoaded', function() {
        initializeReport();
        loadTestData();
        setupEventListeners();
        setupCollapsibleSections();
        setupKeyboardShortcuts();
        detectFileProtocol();
    });

    function initializeReport() {
        console.log('🚀 Initializing Security Test Report');

        // Add loading animation for charts
        const chartContainers = document.querySelectorAll('.chart-container');
        chartContainers.forEach(container => {
            container.innerHTML = '<div style="text-align: center;"><div style="animation: pulse 2s infinite;">📊 Loading Chart...</div></div>';
        });

        // Animate test rows on load
        const testRows = document.querySelectorAll('.test-detail');
        testRows.forEach((row, index) => {
            setTimeout(() => {
                row.classList.add('slide-in');
            }, index * 50);
        });
    }

    function loadTestData() {
        const dataElement = document.getElementById('test-data');
        if (dataElement) {
            try {
                testData = JSON.parse(dataElement.textContent);
                console.log('✅ Test data loaded:', testData.summary);
                renderCharts();
            } catch (e) {
                console.error('❌ Failed to parse test data:', e);
            }
        }
    }

    function setupEventListeners() {
        // Filter functionality
        const statusFilter = document.getElementById('statusFilter');
        const searchFilter = document.getElementById('searchFilter');

        if (statusFilter) statusFilter.addEventListener('change', filterTests);
        if (searchFilter) searchFilter.addEventListener('input', filterTests);

        // Copy functionality for code blocks
        document.querySelectorAll('.code-block').forEach(block => {
            block.addEventListener('dblclick', function() {
                copyToClipboard(block.textContent);
                showToast('Copied to clipboard!', 'success');
            });

            // Add copy hint
            block.title = 'Double-click to copy';
            block.style.cursor = 'copy';
        });
    }

    function setupCollapsibleSections() {
        document.querySelectorAll('.collapsible').forEach(element => {
            const header = element.querySelector('.collapsible-header');
            const content = element.querySelector('.collapsible-content');
            const icon = element.querySelector('.collapse-icon');

            if (header && content && icon) {
                header.addEventListener('click', function() {
                    const isExpanded = element.classList.contains('expanded');

                    element.classList.toggle('expanded');
                    icon.textContent = isExpanded ? '▶' : '▼';

                    // Smooth height animation
                    if (!isExpanded) {
                        content.style.maxHeight = content.scrollHeight + 'px';
                    } else {
                        content.style.maxHeight = '0px';
                    }
                });

                // Set initial state based on content importance
                if (element.dataset.category ||
                    header.textContent.includes('Error') ||
                    header.textContent.includes('Failed')) {
                    header.click(); // Auto-expand important sections
                }
            }
        });
    }

    function setupKeyboardShortcuts() {
        document.addEventListener('keydown', function(e) {
            // Only trigger if not in input field
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'SELECT') return;

            switch(e.key) {
                case 'e':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        exportResults();
                    }
                    break;
                case 'r':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        toggleAutoRefresh();
                    }
                    break;
                case 'f':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        const searchFilter = document.getElementById('searchFilter');
                        if (searchFilter) searchFilter.focus();
                    }
                    break;
                case 'Escape':
                    // Close any open modals or reset filters
                    resetFilters();
                    break;
            }
        });
    }

    function detectFileProtocol() {
        if (window.location.protocol === 'file:') {
            console.info('📁 File protocol detected - some features may be limited');

            // Disable features that don't work with file://
            const autoRefreshBtn = document.querySelector('[onclick="toggleAutoRefresh()"]');
            if (autoRefreshBtn) {
                autoRefreshBtn.style.opacity = '0.5';
                autoRefreshBtn.title = 'Auto-refresh not available in file:// mode';
            }
        }
    }

    // Global functions for HTML onclick handlers
    window.toggleAutoRefresh = function() {
        if (window.location.protocol === 'file:') {
            showToast('Auto-refresh not available in file:// mode', 'warning');
            return;
        }

        autoRefreshEnabled = !autoRefreshEnabled;
        const btn = document.querySelector('[onclick="toggleAutoRefresh()"]');

        if (autoRefreshEnabled) {
            btn.textContent = 'Auto Refresh: ON';
            autoRefreshInterval = setInterval(() => {
                window.location.reload();
            }, 5000);
            showToast('Auto-refresh enabled', 'success');
        } else {
            btn.textContent = 'Auto Refresh: OFF';
            if (autoRefreshInterval) {
                clearInterval(autoRefreshInterval);
                autoRefreshInterval = null;
            }
            showToast('Auto-refresh disabled', 'info');
        }
    };

    window.exportResults = function() {
        if (!testData) {
            showToast('No test data available for export', 'error');
            return;
        }

        try {
            const jsonData = JSON.stringify(testData, null, 2);
            const blob = new Blob([jsonData], { type: 'application/json' });
            const url = URL.createObjectURL(blob);

            const a = document.createElement('a');
            a.href = url;
            a.download = `test_results_${new Date().toISOString().slice(0, 19).replace(/:/g, '-')}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            showToast('Test results exported successfully', 'success');
        } catch (e) {
            console.error('Export failed:', e);
            showToast('Failed to export test results', 'error');
        }
    };

    window.showTestDetails = function(testName) {
        const testElement = document.querySelector(`[data-test="${testName}"]`);
        if (testElement) {
            testElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
            testElement.style.transform = 'scale(1.02)';
            testElement.style.boxShadow = '0 8px 25px rgba(254, 128, 25, 0.3)';

            setTimeout(() => {
                testElement.style.transform = '';
                testElement.style.boxShadow = '';
            }, 1000);
        }
    };

    window.filterTests = function() {
        const statusFilter = document.getElementById('statusFilter');
        const searchFilter = document.getElementById('searchFilter');

        const statusValue = statusFilter ? statusFilter.value.toLowerCase() : '';
        const searchValue = searchFilter ? searchFilter.value.toLowerCase() : '';

        document.querySelectorAll('.test-detail').forEach(test => {
            const testStatus = test.dataset.status || '';
            const testName = test.dataset.test || '';

            const statusMatch = !statusValue || testStatus === statusValue;
            const searchMatch = !searchValue || testName.toLowerCase().includes(searchValue);

            test.style.display = (statusMatch && searchMatch) ? 'block' : 'none';
        });

        // Update category counters
        updateCategoryCounters();
    };

    function resetFilters() {
        const statusFilter = document.getElementById('statusFilter');
        const searchFilter = document.getElementById('searchFilter');

        if (statusFilter) statusFilter.value = '';
        if (searchFilter) searchFilter.value = '';

        filterTests();
    }

    function updateCategoryCounters() {
        document.querySelectorAll('[data-category]').forEach(category => {
            const categoryValue = category.dataset.category;
            const visibleTests = document.querySelectorAll(`.test-detail[data-category="${categoryValue}"]:not([style*="display: none"])`);
            const totalTests = document.querySelectorAll(`.test-detail[data-category="${categoryValue}"]`);

            const headerText = category.querySelector('.collapsible-header span:first-child');
            if (headerText) {
                const originalText = headerText.textContent.split('(')[0].trim();
                headerText.textContent = `${originalText} (${visibleTests.length}/${totalTests.length} visible)`;
            }
        });
    }

    function renderCharts() {
        if (!testData || !testData.tests) return;

        // Simple ASCII-style charts for universal compatibility
        const chartContainers = document.querySelectorAll('.chart-container');

        if (chartContainers.length >= 1) {
            renderDurationChart(chartContainers[0]);
        }

        if (chartContainers.length >= 2) {
            renderMetricsChart(chartContainers[1]);
        }
    }

    function renderDurationChart(container) {
        const tests = testData.tests.filter(t => t.duration);
        if (tests.length === 0) {
            container.innerHTML = '<div>No duration data available</div>';
            return;
        }

        tests.sort((a, b) => b.duration - a.duration);
        const maxDuration = tests[0].duration;

        let chartHtml = '<div style="font-family: monospace; font-size: 12px; text-align: left;">';
        chartHtml += '<div style="margin-bottom: 10px; font-weight: bold;">Test Duration (seconds)</div>';

        tests.slice(0, 10).forEach(test => {
            const barWidth = Math.max(1, (test.duration / maxDuration) * 40);
            const bar = '█'.repeat(Math.floor(barWidth)) + '░'.repeat(40 - Math.floor(barWidth));
            const statusColor = test.status === 'passed' ? 'var(--accent-success)' :
                               test.status === 'failed' ? 'var(--accent-error)' : 'var(--accent-warning)';

            chartHtml += `<div style="margin: 2px 0; color: ${statusColor};">`;
            chartHtml += `<span style="width: 200px; display: inline-block; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${test.name.slice(0, 25)}</span> `;
            chartHtml += `<span style="font-family: monospace;">${bar}</span> `;
            chartHtml += `<span>${test.duration.toFixed(3)}s</span>`;
            chartHtml += `</div>`;
        });

        chartHtml += '</div>';
        container.innerHTML = chartHtml;
    }

    function renderMetricsChart(container) {
        const allMetrics = testData.tests.flatMap(t => t.performance_metrics || []);

        if (allMetrics.length === 0) {
            container.innerHTML = '<div>No performance metrics available</div>';
            return;
        }

        // Group metrics by name
        const metricGroups = {};
        allMetrics.forEach(metric => {
            if (!metricGroups[metric.name]) {
                metricGroups[metric.name] = [];
            }
            metricGroups[metric.name].push(metric.value);
        });

        let chartHtml = '<div style="font-family: monospace; font-size: 12px; text-align: left;">';
        chartHtml += '<div style="margin-bottom: 10px; font-weight: bold;">Performance Metrics Summary</div>';

        Object.entries(metricGroups).forEach(([name, values]) => {
            const avg = values.reduce((a, b) => a + b, 0) / values.length;
            const min = Math.min(...values);
            const max = Math.max(...values);

            chartHtml += `<div style="margin: 5px 0; padding: 5px; background: var(--bg-secondary); border-radius: 3px;">`;
            chartHtml += `<div style="font-weight: bold;">${name}</div>`;
            chartHtml += `<div style="color: var(--text-muted);">Avg: ${avg.toFixed(3)} | Min: ${min.toFixed(3)} | Max: ${max.toFixed(3)}</div>`;
            chartHtml += `</div>`;
        });

        chartHtml += '</div>';
        container.innerHTML = chartHtml;
    }

    function copyToClipboard(text) {
        if (navigator.clipboard) {
            navigator.clipboard.writeText(text).catch(e => {
                console.error('Clipboard write failed:', e);
                fallbackCopy(text);
            });
        } else {
            fallbackCopy(text);
        }
    }

    function fallbackCopy(text) {
        const textarea = document.createElement('textarea');
        textarea.value = text;
        textarea.style.position = 'absolute';
        textarea.style.left = '-9999px';
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
    }

    function showToast(message, type = 'info') {
        // Remove existing toasts
        document.querySelectorAll('.toast').forEach(t => t.remove());

        const toast = document.createElement('div');
        toast.className = 'toast';
        toast.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--accent-${type});
            color: var(--bg-primary);
            padding: 12px 20px;
            border-radius: 4px;
            font-weight: bold;
            z-index: 10000;
            animation: slideIn 0.3s ease-out;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        `;
        toast.textContent = message;

        document.body.appendChild(toast);

        setTimeout(() => {
            toast.style.animation = 'slideOut 0.3s ease-in';
            setTimeout(() => toast.remove(), 300);
        }, 3000);
    }

    // Add some custom CSS for animations
    const style = document.createElement('style');
    style.textContent = `
        @keyframes slideOut {
            to { transform: translateX(100%); opacity: 0; }
        }
    `;
    document.head.appendChild(style);

    console.log('🎉 Security Test Report initialized successfully!');
})();
</script>
</body>
</html>