import{a as v,w as ct,C as lt,y as dt}from"./chunk-QMGIS6GS-Ycl3lDfV.js";import{j as o}from"./index-B4oKE3iz.js";import{f as F}from"./api-tgDzxHzW.js";import{j as J,h as $,i as ht,w as ut,B as _,o as mt,t as pt,s as w,q as gt}from"./Loader-B9JD8HZZ.js";import{G as N}from"./Group-3SoFkW_U.js";import{T as O}from"./Title-CmbW-mDV.js";import{P as f}from"./Popover-Bqo8g6N_.js";import{A as wt}from"./ActionIcon-55kNUHHC.js";import{c as W}from"./createReactComponent-BN_c2kk2.js";import{D as L}from"./Divider-DNtoRLi1.js";import{I as bt,a as yt,b as vt}from"./InputsGroupFieldset-C5T_ipTq.js";import{a as q,I as H}from"./Input-Dk8j5b2Q.js";import{a as xt}from"./CloseButton-Dy-wbEsU.js";import{B as It}from"./Button-kXQ3kFES.js";import{C as St}from"./Card-Dow6iKi0.js";import"./OptionalPortal-BQJEy_xn.js";import"./use-merged-ref-BUQ1B9HC.js";import"./DirectionProvider-DuCsFlA9.js";import"./FocusTrap-DSZiEh9q.js";import"./create-safe-context-Bb_7Uh0a.js";import"./floating-ui.react-BY6ulEKs.js";import"./Paper-C4kvkNN2.js";const K=v.createContext(null),kt=K.Provider,jt=()=>v.useContext(K),ft={},D=J((t,e)=>{const{value:a,defaultValue:s,onChange:n,size:i,wrapperProps:l,children:c,readOnly:m,...E}=$("SwitchGroup",ft,t),[h,b]=q({value:a,defaultValue:s,finalValue:[],onChange:n}),y=I=>{const p=I.currentTarget.value;!m&&b(h.includes(p)?h.filter(M=>M!==p):[...h,p])};return o.jsx(kt,{value:{value:h,onChange:y,size:i},children:o.jsx(H.Wrapper,{size:i,ref:e,...l,...E,labelElement:"div",__staticSelector:"SwitchGroup",children:o.jsx(bt,{role:"group",children:c})})})});D.classes=H.Wrapper.classes;D.displayName="@mantine/core/SwitchGroup";var Q={root:"m_5f93f3bb",input:"m_926b4011",track:"m_9307d992",thumb:"m_93039a1d",trackLabel:"m_8277e082"};const Ct={labelPosition:"right",withThumbIndicator:!0},_t=mt((t,{radius:e,color:a,size:s})=>({root:{"--switch-radius":e===void 0?void 0:gt(e),"--switch-height":w(s,"switch-height"),"--switch-width":w(s,"switch-width"),"--switch-thumb-size":w(s,"switch-thumb-size"),"--switch-label-font-size":w(s,"switch-label-font-size"),"--switch-track-label-padding":w(s,"switch-track-label-padding"),"--switch-color":a?pt(a,t):void 0}})),x=J((t,e)=>{const a=$("Switch",Ct,t),{classNames:s,className:n,style:i,styles:l,unstyled:c,vars:m,color:E,label:h,offLabel:b,onLabel:y,id:I,size:p,radius:M,wrapperProps:X,thumbIcon:P,checked:S,defaultChecked:Y,onChange:k,labelPosition:T,description:Z,error:R,disabled:U,variant:tt,rootRef:et,mod:st,withThumbIndicator:ot,...at}=a,d=jt(),nt=p||(d==null?void 0:d.size),g=ht({name:"Switch",props:a,classes:Q,className:n,style:i,classNames:s,styles:l,unstyled:c,vars:m,varsResolver:_t}),{styleProps:rt,rest:V}=ut(at),A=xt(I),u=d?{checked:d.value.includes(V.value),onChange:d.onChange}:{},[G,it]=q({value:u.checked??S,defaultValue:Y,finalValue:!1});return o.jsxs(yt,{...g("root"),__staticSelector:"Switch",__stylesApiProps:a,id:A,size:nt,labelPosition:T,label:h,description:Z,error:R,disabled:U,bodyElement:"label",labelElement:"span",classNames:s,styles:l,unstyled:c,"data-checked":u.checked||S||void 0,variant:tt,ref:et,mod:st,...rt,...X,children:[o.jsx("input",{...V,disabled:U,checked:G,"data-checked":u.checked||S||void 0,onChange:j=>{var z;d?(z=u.onChange)==null||z.call(u,j):k==null||k(j),it(j.currentTarget.checked)},id:A,ref:e,type:"checkbox",role:"switch",...g("input")}),o.jsxs(_,{"aria-hidden":"true",component:"span",mod:{error:R,"label-position":T,"without-labels":!y&&!b},...g("track"),children:[o.jsx(_,{component:"span",mod:{"reduce-motion":!0,"with-thumb-indicator":ot&&!P},...g("thumb"),children:P}),o.jsx("span",{...g("trackLabel"),children:G?y:b})]})]})});x.classes={...Q,...vt};x.displayName="@mantine/core/Switch";x.Group=D;/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Dt=W("outline","adjustments","IconAdjustments",[["path",{d:"M4 10a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-0"}],["path",{d:"M6 4v4",key:"svg-1"}],["path",{d:"M6 12v8",key:"svg-2"}],["path",{d:"M10 16a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-3"}],["path",{d:"M12 4v10",key:"svg-4"}],["path",{d:"M12 18v2",key:"svg-5"}],["path",{d:"M16 7a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-6"}],["path",{d:"M18 4v1",key:"svg-7"}],["path",{d:"M18 9v11",key:"svg-8"}]]);/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Et=W("outline","eraser","IconEraser",[["path",{d:"M19 20h-10.5l-4.21 -4.3a1 1 0 0 1 0 -1.41l10 -10a1 1 0 0 1 1.41 0l5 5a1 1 0 0 1 0 1.41l-9.2 9.3",key:"svg-0"}],["path",{d:"M18 13.3l-6.3 -6.3",key:"svg-1"}]]);const r=[];for(let t=0;t<256;++t)r.push((t+256).toString(16).slice(1));function Mt(t,e=0){return(r[t[e+0]]+r[t[e+1]]+r[t[e+2]]+r[t[e+3]]+"-"+r[t[e+4]]+r[t[e+5]]+"-"+r[t[e+6]]+r[t[e+7]]+"-"+r[t[e+8]]+r[t[e+9]]+"-"+r[t[e+10]]+r[t[e+11]]+r[t[e+12]]+r[t[e+13]]+r[t[e+14]]+r[t[e+15]]).toLowerCase()}let C;const Pt=new Uint8Array(16);function Tt(){if(!C){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");C=crypto.getRandomValues.bind(crypto)}return C(Pt)}const Rt=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),B={randomUUID:Rt};function Ut(t,e,a){var n;if(B.randomUUID&&!t)return B.randomUUID();t=t||{};const s=t.random??((n=t.rng)==null?void 0:n.call(t))??Tt();if(s.length<16)throw new Error("Random bytes length must be >= 16");return s[6]=s[6]&15|64,s[8]=s[8]&63|128,Mt(s)}async function oe(){var t;try{const e=localStorage.getItem("jivas-host")||"",a=localStorage.getItem("jivas-agent")||"",s=(t=document.cookie.match(/tsSessionId=([^;]+)/))==null?void 0:t[1],n=s&&s!=="undefined"?s:Ut();try{await F(`${e}/walker/add_frame`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({agent_id:a,session_id:n})}).catch(i=>{console.error("Error creating session:",i)})}catch{console.log("unable to create session")}return{sessionId:n,host:localStorage.getItem("jivas-host")||"",agentId:localStorage.getItem("jivas-agent")||""}}catch(e){return console.log(e),{sessionId:"jvmanager",host:localStorage.getItem("jivas-host")||"",agentId:localStorage.getItem("jivas-agent")||""}}}async function ae({context:t,request:e}){const a=await e.formData(),s=a.get("_action"),n=new FormData,i=a.get("agentId")||"",l=localStorage.getItem("jivas-host")||"",c=a.get("sessionId");if(s==="wipeAgentMemory")return n.append("args",JSON.stringify({session_id:c})),n.append("module_root","actions.jivas.agent_utils_action"),n.append("agent_id",i),n.append("walker","purge_frame_memory"),await F(`${l}/action/walker`,{method:"POST",body:n}).then(async m=>await m.json())}function ne(){return[{title:"Chat | JIVAS Manager"}]}const re=ct(function({loaderData:e}){const[a,s]=v.useState(localStorage.getItem("streaming")==="true"),{selectedAgentInfo:n}=lt(),i=dt(),l=v.useCallback(()=>{const c=new CustomEvent("tsmclearmessages");i.submit({_action:"wipeAgentMemory",agentId:e.agentId||"",sessionId:e.sessionId||""},{method:"POST"}),window.dispatchEvent(c)},[]);return o.jsxs(_,{py:"xl",px:"xl",children:[o.jsxs(N,{justify:"space-between",children:[o.jsx(O,{order:3,children:"Chat"}),o.jsxs(N,{gap:"xs",children:[o.jsxs(f,{width:200,position:"bottom",withArrow:!0,shadow:"md",children:[o.jsx(f.Target,{children:o.jsx(wt,{color:"dark",children:o.jsx(Dt,{size:16})})}),o.jsxs(f.Dropdown,{children:[o.jsx(O,{order:5,children:"Settings"}),o.jsx(L,{my:"xs"}),o.jsx(x,{checked:a,onChange:c=>{window.dispatchEvent(new CustomEvent("tsmsave")),s(c.currentTarget.checked),localStorage.setItem("streaming",c.currentTarget.checked.toString())},label:"Streaming"})]})]}),o.jsx(It,{color:"dark",leftSection:o.jsx(Et,{className:"h-5 w-5"}),size:"xs",onClick:l,loading:i.state!=="idle",children:"Clear Chat Memory"})]})]}),o.jsx(L,{mt:"xs",mb:"xl"}),o.jsx(St,{px:"xl",h:"80vh",withBorder:!0,children:o.jsx("ts-messenger",{streaming:a?"true":"false",host:e.host,"agent-id":e.agentId,"agent-name":n==null?void 0:n.name,theme:JSON.stringify({"--ts-chat-bg":"white","--ts-chat-fg":"black","--ts-chat-popup-bg":"white","--ts-icon-btn-bg":"transparent","--ts-icon-btn-hover-bg":"#E4E4E7","--ts-input-btn-color":"black","--ts-input-bg":"#dbdbdb42","--ts-input-bd":"#D4D4D8","--ts-chat-bd":"#D4D4D8","--chakra-colors-border":"#D4D4D8","--ts-input-color":"black","--ts-input-placeholder-color":"#000000eb","--ts-response-msg-color":"black"}),"with-debug":"true",layout:"standard","session-id":e.sessionId||"","use-local-storage-cache":"true",style:{height:"100%"}},`streaming-${String(a)}`)})]})});export{ae as clientAction,oe as clientLoader,re as default,ne as meta};
