{
  "name": "get_market_data",
  "description": "Retrieve comprehensive market data for Shanghai Composite Index including real-time quotes, historical K-lines, market breadth, valuation metrics, and turnover analysis",
  "inputSchema": {
    "type": "object",
    "properties": {
      "data_type": {
        "type": "string",
        "enum": ["realtime", "history", "breadth", "valuation", "turnover", "all"],
        "description": "Type of market data to retrieve",
        "default": "realtime"
      },
      "index_code": {
        "type": "string",
        "description": "Index code (default: '000001' for Shanghai Composite)",
        "default": "000001",
        "pattern": "^[0-9]{6}$"
      },
      "date": {
        "type": "string",
        "description": "Query date in YYYY-MM-DD format (optional, defaults to today)",
        "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}$"
      },
      "period": {
        "type": "string",
        "enum": ["1min", "5min", "15min", "30min", "60min", "1day", "1week", "1month", "1quarter", "1year"],
        "description": "K-line timeframe (only for data_type='history')",
        "default": "1day"
      },
      "adjust": {
        "type": "string",
        "enum": ["none", "qfq", "hfq"],
        "description": "Price adjustment method: none (不复权), qfq (前复权), hfq (后复权)",
        "default": "none"
      },
      "start_date": {
        "type": "string",
        "description": "Start date for historical data (YYYY-MM-DD)",
        "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}$"
      },
      "end_date": {
        "type": "string",
        "description": "End date for historical data (YYYY-MM-DD)",
        "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}$"
      }
    },
    "required": []
  },
  "outputSchema": {
    "type": "object",
    "properties": {
      "success": {
        "type": "boolean",
        "description": "Whether the request was successful"
      },
      "data_type": {
        "type": "string",
        "description": "Type of data returned"
      },
      "data": {
        "oneOf": [
          {
            "type": "object",
            "description": "Real-time data",
            "properties": {
              "index": {
                "type": "object",
                "description": "Market index data",
                "properties": {
                  "code": { "type": "string" },
                  "name": { "type": "string" },
                  "current": { "type": "number" },
                  "open": { "type": "number" },
                  "high": { "type": "number" },
                  "low": { "type": "number" },
                  "close": { "type": ["number", "null"] },
                  "pre_close": { "type": "number" },
                  "change": { "type": "number" },
                  "change_pct": { "type": "number" },
                  "amplitude": { "type": "number" },
                  "volume": { "type": "integer" },
                  "amount": { "type": "number" },
                  "turnover_rate": { "type": ["number", "null"] },
                  "volume_ratio": { "type": ["number", "null"] },
                  "timestamp": { "type": "string", "format": "date-time" },
                  "trading_date": { "type": "string", "format": "date" },
                  "market_status": { "type": "string" }
                },
                "required": ["code", "name", "current", "open", "high", "low", "pre_close", "change", "change_pct", "volume", "amount", "timestamp", "trading_date", "market_status"]
              }
            },
            "required": ["index"]
          },
          {
            "type": "object",
            "description": "Historical data",
            "properties": {
              "symbol": { "type": "string" },
              "timeframe": { "type": "string" },
              "adjust": { "type": "string" },
              "records": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "date": { "type": "string" },
                    "open": { "type": "number" },
                    "high": { "type": "number" },
                    "low": { "type": "number" },
                    "close": { "type": "number" },
                    "volume": { "type": "integer" },
                    "amount": { "type": ["number", "null"] }
                  },
                  "required": ["date", "open", "high", "low", "close", "volume"]
                }
              },
              "count": { "type": "integer" }
            },
            "required": ["symbol", "timeframe", "records", "count"]
          },
          {
            "type": "object",
            "description": "Market breadth data",
            "properties": {
              "breadth": {
                "type": "object",
                "properties": {
                  "total_stocks": { "type": "integer" },
                  "advancing": { "type": "integer" },
                  "declining": { "type": "integer" },
                  "unchanged": { "type": "integer" },
                  "limit_up": { "type": "integer" },
                  "limit_down": { "type": "integer" },
                  "advance_decline_ratio": { "type": "number" },
                  "advance_pct": { "type": "number" },
                  "decline_pct": { "type": "number" },
                  "date": { "type": "string" },
                  "timestamp": { "type": "string", "format": "date-time" }
                },
                "required": ["total_stocks", "advancing", "declining", "advance_decline_ratio", "date", "timestamp"]
              }
            },
            "required": ["breadth"]
          }
        ]
      },
      "metadata": {
        "type": "object",
        "properties": {
          "query_time": { "type": "string", "format": "date-time" },
          "data_source": { "type": "string" },
          "cache_hit": { "type": "boolean" },
          "data_age_seconds": { "type": ["integer", "null"] }
        },
        "required": ["query_time", "data_source"]
      },
      "error": {
        "type": ["object", "null"],
        "properties": {
          "code": { "type": "string" },
          "message": { "type": "string" },
          "details": { "type": "string" }
        }
      }
    },
    "required": ["success", "data_type", "metadata"]
  },
  "examples": [
    {
      "description": "Get real-time Shanghai index data",
      "input": {
        "data_type": "realtime"
      },
      "output": {
        "success": true,
        "data_type": "realtime",
        "data": {
          "index": {
            "code": "000001",
            "name": "上证指数",
            "current": 3245.67,
            "open": 3230.50,
            "high": 3250.00,
            "low": 3228.00,
            "close": 3245.67,
            "pre_close": 3235.00,
            "change": 10.67,
            "change_pct": 0.33,
            "amplitude": 0.68,
            "volume": 28500000,
            "amount": 345000000000,
            "turnover_rate": 1.25,
            "volume_ratio": 1.15,
            "timestamp": "2025-09-30T15:00:00+08:00",
            "trading_date": "2025-09-30",
            "market_status": "closed"
          }
        },
        "metadata": {
          "query_time": "2025-09-30T15:30:00+08:00",
          "data_source": "akshare",
          "cache_hit": false,
          "data_age_seconds": 1800
        }
      }
    },
    {
      "description": "Get historical daily K-line for last 30 days",
      "input": {
        "data_type": "history",
        "period": "1day",
        "start_date": "2025-09-01",
        "end_date": "2025-09-30"
      },
      "output": {
        "success": true,
        "data_type": "history",
        "data": {
          "symbol": "000001",
          "timeframe": "1day",
          "adjust": "none",
          "records": [
            {
              "date": "2025-09-30",
              "open": 3230.50,
              "high": 3250.00,
              "low": 3228.00,
              "close": 3245.67,
              "volume": 28500000,
              "amount": 345000000000
            }
          ],
          "count": 20
        },
        "metadata": {
          "query_time": "2025-09-30T15:30:00+08:00",
          "data_source": "akshare",
          "cache_hit": true
        }
      }
    },
    {
      "description": "Get market breadth statistics",
      "input": {
        "data_type": "breadth"
      },
      "output": {
        "success": true,
        "data_type": "breadth",
        "data": {
          "breadth": {
            "total_stocks": 5000,
            "advancing": 2800,
            "declining": 2100,
            "unchanged": 100,
            "limit_up": 45,
            "limit_down": 12,
            "gain_over_5pct": 420,
            "loss_over_5pct": 280,
            "new_high_60d": 250,
            "new_low_60d": 120,
            "advance_decline_ratio": 1.33,
            "advance_pct": 56.0,
            "decline_pct": 42.0,
            "date": "2025-09-30",
            "timestamp": "2025-09-30T15:00:00+08:00"
          }
        },
        "metadata": {
          "query_time": "2025-09-30T15:30:00+08:00",
          "data_source": "akshare",
          "cache_hit": false
        }
      }
    }
  ],
  "errors": [
    {
      "code": "INVALID_DATE",
      "message": "Invalid date format",
      "example": {
        "input": { "date": "2025-13-45" },
        "output": {
          "success": false,
          "data_type": "realtime",
          "metadata": {
            "query_time": "2025-09-30T15:30:00+08:00",
            "data_source": "none"
          },
          "error": {
            "code": "INVALID_DATE",
            "message": "Invalid date format. Expected YYYY-MM-DD",
            "details": "Month must be 01-12, day must be valid for month"
          }
        }
      }
    },
    {
      "code": "DATA_UNAVAILABLE",
      "message": "Market data temporarily unavailable",
      "example": {
        "input": { "data_type": "realtime" },
        "output": {
          "success": false,
          "data_type": "realtime",
          "error": {
            "code": "DATA_UNAVAILABLE",
            "message": "Unable to fetch market data after 3 retries",
            "details": "AKShare API timeout. No cached data available."
          },
          "metadata": {
            "query_time": "2025-09-30T15:30:00+08:00",
            "data_source": "none",
            "cache_hit": false
          }
        }
      }
    }
  ],
  "performance": {
    "target_response_time_ms": 2000,
    "typical_response_time_ms": 500,
    "cache_hit_response_time_ms": 10
  }
}
