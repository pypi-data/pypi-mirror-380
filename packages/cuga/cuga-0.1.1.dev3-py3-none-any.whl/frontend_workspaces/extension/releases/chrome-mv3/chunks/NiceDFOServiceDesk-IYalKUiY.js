import{d as te,b7 as jr,b8 as Sn,b9 as On,S as Hr,r as Nn,f as Gt,aZ as Fr,K as Br,b2 as Vr,P as In,R as tt}from"./AppContainer-DlJO1h2A.js";import{M as Dn,B as $r,K as zr,$ as Yr}from"./sidepanel-CYx2dhah.js";import{S as Wr}from"./ServiceDeskImpl-B4MsmRMX.js";/**
* @license
* 
* (C) Copyright IBM Corp. 2017, 2025. All Rights Reserved.
* 
* Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
* in compliance with the License. You may obtain a copy of the License at
* 
* http://www.apache.org/licenses/LICENSE-2.0
* 
* Unless required by applicable law or agreed to in writing, software distributed under the License
* is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
* or implied. See the License for the specific language governing permissions and limitations under
* the License.
* 
* @carbon/ai-chat 0.3.3
* 
* Built: Jul 11 2025 1:09 pm -04:00
* 
* 
*/var bt={exports:{}},gt,Qr=new Uint8Array(16);function Mn(){if(!gt&&(gt=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!gt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return gt(Qr)}var Kr=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function wt(s){return typeof s=="string"&&Kr.test(s)}var re=[];for(var Lt=0;Lt<256;++Lt)re.push((Lt+256).toString(16).substr(1));function Ct(s){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=(re[s[a+0]]+re[s[a+1]]+re[s[a+2]]+re[s[a+3]]+"-"+re[s[a+4]]+re[s[a+5]]+"-"+re[s[a+6]]+re[s[a+7]]+"-"+re[s[a+8]]+re[s[a+9]]+"-"+re[s[a+10]]+re[s[a+11]]+re[s[a+12]]+re[s[a+13]]+re[s[a+14]]+re[s[a+15]]).toLowerCase();if(!wt(r))throw TypeError("Stringified UUID is invalid");return r}var Rn,jt,Ht=0,Ft=0;function qr(s,a,r){var i=a&&r||0,c=a||new Array(16);s=s||{};var d=s.node||Rn,E=s.clockseq!==void 0?s.clockseq:jt;if(d==null||E==null){var j=s.random||(s.rng||Mn)();d==null&&(d=Rn=[j[0]|1,j[1],j[2],j[3],j[4],j[5]]),E==null&&(E=jt=(j[6]<<8|j[7])&16383)}var _=s.msecs!==void 0?s.msecs:Date.now(),f=s.nsecs!==void 0?s.nsecs:Ft+1,o=_-Ht+(f-Ft)/1e4;if(o<0&&s.clockseq===void 0&&(E=E+1&16383),(o<0||_>Ht)&&s.nsecs===void 0&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Ht=_,Ft=f,jt=E,_+=122192928e5;var m=((_&268435455)*1e4+f)%4294967296;c[i++]=m>>>24&255,c[i++]=m>>>16&255,c[i++]=m>>>8&255,c[i++]=m&255;var u=_/4294967296*1e4&268435455;c[i++]=u>>>8&255,c[i++]=u&255,c[i++]=u>>>24&15|16,c[i++]=u>>>16&255,c[i++]=E>>>8|128,c[i++]=E&255;for(var b=0;b<6;++b)c[i+b]=d[b];return a||Ct(c)}function xn(s){if(!wt(s))throw TypeError("Invalid UUID");var a,r=new Uint8Array(16);return r[0]=(a=parseInt(s.slice(0,8),16))>>>24,r[1]=a>>>16&255,r[2]=a>>>8&255,r[3]=a&255,r[4]=(a=parseInt(s.slice(9,13),16))>>>8,r[5]=a&255,r[6]=(a=parseInt(s.slice(14,18),16))>>>8,r[7]=a&255,r[8]=(a=parseInt(s.slice(19,23),16))>>>8,r[9]=a&255,r[10]=(a=parseInt(s.slice(24,36),16))/1099511627776&255,r[11]=a/4294967296&255,r[12]=a>>>24&255,r[13]=a>>>16&255,r[14]=a>>>8&255,r[15]=a&255,r}function Jr(s){s=unescape(encodeURIComponent(s));for(var a=[],r=0;r<s.length;++r)a.push(s.charCodeAt(r));return a}var Xr="6ba7b810-9dad-11d1-80b4-00c04fd430c8",Zr="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function Gn(s,a,r){function i(c,d,E,j){if(typeof c=="string"&&(c=Jr(c)),typeof d=="string"&&(d=xn(d)),d.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var _=new Uint8Array(16+c.length);if(_.set(d),_.set(c,d.length),_=r(_),_[6]=_[6]&15|a,_[8]=_[8]&63|128,E){j=j||0;for(var f=0;f<16;++f)E[j+f]=_[f];return E}return Ct(_)}try{i.name=s}catch{}return i.DNS=Xr,i.URL=Zr,i}function ei(s){if(typeof s=="string"){var a=unescape(encodeURIComponent(s));s=new Uint8Array(a.length);for(var r=0;r<a.length;++r)s[r]=a.charCodeAt(r)}return ti(ni(ri(s),s.length*8))}function ti(s){for(var a=[],r=s.length*32,i="0123456789abcdef",c=0;c<r;c+=8){var d=s[c>>5]>>>c%32&255,E=parseInt(i.charAt(d>>>4&15)+i.charAt(d&15),16);a.push(E)}return a}function Ln(s){return(s+64>>>9<<4)+14+1}function ni(s,a){s[a>>5]|=128<<a%32,s[Ln(a)-1]=a;for(var r=1732584193,i=-271733879,c=-1732584194,d=271733878,E=0;E<s.length;E+=16){var j=r,_=i,f=c,o=d;r=se(r,i,c,d,s[E],7,-680876936),d=se(d,r,i,c,s[E+1],12,-389564586),c=se(c,d,r,i,s[E+2],17,606105819),i=se(i,c,d,r,s[E+3],22,-1044525330),r=se(r,i,c,d,s[E+4],7,-176418897),d=se(d,r,i,c,s[E+5],12,1200080426),c=se(c,d,r,i,s[E+6],17,-1473231341),i=se(i,c,d,r,s[E+7],22,-45705983),r=se(r,i,c,d,s[E+8],7,1770035416),d=se(d,r,i,c,s[E+9],12,-1958414417),c=se(c,d,r,i,s[E+10],17,-42063),i=se(i,c,d,r,s[E+11],22,-1990404162),r=se(r,i,c,d,s[E+12],7,1804603682),d=se(d,r,i,c,s[E+13],12,-40341101),c=se(c,d,r,i,s[E+14],17,-1502002290),i=se(i,c,d,r,s[E+15],22,1236535329),r=ae(r,i,c,d,s[E+1],5,-165796510),d=ae(d,r,i,c,s[E+6],9,-1069501632),c=ae(c,d,r,i,s[E+11],14,643717713),i=ae(i,c,d,r,s[E],20,-373897302),r=ae(r,i,c,d,s[E+5],5,-701558691),d=ae(d,r,i,c,s[E+10],9,38016083),c=ae(c,d,r,i,s[E+15],14,-660478335),i=ae(i,c,d,r,s[E+4],20,-405537848),r=ae(r,i,c,d,s[E+9],5,568446438),d=ae(d,r,i,c,s[E+14],9,-1019803690),c=ae(c,d,r,i,s[E+3],14,-187363961),i=ae(i,c,d,r,s[E+8],20,1163531501),r=ae(r,i,c,d,s[E+13],5,-1444681467),d=ae(d,r,i,c,s[E+2],9,-51403784),c=ae(c,d,r,i,s[E+7],14,1735328473),i=ae(i,c,d,r,s[E+12],20,-1926607734),r=ce(r,i,c,d,s[E+5],4,-378558),d=ce(d,r,i,c,s[E+8],11,-2022574463),c=ce(c,d,r,i,s[E+11],16,1839030562),i=ce(i,c,d,r,s[E+14],23,-35309556),r=ce(r,i,c,d,s[E+1],4,-1530992060),d=ce(d,r,i,c,s[E+4],11,1272893353),c=ce(c,d,r,i,s[E+7],16,-155497632),i=ce(i,c,d,r,s[E+10],23,-1094730640),r=ce(r,i,c,d,s[E+13],4,681279174),d=ce(d,r,i,c,s[E],11,-358537222),c=ce(c,d,r,i,s[E+3],16,-722521979),i=ce(i,c,d,r,s[E+6],23,76029189),r=ce(r,i,c,d,s[E+9],4,-640364487),d=ce(d,r,i,c,s[E+12],11,-421815835),c=ce(c,d,r,i,s[E+15],16,530742520),i=ce(i,c,d,r,s[E+2],23,-995338651),r=ue(r,i,c,d,s[E],6,-198630844),d=ue(d,r,i,c,s[E+7],10,1126891415),c=ue(c,d,r,i,s[E+14],15,-1416354905),i=ue(i,c,d,r,s[E+5],21,-57434055),r=ue(r,i,c,d,s[E+12],6,1700485571),d=ue(d,r,i,c,s[E+3],10,-1894986606),c=ue(c,d,r,i,s[E+10],15,-1051523),i=ue(i,c,d,r,s[E+1],21,-2054922799),r=ue(r,i,c,d,s[E+8],6,1873313359),d=ue(d,r,i,c,s[E+15],10,-30611744),c=ue(c,d,r,i,s[E+6],15,-1560198380),i=ue(i,c,d,r,s[E+13],21,1309151649),r=ue(r,i,c,d,s[E+4],6,-145523070),d=ue(d,r,i,c,s[E+11],10,-1120210379),c=ue(c,d,r,i,s[E+2],15,718787259),i=ue(i,c,d,r,s[E+9],21,-343485551),r=Se(r,j),i=Se(i,_),c=Se(c,f),d=Se(d,o)}return[r,i,c,d]}function ri(s){if(s.length===0)return[];for(var a=s.length*8,r=new Uint32Array(Ln(a)),i=0;i<a;i+=8)r[i>>5]|=(s[i/8]&255)<<i%32;return r}function Se(s,a){var r=(s&65535)+(a&65535),i=(s>>16)+(a>>16)+(r>>16);return i<<16|r&65535}function ii(s,a){return s<<a|s>>>32-a}function At(s,a,r,i,c,d){return Se(ii(Se(Se(a,s),Se(i,d)),c),r)}function se(s,a,r,i,c,d,E){return At(a&r|~a&i,s,a,c,d,E)}function ae(s,a,r,i,c,d,E){return At(a&i|r&~i,s,a,c,d,E)}function ce(s,a,r,i,c,d,E){return At(a^r^i,s,a,c,d,E)}function ue(s,a,r,i,c,d,E){return At(r^(a|~i),s,a,c,d,E)}var oi=Gn("v3",48,ei);function si(s,a,r){s=s||{};var i=s.random||(s.rng||Mn)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,a){r=r||0;for(var c=0;c<16;++c)a[r+c]=i[c];return a}return Ct(i)}function ai(s,a,r,i){switch(s){case 0:return a&r^~a&i;case 1:return a^r^i;case 2:return a&r^a&i^r&i;case 3:return a^r^i}}function Bt(s,a){return s<<a|s>>>32-a}function ci(s){var a=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof s=="string"){var i=unescape(encodeURIComponent(s));s=[];for(var c=0;c<i.length;++c)s.push(i.charCodeAt(c))}else Array.isArray(s)||(s=Array.prototype.slice.call(s));s.push(128);for(var d=s.length/4+2,E=Math.ceil(d/16),j=new Array(E),_=0;_<E;++_){for(var f=new Uint32Array(16),o=0;o<16;++o)f[o]=s[_*64+o*4]<<24|s[_*64+o*4+1]<<16|s[_*64+o*4+2]<<8|s[_*64+o*4+3];j[_]=f}j[E-1][14]=(s.length-1)*8/Math.pow(2,32),j[E-1][14]=Math.floor(j[E-1][14]),j[E-1][15]=(s.length-1)*8&4294967295;for(var m=0;m<E;++m){for(var u=new Uint32Array(80),b=0;b<16;++b)u[b]=j[m][b];for(var h=16;h<80;++h)u[h]=Bt(u[h-3]^u[h-8]^u[h-14]^u[h-16],1);for(var v=r[0],p=r[1],k=r[2],G=r[3],N=r[4],O=0;O<80;++O){var A=Math.floor(O/20),T=Bt(v,5)+ai(A,p,k,G)+N+a[A]+u[O]>>>0;N=G,G=k,k=Bt(p,30)>>>0,p=v,v=T}r[0]=r[0]+v>>>0,r[1]=r[1]+p>>>0,r[2]=r[2]+k>>>0,r[3]=r[3]+G>>>0,r[4]=r[4]+N>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,r[0]&255,r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,r[1]&255,r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,r[2]&255,r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,r[3]&255,r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,r[4]&255]}var ui=Gn("v5",80,ci),li="00000000-0000-0000-0000-000000000000";function di(s){if(!wt(s))throw TypeError("Invalid UUID");return parseInt(s.substr(14,1),16)}var hi=Object.freeze({__proto__:null,NIL:li,parse:xn,stringify:Ct,v1:qr,v3:oi,v4:si,v5:ui,validate:wt,version:di}),Tt={exports:{}},Pn;function fi(){return Pn||(Pn=1,(function(s,a){(function(r,i){var c="1.0.37",d="",E="?",j="function",_="undefined",f="object",o="string",m="major",u="model",b="name",h="type",v="vendor",p="version",k="architecture",G="console",N="mobile",O="tablet",A="smarttv",T="wearable",S="embedded",R=500,g="Amazon",U="Apple",z="ASUS",X="BlackBerry",B="Browser",ne="Chrome",fe="Edge",Me="Firefox",me="Google",nt="Huawei",xe="LG",ge="Microsoft",$e="Motorola",Oe="Opera",we="Samsung",ze="Sharp",Ne="Sony",Ye="Xiaomi",ve="Zebra",rt="Facebook",it="Chromium OS",ot="Mac OS",yt=function(H,$){var x={};for(var K in H)$[K]&&$[K].length%2===0?x[K]=$[K].concat(H[K]):x[K]=H[K];return x},Ge=function(H){for(var $={},x=0;x<H.length;x++)$[H[x].toUpperCase()]=H[x];return $},st=function(H,$){return typeof H===o?Ie($).indexOf(Ie(H))!==-1:!1},Ie=function(H){return H.toLowerCase()},De=function(H){return typeof H===o?H.replace(/[^\d\.]/g,d).split(".")[0]:i},Re=function(H,$){if(typeof H===o)return H=H.replace(/^\s\s*/,d),typeof $===_?H:H.substring(0,R)},Te=function(H,$){for(var x=0,K,_e,Ee,F,M,de;x<$.length&&!M;){var je=$[x],Ke=$[x+1];for(K=_e=0;K<je.length&&!M&&je[K];)if(M=je[K++].exec(H),M)for(Ee=0;Ee<Ke.length;Ee++)de=M[++_e],F=Ke[Ee],typeof F===f&&F.length>0?F.length===2?typeof F[1]==j?this[F[0]]=F[1].call(this,de):this[F[0]]=F[1]:F.length===3?typeof F[1]===j&&!(F[1].exec&&F[1].test)?this[F[0]]=de?F[1].call(this,de,F[2]):i:this[F[0]]=de?de.replace(F[1],F[2]):i:F.length===4&&(this[F[0]]=de?F[3].call(this,de.replace(F[1],F[2])):i):this[F]=de||i;x+=2}},Pe=function(H,$){for(var x in $)if(typeof $[x]===f&&$[x].length>0){for(var K=0;K<$[x].length;K++)if(st($[x][K],H))return x===E?i:x}else if(st($[x],H))return x===E?i:x;return H},We={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},Le={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Qe={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[p,[b,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[p,[b,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[b,p],[/opios[\/ ]+([\w\.]+)/i],[p,[b,Oe+" Mini"]],[/\bopr\/([\w\.]+)/i],[p,[b,Oe]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[p,[b,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[b,p],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[p,[b,"UC"+B]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[p,[b,"WeChat"]],[/konqueror\/([\w\.]+)/i],[p,[b,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[p,[b,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[p,[b,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[p,[b,"Smart Lenovo "+B]],[/(avast|avg)\/([\w\.]+)/i],[[b,/(.+)/,"$1 Secure "+B],p],[/\bfocus\/([\w\.]+)/i],[p,[b,Me+" Focus"]],[/\bopt\/([\w\.]+)/i],[p,[b,Oe+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[p,[b,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[p,[b,"Dolphin"]],[/coast\/([\w\.]+)/i],[p,[b,Oe+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[p,[b,"MIUI "+B]],[/fxios\/([-\w\.]+)/i],[p,[b,Me]],[/\bqihu|(qi?ho?o?|360)browser/i],[[b,"360 "+B]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[b,/(.+)/,"$1 "+B],p],[/samsungbrowser\/([\w\.]+)/i],[p,[b,we+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[b,/_/g," "],p],[/metasr[\/ ]?([\d\.]+)/i],[p,[b,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[b,"Sogou Mobile"],p],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[b,p],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[b],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[b,rt],p],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[b,p],[/\bgsa\/([\w\.]+) .*safari\//i],[p,[b,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[p,[b,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[p,[b,ne+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[b,ne+" WebView"],p],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[p,[b,"Android "+B]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[b,p],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[p,[b,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[p,b],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[b,[p,Pe,We]],[/(webkit|khtml)\/([\w\.]+)/i],[b,p],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[b,"Netscape"],p],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[p,[b,Me+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[b,p],[/(cobalt)\/([\w\.]+)/i],[b,[p,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[k,"amd64"]],[/(ia32(?=;))/i],[[k,Ie]],[/((?:i[346]|x)86)[;\)]/i],[[k,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[k,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[k,"armhf"]],[/windows (ce|mobile); ppc;/i],[[k,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[k,/ower/,d,Ie]],[/(sun4\w)[;\)]/i],[[k,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[k,Ie]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[u,[v,we],[h,O]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[u,[v,we],[h,N]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[u,[v,U],[h,N]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[u,[v,U],[h,O]],[/(macintosh);/i],[u,[v,U]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[u,[v,ze],[h,N]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[u,[v,nt],[h,O]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[u,[v,nt],[h,N]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[u,/_/g," "],[v,Ye],[h,N]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[u,/_/g," "],[v,Ye],[h,O]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[u,[v,"OPPO"],[h,N]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[u,[v,"Vivo"],[h,N]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[u,[v,"Realme"],[h,N]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[u,[v,$e],[h,N]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[u,[v,$e],[h,O]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[u,[v,xe],[h,O]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[u,[v,xe],[h,N]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[u,[v,"Lenovo"],[h,O]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[u,/_/g," "],[v,"Nokia"],[h,N]],[/(pixel c)\b/i],[u,[v,me],[h,O]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[u,[v,me],[h,N]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[u,[v,Ne],[h,N]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[u,"Xperia Tablet"],[v,Ne],[h,O]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[u,[v,"OnePlus"],[h,N]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[u,[v,g],[h,O]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[u,/(.+)/g,"Fire Phone $1"],[v,g],[h,N]],[/(playbook);[-\w\),; ]+(rim)/i],[u,v,[h,O]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[u,[v,X],[h,N]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[u,[v,z],[h,O]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[u,[v,z],[h,N]],[/(nexus 9)/i],[u,[v,"HTC"],[h,O]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[v,[u,/_/g," "],[h,N]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[u,[v,"Acer"],[h,O]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[u,[v,"Meizu"],[h,N]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[u,[v,"Ulefone"],[h,N]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[v,u,[h,N]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[v,u,[h,O]],[/(surface duo)/i],[u,[v,ge],[h,O]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[u,[v,"Fairphone"],[h,N]],[/(u304aa)/i],[u,[v,"AT&T"],[h,N]],[/\bsie-(\w*)/i],[u,[v,"Siemens"],[h,N]],[/\b(rct\w+) b/i],[u,[v,"RCA"],[h,O]],[/\b(venue[\d ]{2,7}) b/i],[u,[v,"Dell"],[h,O]],[/\b(q(?:mv|ta)\w+) b/i],[u,[v,"Verizon"],[h,O]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[u,[v,"Barnes & Noble"],[h,O]],[/\b(tm\d{3}\w+) b/i],[u,[v,"NuVision"],[h,O]],[/\b(k88) b/i],[u,[v,"ZTE"],[h,O]],[/\b(nx\d{3}j) b/i],[u,[v,"ZTE"],[h,N]],[/\b(gen\d{3}) b.+49h/i],[u,[v,"Swiss"],[h,N]],[/\b(zur\d{3}) b/i],[u,[v,"Swiss"],[h,O]],[/\b((zeki)?tb.*\b) b/i],[u,[v,"Zeki"],[h,O]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[v,"Dragon Touch"],u,[h,O]],[/\b(ns-?\w{0,9}) b/i],[u,[v,"Insignia"],[h,O]],[/\b((nxa|next)-?\w{0,9}) b/i],[u,[v,"NextBook"],[h,O]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[v,"Voice"],u,[h,N]],[/\b(lvtel\-)?(v1[12]) b/i],[[v,"LvTel"],u,[h,N]],[/\b(ph-1) /i],[u,[v,"Essential"],[h,N]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[u,[v,"Envizen"],[h,O]],[/\b(trio[-\w\. ]+) b/i],[u,[v,"MachSpeed"],[h,O]],[/\btu_(1491) b/i],[u,[v,"Rotor"],[h,O]],[/(shield[\w ]+) b/i],[u,[v,"Nvidia"],[h,O]],[/(sprint) (\w+)/i],[v,u,[h,N]],[/(kin\.[onetw]{3})/i],[[u,/\./g," "],[v,ge],[h,N]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[u,[v,ve],[h,O]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[u,[v,ve],[h,N]],[/smart-tv.+(samsung)/i],[v,[h,A]],[/hbbtv.+maple;(\d+)/i],[[u,/^/,"SmartTV"],[v,we],[h,A]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[v,xe],[h,A]],[/(apple) ?tv/i],[v,[u,U+" TV"],[h,A]],[/crkey/i],[[u,ne+"cast"],[v,me],[h,A]],[/droid.+aft(\w+)( bui|\))/i],[u,[v,g],[h,A]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[u,[v,ze],[h,A]],[/(bravia[\w ]+)( bui|\))/i],[u,[v,Ne],[h,A]],[/(mitv-\w{5}) bui/i],[u,[v,Ye],[h,A]],[/Hbbtv.*(technisat) (.*);/i],[v,u,[h,A]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[v,Re],[u,Re],[h,A]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[h,A]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[v,u,[h,G]],[/droid.+; (shield) bui/i],[u,[v,"Nvidia"],[h,G]],[/(playstation [345portablevi]+)/i],[u,[v,Ne],[h,G]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[u,[v,ge],[h,G]],[/((pebble))app/i],[v,u,[h,T]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[u,[v,U],[h,T]],[/droid.+; (glass) \d/i],[u,[v,me],[h,T]],[/droid.+; (wt63?0{2,3})\)/i],[u,[v,ve],[h,T]],[/(quest( 2| pro)?)/i],[u,[v,rt],[h,T]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[v,[h,S]],[/(aeobc)\b/i],[u,[v,g],[h,S]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[u,[h,N]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[u,[h,O]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[h,O]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[h,N]],[/(android[-\w\. ]{0,9});.+buil/i],[u,[v,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[p,[b,fe+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[p,[b,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[b,p],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[p,b]],os:[[/microsoft (windows) (vista|xp)/i],[b,p],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[b,[p,Pe,Le]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[p,Pe,Le],[b,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[p,/_/g,"."],[b,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[b,ot],[p,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[p,b],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[b,p],[/\(bb(10);/i],[p,[b,X]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[p,[b,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[p,[b,Me+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[p,[b,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[p,[b,"watchOS"]],[/crkey\/([\d\.]+)/i],[p,[b,ne+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[b,it],p],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[b,p],[/(sunos) ?([\w\.\d]*)/i],[[b,"Solaris"],p],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[b,p]]},le=function(H,$){if(typeof H===f&&($=H,H=i),!(this instanceof le))return new le(H,$).getResult();var x=typeof r!==_&&r.navigator?r.navigator:i,K=H||(x&&x.userAgent?x.userAgent:d),_e=x&&x.userAgentData?x.userAgentData:i,Ee=$?yt(Qe,$):Qe,F=x&&x.userAgent==K;return this.getBrowser=function(){var M={};return M[b]=i,M[p]=i,Te.call(M,K,Ee.browser),M[m]=De(M[p]),F&&x&&x.brave&&typeof x.brave.isBrave==j&&(M[b]="Brave"),M},this.getCPU=function(){var M={};return M[k]=i,Te.call(M,K,Ee.cpu),M},this.getDevice=function(){var M={};return M[v]=i,M[u]=i,M[h]=i,Te.call(M,K,Ee.device),F&&!M[h]&&_e&&_e.mobile&&(M[h]=N),F&&M[u]=="Macintosh"&&x&&typeof x.standalone!==_&&x.maxTouchPoints&&x.maxTouchPoints>2&&(M[u]="iPad",M[h]=O),M},this.getEngine=function(){var M={};return M[b]=i,M[p]=i,Te.call(M,K,Ee.engine),M},this.getOS=function(){var M={};return M[b]=i,M[p]=i,Te.call(M,K,Ee.os),F&&!M[b]&&_e&&_e.platform!="Unknown"&&(M[b]=_e.platform.replace(/chrome os/i,it).replace(/macos/i,ot)),M},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return K},this.setUA=function(M){return K=typeof M===o&&M.length>R?Re(M,R):M,this},this.setUA(K),this};le.VERSION=c,le.BROWSER=Ge([b,p,m]),le.CPU=Ge([k]),le.DEVICE=Ge([u,v,h,G,N,A,O,T,S]),le.ENGINE=le.OS=Ge([b,p]),s.exports&&(a=s.exports=le),a.UAParser=le;var be=typeof r!==_&&(r.jQuery||r.Zepto);if(be&&!be.ua){var Ue=new le;be.ua=Ue.getResult(),be.ua.get=function(){return Ue.getUA()},be.ua.set=function(H){Ue.setUA(H);var $=Ue.getResult();for(var x in $)be.ua[x]=$[x]}}})(typeof window=="object"?window:tt)})(Tt,Tt.exports)),Tt.exports}/*! For license information please see index.js.LICENSE.txt */bt.exports;(function(s,a){(function(r,i){s.exports=i(hi,fi())})(self,((r,i)=>(()=>{var c={910:(_,f,o)=>{f.Nf=void 0,o(151),o(749),f.Nf=function(m){var u=Date.parse(m);return isNaN(u)&&(u=(function(b){var h,v=/^(\d{4}-\d\d-\d\d([tT][\d:.]*)?)([zZ]|([+-])(\d\d):?(\d\d))?$/.exec(b)||[];if(v[1]){if((h=v[1].split(/\D/).map((function(k){return parseInt(k,10)||0})))[1]-=1,!(h=new Date(Date.UTC.apply(Date,h))).getDate())return NaN;if(v[5]){var p=60*parseInt(v[5],10);v[6]&&(p+=parseInt(v[6],10)),v[4]==="+"&&(p*=-1),p&&h.setUTCMinutes(h.getUTCMinutes()+p)}return h.getTime()}return NaN})(m)),new Date(u)}},749:(_,f)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.getTimeInMinutes=f.getTimeInMilliseconds=f.getTimeInSeconds=f.padDateTimeUnit=void 0,f.padDateTimeUnit=function(o){var m=Math.abs(Math.floor(typeof o=="string"?Number(o):o));return(m<10?"0":"")+m},f.getTimeInSeconds=function(o){var m=o.hours,u=m===void 0?0:m,b=o.minutes,h=b===void 0?0:b,v=o.seconds;return 60*u*60+60*h+(v===void 0?0:v)},f.getTimeInMilliseconds=function(o){var m=o.hours,u=m===void 0?0:m,b=o.minutes,h=b===void 0?0:b,v=o.seconds,p=v===void 0?0:v,k=o.milliseconds,G=k===void 0?0:k;return 1e3*(0,f.getTimeInSeconds)({hours:u,minutes:h,seconds:p})+G},f.getTimeInMinutes=function(o){var m=o.hours,u=m===void 0?0:m,b=o.minutes,h=b===void 0?0:b,v=o.seconds,p=v===void 0?0:v;return(0,f.getTimeInSeconds)({hours:u,minutes:h,seconds:p})/60}},151:(_,f,o)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.getTimezoneISOOffset=void 0;var m=o(749);f.getTimezoneISOOffset=function(u){u===void 0&&(u=new Date);var b=u.getTimezoneOffset();return"".concat(b>0?"-":"+").concat((0,m.padDateTimeUnit)(b/60),":").concat((0,m.padDateTimeUnit)(b%60))}},893:(_,f)=>{f.P=void 0,f.P=function(o){return Object.keys(o).filter((function(m){return o[m]!==null})).map((function(m){return[m,o[m]].map(encodeURIComponent).join("=")})).join("&")}},282:(_,f)=>{var o;Object.defineProperty(f,"__esModule",{value:!0}),f.LogLevels=void 0,(o=f.LogLevels||(f.LogLevels={})).ERROR="error",o.INFO="info",o.WARN="warn"},996:(_,f)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.EventTargetPolyfill=void 0;var o=(function(){function m(){this.listeners={}}return m.prototype.addEventListener=function(u,b){u in this.listeners||(this.listeners[u]=[]),this.listeners[u].push(b)},m.prototype.removeEventListener=function(u,b){if(u in this.listeners){for(var h=this.listeners[u],v=0,p=h.length;v<p;v++)if(h[v]===b)return void h.splice(v,1)}},m.prototype.dispatchEvent=function(u){if(!(u.type in this.listeners))return!0;for(var b=this.listeners[u.type].slice(),h=0,v=b.length;h<v;h++)b[h].call(this,u);return!u.defaultPrevented},m})();f.EventTargetPolyfill=o},455:(_,f,o)=>{f.xT=void 0,o(546),o(996),o(846);var m=o(982);Object.defineProperty(f,"xT",{enumerable:!0,get:function(){return m.WebSocketClientEvent}})},415:function(_,f,o){var m=this&&this.__assign||function(){return m=Object.assign||function(k){for(var G,N=1,O=arguments.length;N<O;N++)for(var A in G=arguments[N])Object.prototype.hasOwnProperty.call(G,A)&&(k[A]=G[A]);return k},m.apply(this,arguments)},u=this&&this.__rest||function(k,G){var N={};for(var O in k)Object.prototype.hasOwnProperty.call(k,O)&&G.indexOf(O)<0&&(N[O]=k[O]);if(k!=null&&typeof Object.getOwnPropertySymbols=="function"){var A=0;for(O=Object.getOwnPropertySymbols(k);A<O.length;A++)G.indexOf(O[A])<0&&Object.prototype.propertyIsEnumerable.call(k,O[A])&&(N[O[A]]=k[O[A]])}return N};Object.defineProperty(f,"__esModule",{value:!0}),f.getPushUpdateWebSocket=f.setupSocketConnection=void 0;var b=o(846),h=o(982),v=null,p={forceSecureProtocol:!1,heartbeatAfterAuthorize:!1,maxRetries:20,maxReconnectionDelay:1e3};f.setupSocketConnection=function(k,G){if(G===void 0&&(G={}),typeof G!="object")throw new TypeError("Options parameter must be an object not a "+typeof G);var N=m(m({},p),G),O=N.forceSecureProtocol,A=N.heartbeatAfterAuthorize,T=u(N,["forceSecureProtocol","heartbeatAfterAuthorize"]),S=(function(R,g){return g?"wss://"+R:(window.location.protocol==="https:"?"wss:":"ws:")+"//"+R})(k,O);return v=new b.WebSocketClient(S,void 0,T),A?v.addEventListener(h.WebSocketClientEvent.MESSAGE,(function(R){JSON.parse(R.detail.data)==="authorized"&&(v==null||v.startHeartBeat())})):v.startHeartBeat(),v},f.getPushUpdateWebSocket=function(){return v}},546:(_,f)=>{var o;Object.defineProperty(f,"__esModule",{value:!0}),f.HeartBeatState=void 0,(o=f.HeartBeatState||(f.HeartBeatState={})).DIED="died",o.DYING="dying",o.LIVING="living"},846:function(_,f,o){var m,u=this&&this.__extends||(m=function(O,A){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(T,S){T.__proto__=S}||function(T,S){for(var R in S)Object.prototype.hasOwnProperty.call(S,R)&&(T[R]=S[R])},m(O,A)},function(O,A){function T(){this.constructor=O}m(O,A),O.prototype=A===null?Object.create(A):(T.prototype=A.prototype,new T)}),b=this&&this.__importDefault||function(O){return O&&O.__esModule?O:{default:O}};Object.defineProperty(f,"__esModule",{value:!0}),f.WebSocketClient=f.HEART_BEAT_CHECK_TIMEOUT=f.HEART_BEAT_INTERVAL=void 0;var h=o(282),v=b(o(864)),p=o(996),k=o(546),G=o(982);f.HEART_BEAT_INTERVAL=15e3,f.HEART_BEAT_CHECK_TIMEOUT=3*f.HEART_BEAT_INTERVAL;var N=(function(O){function A(T,S,R){var g=O.call(this)||this;return g.heartBeatTimeout=null,g.heartBeatCheckTimeout=null,g.enableDebugMode=function(){g.debugMode||g.log(h.LogLevels.INFO,"websocket-push-updates--loggerEnabled"),g.debugMode=!0},g.disableDebugMode=function(){g.debugMode=!1},g.log=function(U,z,X){g.debugMode&&g.logger&&g.logger[U](z,X)},g.sendHeartBeat=function(){g.log(h.LogLevels.INFO,"websocket-push-updates--sendHeartBeat"),g.send(JSON.stringify({action:"heartbeat"}))},g.handleHeartBeatResponse=function(){g.heartBeatState===k.HeartBeatState.DYING&&(g.heartBeatState=k.HeartBeatState.LIVING,g.dispatchHeartBeatState()),g.setHeartBeatCheckTimeout()},g.setHeartBeatCheckTimeout=function(){g.heartBeatCheckTimeout!==null&&clearTimeout(g.heartBeatCheckTimeout),g.heartBeatCheckTimeout=setTimeout((function(){g.heartBeatState=k.HeartBeatState.DYING,g.dispatchHeartBeatState()}),f.HEART_BEAT_CHECK_TIMEOUT)},g.dispatchHeartBeatState=function(){g.log(h.LogLevels.INFO,"websocket-push-updates--dispatchHeartBeatState",[{hearbeatState:g.heartBeatState}]),g.heartBeatState!==null&&g.dispatchEvent(new CustomEvent(g.heartBeatState))},g.isHeartBeatActive=function(){return g.heartBeatState!==null},g.heartBeatState=null,g.debugMode=!1,g.socket=new v.default(T,S,R),g.socket.onopen=function(){g.dispatchEvent(new CustomEvent(G.WebSocketClientEvent.OPEN))},R!=null&&R.logger&&(g.logger=R.logger),g.socket.onclose=function(U){g.socket.retryCount===(R==null?void 0:R.maxRetries)?g.heartBeatState=k.HeartBeatState.DIED:g.heartBeatState=k.HeartBeatState.DYING,g.dispatchHeartBeatState(),g.dispatchEvent(new CustomEvent(G.WebSocketClientEvent.CLOSE,{detail:U}))},g.socket.onmessage=function(U){g.handleHeartBeatResponse(),JSON.parse(U.data)!=="pong"&&(g.log(h.LogLevels.INFO,"websocket-push-updates--onmessage",[U]),g.dispatchEvent(new CustomEvent(G.WebSocketClientEvent.MESSAGE,{detail:U})))},g.socket.onerror=function(U){g.log(h.LogLevels.ERROR,"websocket-push-updates--onError",[U]),g.dispatchEvent(new CustomEvent(G.WebSocketClientEvent.ERROR,{detail:U}))},g}return u(A,O),A.prototype.send=function(T){this.socket.send(T)},A.prototype.startHeartBeat=function(){var T=this;this.log(h.LogLevels.INFO,"websocket-push-updates--startHeartBeat",[{interval:f.HEART_BEAT_INTERVAL}]);var S=function(){T.log(h.LogLevels.INFO,"websocket-push-updates--heartBeatCallback"),T.sendHeartBeat(),T.heartBeatTimeout=setTimeout(S,f.HEART_BEAT_INTERVAL)};this.setHeartBeatCheckTimeout(),S(),this.heartBeatState=k.HeartBeatState.LIVING},A.prototype.stopHeartBeat=function(){this.log(h.LogLevels.INFO,"websocket-push-updates--stopHeartBeat"),this.heartBeatTimeout!==null&&clearTimeout(this.heartBeatTimeout),this.heartBeatCheckTimeout!==null&&clearTimeout(this.heartBeatCheckTimeout),this.heartBeatState=null},A})(p.EventTargetPolyfill);f.WebSocketClient=N},982:(_,f)=>{var o;Object.defineProperty(f,"__esModule",{value:!0}),f.WebSocketClientEvent=void 0,(o=f.WebSocketClientEvent||(f.WebSocketClientEvent={})).CLOSE="close",o.ERROR="error",o.MESSAGE="message",o.OPEN="open"},864:(_,f,o)=>{o.r(f),o.d(f,{default:()=>O});var m=function(A,T){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(S,R){S.__proto__=R}||function(S,R){for(var g in R)R.hasOwnProperty(g)&&(S[g]=R[g])},m(A,T)};function u(A,T){function S(){this.constructor=A}m(A,T),A.prototype=T===null?Object.create(T):(S.prototype=T.prototype,new S)}function b(A,T){var S=typeof Symbol=="function"&&A[Symbol.iterator];if(!S)return A;var R,g,U=S.call(A),z=[];try{for(;(T===void 0||T-- >0)&&!(R=U.next()).done;)z.push(R.value)}catch(X){g={error:X}}finally{try{R&&!R.done&&(S=U.return)&&S.call(U)}finally{if(g)throw g.error}}return z}function h(){for(var A=[],T=0;T<arguments.length;T++)A=A.concat(b(arguments[T]));return A}var v=function(A,T){this.target=T,this.type=A},p=(function(A){function T(S,R){var g=A.call(this,"error",R)||this;return g.message=S.message,g.error=S,g}return u(T,A),T})(v),k=(function(A){function T(S,R,g){S===void 0&&(S=1e3),R===void 0&&(R="");var U=A.call(this,"close",g)||this;return U.wasClean=!0,U.code=S,U.reason=R,U}return u(T,A),T})(v),G=function(){if(typeof WebSocket<"u")return WebSocket},N={maxReconnectionDelay:1e4,minReconnectionDelay:1e3+4e3*Math.random(),minUptime:5e3,reconnectionDelayGrowFactor:1.3,connectionTimeout:4e3,maxRetries:1/0,maxEnqueuedMessages:1/0};const O=(function(){function A(T,S,R){var g=this;R===void 0&&(R={}),this._listeners={error:[],message:[],open:[],close:[]},this._retryCount=-1,this._shouldReconnect=!0,this._connectLock=!1,this._binaryType="blob",this._closeCalled=!1,this._messageQueue=[],this.onclose=null,this.onerror=null,this.onmessage=null,this.onopen=null,this._handleOpen=function(U){g._debug("open event");var z=g._options.minUptime,X=z===void 0?N.minUptime:z;clearTimeout(g._connectTimeout),g._uptimeTimeout=setTimeout((function(){return g._acceptOpen()}),X),g._ws.binaryType=g._binaryType,g._messageQueue.forEach((function(B){var ne;return(ne=g._ws)===null||ne===void 0?void 0:ne.send(B)})),g._messageQueue=[],g.onopen&&g.onopen(U),g._listeners.open.forEach((function(B){return g._callEventListener(U,B)}))},this._handleMessage=function(U){g._debug("message event"),g.onmessage&&g.onmessage(U),g._listeners.message.forEach((function(z){return g._callEventListener(U,z)}))},this._handleError=function(U){g._debug("error event",U.message),g._disconnect(void 0,U.message==="TIMEOUT"?"timeout":void 0),g.onerror&&g.onerror(U),g._debug("exec error listeners"),g._listeners.error.forEach((function(z){return g._callEventListener(U,z)})),g._connect()},this._handleClose=function(U){g._debug("close event"),g._clearTimeouts(),g._shouldReconnect&&g._connect(),g.onclose&&g.onclose(U),g._listeners.close.forEach((function(z){return g._callEventListener(U,z)}))},this._url=T,this._protocols=S,this._options=R,this._options.startClosed&&(this._shouldReconnect=!1),this._connect()}return Object.defineProperty(A,"CONNECTING",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(A,"OPEN",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(A,"CLOSING",{get:function(){return 2},enumerable:!0,configurable:!0}),Object.defineProperty(A,"CLOSED",{get:function(){return 3},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"CONNECTING",{get:function(){return A.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"OPEN",{get:function(){return A.OPEN},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"CLOSING",{get:function(){return A.CLOSING},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"CLOSED",{get:function(){return A.CLOSED},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"binaryType",{get:function(){return this._ws?this._ws.binaryType:this._binaryType},set:function(T){this._binaryType=T,this._ws&&(this._ws.binaryType=T)},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"retryCount",{get:function(){return Math.max(this._retryCount,0)},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"bufferedAmount",{get:function(){return this._messageQueue.reduce((function(T,S){return typeof S=="string"?T+=S.length:S instanceof Blob?T+=S.size:T+=S.byteLength,T}),0)+(this._ws?this._ws.bufferedAmount:0)},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"extensions",{get:function(){return this._ws?this._ws.extensions:""},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"protocol",{get:function(){return this._ws?this._ws.protocol:""},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"readyState",{get:function(){return this._ws?this._ws.readyState:this._options.startClosed?A.CLOSED:A.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"url",{get:function(){return this._ws?this._ws.url:""},enumerable:!0,configurable:!0}),A.prototype.close=function(T,S){T===void 0&&(T=1e3),this._closeCalled=!0,this._shouldReconnect=!1,this._clearTimeouts(),this._ws?this._ws.readyState!==this.CLOSED?this._ws.close(T,S):this._debug("close: already closed"):this._debug("close enqueued: no ws instance")},A.prototype.reconnect=function(T,S){this._shouldReconnect=!0,this._closeCalled=!1,this._retryCount=-1,this._ws&&this._ws.readyState!==this.CLOSED?(this._disconnect(T,S),this._connect()):this._connect()},A.prototype.send=function(T){if(this._ws&&this._ws.readyState===this.OPEN)this._debug("send",T),this._ws.send(T);else{var S=this._options.maxEnqueuedMessages,R=S===void 0?N.maxEnqueuedMessages:S;this._messageQueue.length<R&&(this._debug("enqueue",T),this._messageQueue.push(T))}},A.prototype.addEventListener=function(T,S){this._listeners[T]&&this._listeners[T].push(S)},A.prototype.dispatchEvent=function(T){var S,R,g=this._listeners[T.type];if(g)try{for(var U=(function(B){var ne=typeof Symbol=="function"&&B[Symbol.iterator],fe=0;return ne?ne.call(B):{next:function(){return B&&fe>=B.length&&(B=void 0),{value:B&&B[fe++],done:!B}}}})(g),z=U.next();!z.done;z=U.next()){var X=z.value;this._callEventListener(T,X)}}catch(B){S={error:B}}finally{try{z&&!z.done&&(R=U.return)&&R.call(U)}finally{if(S)throw S.error}}return!0},A.prototype.removeEventListener=function(T,S){this._listeners[T]&&(this._listeners[T]=this._listeners[T].filter((function(R){return R!==S})))},A.prototype._debug=function(){for(var T=[],S=0;S<arguments.length;S++)T[S]=arguments[S];this._options.debug&&console.log.apply(console,h(["RWS>"],T))},A.prototype._getNextDelay=function(){var T=this._options,S=T.reconnectionDelayGrowFactor,R=S===void 0?N.reconnectionDelayGrowFactor:S,g=T.minReconnectionDelay,U=g===void 0?N.minReconnectionDelay:g,z=T.maxReconnectionDelay,X=z===void 0?N.maxReconnectionDelay:z,B=0;return this._retryCount>0&&(B=U*Math.pow(R,this._retryCount-1))>X&&(B=X),this._debug("next delay",B),B},A.prototype._wait=function(){var T=this;return new Promise((function(S){setTimeout(S,T._getNextDelay())}))},A.prototype._getNextUrl=function(T){if(typeof T=="string")return Promise.resolve(T);if(typeof T=="function"){var S=T();if(typeof S=="string")return Promise.resolve(S);if(S.then)return S}throw Error("Invalid URL")},A.prototype._connect=function(){var T=this;if(!this._connectLock&&this._shouldReconnect){this._connectLock=!0;var S=this._options,R=S.maxRetries,g=R===void 0?N.maxRetries:R,U=S.connectionTimeout,z=U===void 0?N.connectionTimeout:U,X=S.WebSocket,B=X===void 0?G():X;if(this._retryCount>=g)this._debug("max retries reached",this._retryCount,">=",g);else{if(this._retryCount++,this._debug("connect",this._retryCount),this._removeListeners(),(ne=B)===void 0||!ne||ne.CLOSING!==2)throw Error("No valid WebSocket class provided");var ne;this._wait().then((function(){return T._getNextUrl(T._url)})).then((function(fe){T._closeCalled?T._connectLock=!1:(T._debug("connect",{url:fe,protocols:T._protocols}),T._ws=T._protocols?new B(fe,T._protocols):new B(fe),T._ws.binaryType=T._binaryType,T._connectLock=!1,T._addListeners(),T._connectTimeout=setTimeout((function(){return T._handleTimeout()}),z))})).catch((function(fe){T._connectLock=!1,T._handleError(new p(Error(fe.message),T))}))}}},A.prototype._handleTimeout=function(){this._debug("timeout event"),this._handleError(new p(Error("TIMEOUT"),this))},A.prototype._disconnect=function(T,S){if(T===void 0&&(T=1e3),this._clearTimeouts(),this._ws){this._removeListeners();try{this._ws.close(T,S),this._handleClose(new k(T,S,this))}catch{}}},A.prototype._acceptOpen=function(){this._debug("accept open"),this._retryCount=0},A.prototype._callEventListener=function(T,S){"handleEvent"in S?S.handleEvent(T):S(T)},A.prototype._removeListeners=function(){this._ws&&(this._debug("removeListeners"),this._ws.removeEventListener("open",this._handleOpen),this._ws.removeEventListener("close",this._handleClose),this._ws.removeEventListener("message",this._handleMessage),this._ws.removeEventListener("error",this._handleError))},A.prototype._addListeners=function(){this._ws&&(this._debug("addListeners"),this._ws.addEventListener("open",this._handleOpen),this._ws.addEventListener("close",this._handleClose),this._ws.addEventListener("message",this._handleMessage),this._ws.addEventListener("error",this._handleError))},A.prototype._clearTimeouts=function(){clearTimeout(this._connectTimeout),clearTimeout(this._uptimeTimeout)},A})()},441:(_,f)=>{var o;(o=f.p||(f.p={})).CHAT_WINDOW_EVENT="chatWindowEvent",o.REGISTER="register"},154:(_,f)=>{var o,m;(m=f.YU||(f.YU={})).SENDER_TYPING_STARTED="SenderTypingStarted",m.SENDER_TYPING_ENDED="SenderTypingEnded",m.LOAD_MORE_MESSAGES="LoadMoreMessages",m.RECOVER_LIVECHAT="RecoverLivechat",m.RECOVER_THREAD="RecoverThread",m.SEND_MESSAGE="SendMessage",m.SEND_OUTBOUND="SendOutbound",m.SEND_OFFLINE_MESSAGE="SendOfflineMessage",m.SEND_PAGE_VIEWS="SendPageViews",m.SEND_CONSUMER_CUSTOM_FIELDS="SetConsumerCustomFields",m.SET_CONSUMER_CONTACT_CUSTOM_FIELD="SetConsumerContactCustomFields",m.MESSAGE_SEEN="MessageSeenByConsumer",m.SEND_TRANSCRIPT="SendTranscript",m.FETCH_THREAD_LIST="FetchThreadList",m.END_CONTACT="EndContact",m.EXECUTE_TRIGGER="ExecuteTrigger",m.AUTHORIZE_CONSUMER="AuthorizeConsumer",m.AUTHORIZE_CUSTOMER="AuthorizeCustomer",m.RECONNECT_CONSUMER="ReconnectConsumer",m.UPDATE_THREAD="UpdateThread",m.ARCHIVE_THREAD="ArchiveThread",m.LOAD_THREAD_METADATA="LoadThreadMetadata",m.REFRESH_TOKEN="RefreshToken",m.STORE_VISITOR="StoreVisitor",m.STORE_VISITOR_EVENTS="StoreVisitorEvents",m.CREATE_GROUP_CHAT_INVITE="CreateInvitationToGroupChat",m.SEND_EMAIL_INVITE_TO_GROUP_CHAT="SendEmailInvitationToGroupChat",m.JOIN_GROUP_CHAT="JoinGroupChat",m.LEAVE_GROUP_CHAT="LeaveGroupChat",m.GENERATE_AUTHORIZATION_TOKEN="GenerateAuthorizationToken",m.ADD_VISITOR_TAGS="AddVisitorTags",m.REMOVE_VISITOR_TAGS="RemoveVisitorTags",m.SEND_MESSAGE_PREVIEW="SendMessagePreview",(o=f.Ne||(f.Ne={})).LIVECHAT_RECOVERED="LivechatRecovered",o.MORE_MESSAGES_LOADED="MoreMessagesLoaded",o.OFFLINE_MESSAGE_SENT="OfflineMessageSent",o.THREAD_LIST_FETCHED="ThreadListFetched",o.THREAD_RECOVERED="ThreadRecovered",o.TRANSCRIPT_SENT="TranscriptSent",o.CONSUMER_AUTHORIZED="ConsumerAuthorized",o.THREAD_METADATA_LOADED="ThreadMetadataLoaded",o.SET_POSITION_IN_QUEUE="SetPositionInQueue",o.GROUP_CHAT_INVITE_CREATED="InvitationToGroupChatCreated",o.GROUP_CHAT_INVITE_SENT="EmailInvitationToGroupChatSent",o.GROUP_CHAT_JOINED="GroupChatJoined",o.TOKEN_REFRESHED="TokenRefreshed",o.AUTHORIZATION_TOKEN_GENERATED="AuthorizationTokenGenerated",o.THREAD_ARCHIVED="ThreadArchived"},58:(_,f)=>{var o;(o=f.Yi||(f.Yi={})).DESKTOP="desktop",o.MOBILE="mobile",o.OTHER="other",o.TABLET="tablet",(f.vQ||(f.vQ={})).BROWSER="browser"},880:(_,f,o)=>{var m=o(256);f.P=m.CaseStatus},354:(_,f)=>{f.GO="X-Caller-Service-ID"},510:(_,f)=>{var o;(o=f.T||(f.T={})).INBOUND="inbound",o.OUTBOUND="outbound"},115:(_,f)=>{var o;(o=f.C||(f.C={})).TEXT="TEXT",o.FILE="FILE",o.FORM="FORM",o.PLUGIN="PLUGIN",o.POSTBACK="POSTBACK",o.QUICK_REPLIES="QUICK_REPLIES",o.RICH_LINK="RICH_LINK",o.LIST_PICKER="LIST_PICKER",o.ADAPTIVE_CARD="ADAPTIVE_CARD",o.TIME_PICKER="TIME_PICKER"},256:(_,f)=>{var o;Object.defineProperty(f,"__esModule",{value:!0}),(o=f.CaseStatus||(f.CaseStatus={})).NEW="new",o.OPEN="open",o.PENDING="pending",o.ESCALATED="escalated",o.RESOLVED="resolved",o.CLOSED="closed",o.TRASHED="trashed"},403:(_,f)=>{var o;(o=f.m||(f.m={})).AUTHORIZE_CONSUMER="AuthorizeConsumer",o.CASE_CREATED="CaseCreated",o.CASE_INBOX_ASSIGNEE_CHANGED="CaseInboxAssigneeChanged",o.CASE_STATUS_CHANGED="CaseStatusChanged",o.CASE_TO_ROUTING_QUEUE_ASSIGNMENT_CHANGED="CaseToRoutingQueueAssignmentChanged",o.CONTACT_CREATED="CaseCreated",o.ASSIGNED_AGENT_CHANGED="CaseInboxAssigneeChanged",o.CONTACT_STATUS_CHANGED="CaseStatusChanged",o.CONTACT_TO_ROUTING_QUEUE_ASSIGNMENT_CHANGED="CaseToRoutingQueueAssignmentChanged",o.CONTACT_PREFERRED_USER_CHANGED="ContactPreferredUserChanged",o.CONTACT_PROFICIENCY_CHANGED="ContactProficiencyChanged",o.CONTACT_PRIORITY_CHANGED="ContactPriorityChanged",o.CONTACT_SYNC="ContactSync",o.CHANNEL_CREATED="ChannelCreated",o.CHANNEL_DELETED="ChannelDeleted",o.CHANNEL_UPDATED="ChannelUpdated",o.MESSAGE_ADDED_INTO_CASE="MessageAddedIntoCase",o.MESSAGE_CREATED="MessageCreated",o.MESSAGE_DELIVERED_TO_END_USER="MessageDeliveredToEndUser",o.MESSAGE_DELIVERED_TO_USER="MessageDeliveredToUser",o.MESSAGE_NOTE_CREATED="MessageNoteCreated",o.MESSAGE_NOTE_UPDATED="MessageNoteUpdated",o.MESSAGE_NOTE_DELETED="MessageNoteDeleted",o.MESSAGE_READ_CHANGED="MessageReadChanged",o.MESSAGE_SEEN_BY_END_USER="MessageSeenByEndUser",o.MESSAGE_SEEN_BY_USER="MessageSeenByUser",o.MESSAGE_SENT="MessageSent",o.MESSAGE_UPDATED="MessageUpdated",o.PAGE_VIEW_CREATED="PageViewCreated",o.ROUTING_QUEUE_CREATED="RoutingQueueCreated",o.ROUTING_QUEUE_DELETED="RoutingQueueDeleted",o.ROUTING_QUEUE_UPDATED="RoutingQueueUpdated",o.SUBQUEUE_ASSIGNED_TO_ROUTING_QUEUE="SubqueueAssignedToRoutingQueue",o.SUBQUEUE_UNASSIGNED_TO_ROUTING_QUEUE="SubqueueUnassignedFromRoutingQueue",o.USER_ASSIGNED_TO_ROUTING_QUEUE="UserAssignedToRoutingQueue",o.USER_STATUS_CHANGED="UserStatusChanged",o.USER_UNASSIGNED_FROM_ROUTING_QUEUE="UserUnassignedFromRoutingQueue",o.AGENT_CONTACT_STARTED="AgentContactStarted",o.AGENT_CONTACT_ENDED="AgentContactEnded",o.SENDER_TYPING_STARTED="SenderTypingStarted",o.SENDER_TYPING_ENDED="SenderTypingEnded",o.FIRE_PROACTIVE="FireProactiveAction",o.CONTACT_INBOX_PRE_ASSIGNEE_CHANGED="ConsumerContactInboxPreAssigneeChanged",o.CONTACT_RECIPIENTS_CHANGED="ContactRecipientsChanged",o.MESSAGE_PREVIEW_CREATED="MessagePreviewCreated",o.EVENT_IN_S3="EventInS3"},585:_=>{_.exports=i},459:_=>{_.exports=r}},d={};function E(_){var f=d[_];if(f!==void 0)return f.exports;var o=d[_]={exports:{}};return c[_].call(o.exports,o,o.exports,E),o.exports}E.n=_=>{var f=_&&_.__esModule?()=>_.default:()=>_;return E.d(f,{a:f}),f},E.d=(_,f)=>{for(var o in f)E.o(f,o)&&!E.o(_,o)&&Object.defineProperty(_,o,{enumerable:!0,get:f[o]})},E.o=(_,f)=>Object.prototype.hasOwnProperty.call(_,f),E.r=_=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(_,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(_,"__esModule",{value:!0})};var j={};return(()=>{E.r(j),E.d(j,{AbortError:()=>Cn,AbortablePromise:()=>Be,AuthorizationError:()=>k,ChatEvent:()=>W,ChatSdk:()=>An,ContactStatus:()=>un.P,Customer:()=>ie,EnvironmentName:()=>pe,LivechatThread:()=>gn,MessageType:()=>Fe.C,SendMessageFailedError:()=>dt,Thread:()=>Mt,ThreadRecoverFailedError:()=>kt,UploadAttachmentError:()=>Ut,WebSocketClientError:()=>ht,WebSocketClientEvent:()=>f.xT,createCreateInvitationToGroupChatPayloadData:()=>yr,createJoinGroupChatPayloadData:()=>Nr,createLeaveGroupChatPayloadData:()=>Dr,createReconnectPayloadData:()=>nn,createSendEmailInvitationToGroupChatPayloadData:()=>Ur,default:()=>xr,generateId:()=>G.v4,getAuthor:()=>_r,isAgentTypingEndedEvent:()=>pr,isAgentTypingStartedEvent:()=>vr,isAssignedAgentChangedEvent:()=>Er,isAuthSuccessEvent:()=>rn,isContactCreatedEvent:()=>dn,isContactRecipientsChangedEvent:()=>cr,isContactStatusChangedEvent:()=>ln,isContactToRoutingQueueAssignmentChangedEvent:()=>ar,isCustomerReconnectSuccessPayloadData:()=>Mr,isLoadMetadataSuccessPayload:()=>En,isMessage:()=>gr,isMessageCreatedEvent:()=>Tr,isMessageReadChangedEvent:()=>wr,isMessageSentEvent:()=>br,isMoreMessagesLoadedEvent:()=>vt,isRecoverSuccessEvent:()=>Ae,isSetPositionInQueueEvent:()=>Cr,isThreadArchivedSuccessPayload:()=>vn,isThreadListFetchedPostbackData:()=>Tn,isTokenRefreshedSuccessResponse:()=>on,sendChatEvent:()=>Y,sendCreateInvitationToGroupChatEvent:()=>Sr,sendEmailInvitationToGroupChatEvent:()=>kr,sendJoinGroupChatEvent:()=>Ir,sendLeaveGroupChatEvent:()=>Rr,splitName:()=>Jt});var _,f=E(455),o=E(441),m=E(154);(function(t){t.ACCESS_TOKEN="ACCESS_TOKEN",t.ACCESS_TOKEN_EXPIRES_IN="ACCESS_TOKEN_EXPIRES_IN",t.APP_NAME="APP_NAME",t.APP_VERSION="APP_VERSION",t.AUTHORIZATION_CODE="AUTHORIZATION_CODE",t.BRAND_ID="BRAND_ID",t.CHANNEL_ID="CHANNEL_ID",t.CUSTOMER_ID="CUSTOMER_ID",t.CUSTOMER_IMAGE="CUSTOMER_IMAGE",t.CUSTOMER_NAME="CUSTOMER_NAME",t.ENDPOINT_CHAT="ENDPOINT_CHAT",t.ENDPOINT_GATEWAY="ENDPOINT_GATEWAY",t.THREAD_DATA="THREAD_DATA"})(_||(_={}));const u=new class{constructor(){this._vars={}}set(t,e){this._vars[t]=e}get(t,e){var n;return(n=this._vars[t])!==null&&n!==void 0?n:e}list(){return Object.keys(this._vars)}clear(){this._vars={}}},b=function(t){return t===null};function h(t){u.set(_.ACCESS_TOKEN,t.token),u.set(_.ACCESS_TOKEN_EXPIRES_IN,String(t.expiresIn))}function v(){const t=u.get(_.ACCESS_TOKEN,null),e=u.get(_.ACCESS_TOKEN_EXPIRES_IN,null);return b(t)||b(e)?null:{token:t,expiresIn:Number(e)}}class p extends Error{constructor(e,n){super(),this.name="ChatSDKError",this.message=`[ChatSDKError]: ${this._getErrorMessage(e)}`,this.data=n}_getErrorMessage(e){return e instanceof Error?e.message:typeof e=="string"?e:JSON.stringify(e)}}class k extends p{constructor(e,n){super(e,n),n!==void 0&&(this.message=`${e} because of (${n.errorMessage})`)}}var G=E(459);function N(t){return{visitor:{id:t}}}var O=Object.prototype;const A=function(t){var e=t&&t.constructor;return t===(typeof e=="function"&&e.prototype||O)},T=(S=Object.keys,R=Object,function(t){return S(R(t))});var S,R,g=Object.prototype.hasOwnProperty;const U=typeof tt=="object"&&tt&&tt.Object===Object&&tt;var z=typeof self=="object"&&self&&self.Object===Object&&self;const X=U||z||Function("return this")(),B=X.Symbol;var ne=Object.prototype,fe=ne.hasOwnProperty,Me=ne.toString,me=B?B.toStringTag:void 0,nt=Object.prototype.toString,xe=B?B.toStringTag:void 0;const ge=function(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":xe&&xe in Object(t)?(function(e){var n=fe.call(e,me),l=e[me];try{e[me]=void 0;var C=!0}catch{}var w=Me.call(e);return C&&(n?e[me]=l:delete e[me]),w})(t):(function(e){return nt.call(e)})(t)},$e=function(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")},Oe=function(t){if(!$e(t))return!1;var e=ge(t);return e=="[object Function]"||e=="[object GeneratorFunction]"||e=="[object AsyncFunction]"||e=="[object Proxy]"},we=X["__core-js_shared__"];var ze,Ne=(ze=/[^.]+$/.exec(we&&we.keys&&we.keys.IE_PROTO||""))?"Symbol(src)_1."+ze:"",Ye=Function.prototype.toString;const ve=function(t){if(t!=null){try{return Ye.call(t)}catch{}try{return t+""}catch{}}return""};var rt=/^\[object .+?Constructor\]$/,it=Function.prototype,ot=Object.prototype,yt=it.toString,Ge=ot.hasOwnProperty,st=RegExp("^"+yt.call(Ge).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const Ie=function(t){return!(!$e(t)||(function(e){return!!Ne&&Ne in e})(t))&&(Oe(t)?st:rt).test(ve(t))},De=function(t,e){var n=(function(l,C){return l==null?void 0:l[C]})(t,e);return Ie(n)?n:void 0},Re=De(X,"DataView"),Te=De(X,"Map"),Pe=De(X,"Promise"),We=De(X,"Set"),Le=De(X,"WeakMap");var Qe="[object Map]",le="[object Promise]",be="[object Set]",Ue="[object WeakMap]",H="[object DataView]",$=ve(Re),x=ve(Te),K=ve(Pe),_e=ve(We),Ee=ve(Le),F=ge;(Re&&F(new Re(new ArrayBuffer(1)))!=H||Te&&F(new Te)!=Qe||Pe&&F(Pe.resolve())!=le||We&&F(new We)!=be||Le&&F(new Le)!=Ue)&&(F=function(t){var e=ge(t),n=e=="[object Object]"?t.constructor:void 0,l=n?ve(n):"";if(l)switch(l){case $:return H;case x:return Qe;case K:return le;case _e:return be;case Ee:return Ue}return e});const M=F,de=function(t){return t!=null&&typeof t=="object"},je=function(t){return de(t)&&ge(t)=="[object Arguments]"};var Ke=Object.prototype,jn=Ke.hasOwnProperty,Hn=Ke.propertyIsEnumerable;const Fn=je((function(){return arguments})())?je:function(t){return de(t)&&jn.call(t,"callee")&&!Hn.call(t,"callee")},Bn=Array.isArray,Vt=function(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=9007199254740991};var $t=a&&!a.nodeType&&a,zt=$t&&!0&&s&&!s.nodeType&&s,Yt=zt&&zt.exports===$t?X.Buffer:void 0;const Vn=(Yt?Yt.isBuffer:void 0)||function(){return!1};var Z={};Z["[object Float32Array]"]=Z["[object Float64Array]"]=Z["[object Int8Array]"]=Z["[object Int16Array]"]=Z["[object Int32Array]"]=Z["[object Uint8Array]"]=Z["[object Uint8ClampedArray]"]=Z["[object Uint16Array]"]=Z["[object Uint32Array]"]=!0,Z["[object Arguments]"]=Z["[object Array]"]=Z["[object ArrayBuffer]"]=Z["[object Boolean]"]=Z["[object DataView]"]=Z["[object Date]"]=Z["[object Error]"]=Z["[object Function]"]=Z["[object Map]"]=Z["[object Number]"]=Z["[object Object]"]=Z["[object RegExp]"]=Z["[object Set]"]=Z["[object String]"]=Z["[object WeakMap]"]=!1;var Wt=a&&!a.nodeType&&a,qe=Wt&&!0&&s&&!s.nodeType&&s,St=qe&&qe.exports===Wt&&U.process,Qt=(function(){try{return qe&&qe.require&&qe.require("util").types||St&&St.binding&&St.binding("util")}catch{}})(),Kt=Qt&&Qt.isTypedArray;const $n=Kt?(function(t){return function(e){return t(e)}})(Kt):function(t){return de(t)&&Vt(t.length)&&!!Z[ge(t)]};var zn=Object.prototype.hasOwnProperty;const ke=function(t){if(t==null)return!0;if((function(l){return l!=null&&Vt(l.length)&&!Oe(l)})(t)&&(Bn(t)||typeof t=="string"||typeof t.splice=="function"||Vn(t)||$n(t)||Fn(t)))return!t.length;var e=M(t);if(e=="[object Map]"||e=="[object Set]")return!t.size;if(A(t))return!(function(l){if(!A(l))return T(l);var C=[];for(var w in Object(l))g.call(l,w)&&w!="constructor"&&C.push(w);return C})(t).length;for(var n in t)if(zn.call(t,n))return!1;return!0},at=new Map,qt=async(t,e)=>{if(b(e))throw new p("WebSocketClient is not initialized");return ke(t.eventId)&&(t.eventId=(0,G.v4)()),new Promise((n=>{at.set(t.eventId,n),e==null||e.send(t)}))};function Jt(t){const[e,...n]=t.split(" ");return[e,n.join(" ")]}function Ot(t,e={}){for(const n of Object.keys(e))t.set(n,e[n])}function Nt(t,e=[]){for(const{ident:n,value:l}of e)t.set(n,l)}function Xt(t){return Object.fromEntries(t)}function ct(t){return Array.from(t).map((([e,n])=>({ident:e,value:n})))}class ie{constructor(e,n,l,C){this._customFields=new Map,this._exists=!1,this._websocketClient=C,ie.setId(e),ie.setName(n),l&&ie.setImage(l)}static setId(e){u.set(_.CUSTOMER_ID,e)}static getId(){return u.get(_.CUSTOMER_ID,null)}static getName(){return u.get(_.CUSTOMER_NAME)}static setName(e){u.set(_.CUSTOMER_NAME,e)}static getIdOrCreateNewOne(){let e=this.getId();return e||(e=(0,G.v4)(),this.setId(e)),e}static getImage(){return u.get(_.CUSTOMER_IMAGE)}static setImage(e){u.set(_.CUSTOMER_IMAGE,e)}getId(){return ie.getIdOrCreateNewOne()}getName(){return ie.getName()}setName(e){ie.setName(e)}setImage(e){ie.setImage(e)}setExists(e){this._exists=e}setCustomField(e,n){return this.setCustomFields({[e]:n})}setCustomFields(e){if(Ot(this._customFields,e),this._exists)return this.sendCustomFields()}getCustomFields(){return Xt(this._customFields)}setCustomFieldsFromArray(e){Nt(this._customFields,e)}getCustomFieldsArray(){return ct(this._customFields)}async sendCustomFields(){var e;return Y((e=ct(this._customFields),{eventType:m.YU.SEND_CONSUMER_CUSTOM_FIELDS,data:{customFields:e}}),this._websocketClient)}}function Zt(t,e){const n=ie.getName(),l=ie.getImage();let C={};if(typeof n=="string"&&n.length>0){const[w,y]=Jt(n);C={firstName:w,lastName:y}}return l&&(C.image=l),Object.assign({idOnExternalPlatform:ie.getIdOrCreateNewOne()},C)}const Ce=function(t){return t==null};function It(){const t=parseInt(u.get(_.BRAND_ID)),e=u.get(_.CHANNEL_ID);if(Ce(t)||isNaN(t)||Ce(e))throw new p(`Cannot get BrandId and ChannelId from SDKVariableStorage 
      brandId (${t}) |
      channelId (${e})`);return{brandId:t,channelId:e}}const oe=function(t){return t===void 0};function en(t){const{eventType:e,data:n,consumerIdentity:l=Zt(),destination:C={},visitor:w={}}=t,{brandId:y,channelId:D}=It();if(oe(e))throw new p(`Cannot create an event payload because of missing eventType (${e})`);return{eventType:e,brand:{id:Number(y)},channel:{id:D},consumerIdentity:l,data:n,destination:C,visitor:w}}function tn(t,e=(0,G.v4)(),n=o.p.CHAT_WINDOW_EVENT){return{action:n,eventId:e,payload:t}}async function Y(t,e){const n=tn(en(t));return qt(n,e)}function nn(t,e){return Object.assign(Object.assign(Object.assign({},N(e)),Zt()),{eventType:m.YU.RECONNECT_CONSUMER,data:{accessToken:{token:t.token}}})}let Dt=null;function Rt(t,e){Dt!==null&&clearTimeout(Dt),Dt=setTimeout(e,1e3*(function(n){const l=Math.round(.9*n);return l<20?20:l})(t.expiresIn))}const rn=t=>{var e;const n=(e=t==null?void 0:t.data)===null||e===void 0?void 0:e.status;return(t==null?void 0:t.type)===m.Ne.CONSUMER_AUTHORIZED&&n==="success"};function on(t){var e,n;return(t==null?void 0:t.type)===m.Ne.TOKEN_REFRESHED&&((n=(e=t.data)===null||e===void 0?void 0:e.accessToken)===null||n===void 0?void 0:n.token)!==void 0}var pe;(function(t){t.AU1="AU1",t.CA1="CA1",t.EU1="EU1",t.JP1="JP1",t.NA1="NA1",t.UK1="UK1",t.custom="custom"})(pe||(pe={}));var He=E(403);const W=Object.assign(Object.assign(Object.assign({},He.m),m.Ne),{AGENT_TYPING_STARTED:"AgentTypingStarted",AGENT_TYPING_ENDED:"AgentTypingEnded",ASSIGNED_AGENT_CHANGED:"AssignedAgentChanged",CONTACT_CREATED:"ContactCreated",CONTACT_STATUS_CHANGED:"ContactStatusChanged",CONTACT_TO_ROUTING_QUEUE_ASSIGNMENT_CHANGED:"ContactToRoutingQueueAssignmentChanged"});class Yn extends CustomEvent{}class Wn{constructor(){this.middlewares=[]}register(e){this.middlewares.push(e)}process(e){if(Ce(e))return null;let n=e;for(const l of this.middlewares){if(n===null)return null;n=l(n)}return n}}const Qn=EventTarget;function sn(t){return!Ce(t==null?void 0:t.user)}var ut=E(910),an=function(t,e){var n={};for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&e.indexOf(l)<0&&(n[l]=t[l]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function"){var C=0;for(l=Object.getOwnPropertySymbols(t);C<l.length;C++)e.indexOf(l[C])<0&&Object.prototype.propertyIsEnumerable.call(t,l[C])&&(n[l[C]]=t[l[C]])}return n};const Kn={id:"",data:null,type:void 0,createdAt:new Date};function lt(t){var e;if(!(w=>"eventId"in w)(t))return Kn;if((w=>"error"in w)(t))return{createdAt:(0,ut.Nf)((e=t.createdAt)!==null&&e!==void 0?e:new Date().toString()),data:null,error:t.error,id:t.eventId};const n=(w=>"eventType"in w)(t)?t.eventType:void 0;if((w=>"data"in w)(t))return{createdAt:(0,ut.Nf)(t.createdAt),context:t.context,data:t.data,id:t.eventId,type:n};if((w=>{const y=w==null?void 0:w.postback;return ke(y)===!1})(t)){const{postback:{data:w,eventType:y},eventId:D}=t,P=an(t,["postback","eventId"]);return{type:y,data:Object.assign(Object.assign({},P),w),createdAt:(0,ut.Nf)(t.createdAt),id:D}}const{eventId:l}=t,C=an(t,["eventId"]);return Object.assign(Object.assign({data:void 0},C),{id:l,type:n,createdAt:(0,ut.Nf)(t.createdAt)})}const cn={[W.SENDER_TYPING_STARTED]:function(t){return sn(t.data)?Object.assign(Object.assign({},t),{type:W.AGENT_TYPING_STARTED}):t},[W.SENDER_TYPING_ENDED]:function(t){return sn(t.data)?Object.assign(Object.assign({},t),{type:W.AGENT_TYPING_ENDED}):t},[W.CASE_INBOX_ASSIGNEE_CHANGED]:function(t){return Object.assign(Object.assign({},t),{type:W.ASSIGNED_AGENT_CHANGED})},[W.CASE_CREATED]:function(t){return Object.assign(Object.assign({},t),{type:W.CONTACT_CREATED})},[W.CASE_STATUS_CHANGED]:function(t){return Object.assign(Object.assign({},t),{type:W.CONTACT_STATUS_CHANGED})},[W.CASE_TO_ROUTING_QUEUE_ASSIGNMENT_CHANGED]:function(t){return Object.assign(Object.assign({},t),{type:W.CONTACT_TO_ROUTING_QUEUE_ASSIGNMENT_CHANGED})},[W.LIVECHAT_RECOVERED]:function(t){const e=t.data.contactHistory.map(lt);return Object.assign(Object.assign({},t),{data:Object.assign(Object.assign({},t.data),{contactHistory:e})})},[W.THREAD_RECOVERED]:function(t){const e=t.data.contactHistory.map(lt);return Object.assign(Object.assign({},t),{data:Object.assign(Object.assign({},t.data),{contactHistory:e})})}};function qn(t){return t.type&&cn[t.type]!==void 0?cn[t.type](t):t}function Pt(t){const e=oe(t==null?void 0:t.id)===!1;return oe(t.error)!==!1&&e}class dt extends p{}var Fe=E(115),Jn=E(893),Xn=E(415);class ht extends Error{constructor(e,n=""){super(`[WebSocketClientError]: ${e}${n?` (${n})`:""}`),this.name="WebSocketClientError"}}class Zn{constructor(e,n,l,C,w){this.brandId=e,this.channelId=n,this.customerId=l,this.options=C,this.onError=w,this._connection=null,this.connect()}connect(){var e,n,l,C,w,y,D,P,I,L,V,q;const Q=!((e=this.options)===null||e===void 0)&&e.port?`:${(n=this.options)===null||n===void 0?void 0:n.port}`:"",ee=!((l=this.options)===null||l===void 0)&&l.host?`${(C=this.options)===null||C===void 0?void 0:C.host}${Q}`:"",he=(y=(w=this.options)===null||w===void 0?void 0:w.prefix)!==null&&y!==void 0?y:"",Ve=(P=(D=this.options)===null||D===void 0?void 0:D.forceSecureProtocol)===null||P===void 0||P,Je=(function(pt,mt,Ze,et,xt){const _t={brandId:Ze,channelId:et,consumerId:xt,v:u.get(_.APP_VERSION)};return`${pt}/${mt}?${(0,Jn.P)(_t)}`})(ee,he,this.brandId,this.channelId,this.customerId);this._connection=(0,Xn.setupSocketConnection)(Je,{startClosed:!0,forceSecureProtocol:Ve});const Xe=this._errorHandler.bind(this);(I=this._connection)===null||I===void 0||I.addEventListener(f.xT.CLOSE,Xe),(L=this._connection)===null||L===void 0||L.addEventListener(f.xT.ERROR,Xe),(q=(V=this._connection)===null||V===void 0?void 0:V.socket)===null||q===void 0||q.reconnect()}disconnect(){var e;(e=this._connection)===null||e===void 0||e.socket.close()}reconnect(){var e;(e=this._connection)===null||e===void 0||e.socket.reconnect()}send(e){var n;const l=JSON.stringify(e);(n=this._connection)===null||n===void 0||n.send(l)}on(e,n){var l;(l=this._connection)===null||l===void 0||l.addEventListener(e,n)}off(e,n){var l;(l=this._connection)===null||l===void 0||l.removeEventListener(e,n)}_errorHandler(e){const n=e.detail;let l;if(n instanceof ErrorEvent&&(l=new ht("Connection error",n.message)),n instanceof CloseEvent&&(l=new ht("Connection closed",n.reason)),l===void 0&&(l=new ht("Unknown error",n.type)),typeof this.onError!="function")throw l;this.onError(l)}}var un=E(880),er=E(585),tr=E.n(er),ft=E(58);const nr=()=>navigator.language,rr=()=>Intl.DateTimeFormat().resolvedOptions().timeZone;function ir(t){switch(t){case"mobile":return ft.Yi.MOBILE;case"tablet":return ft.Yi.TABLET;default:return ft.Yi.DESKTOP}}const Et=(t={})=>{var e,n,l,C;const w=new(tr())(navigator.userAgent),{country:y="",location:D=rr(),language:P=nr(),ip:I=null}=t;return{browser:(e=w.getBrowser().name)!==null&&e!==void 0?e:null,browserVersion:(n=w.getBrowser().version)!==null&&n!==void 0?n:null,country:y,ip:I,language:P,location:D,os:(l=w.getOS().name)!==null&&l!==void 0?l:null,osVersion:(C=w.getOS().version)!==null&&C!==void 0?C:null,deviceType:ir(w.getDevice().type),applicationType:ft.vQ.BROWSER}};var or=E(354);class Ut extends p{}const sr=async(t,e,n)=>{const l=await(async y=>{const D=await(function(P){return new Promise(((I,L)=>{const V=new FileReader;V.onloadend=()=>{I(V)},V.onerror=q=>{var Q,ee;return L((ee=(Q=q.target)===null||Q===void 0?void 0:Q.error)===null||ee===void 0?void 0:ee.message)},V.readAsDataURL(P)}))})(y);if(D.error!==null)throw new p(`Cannot create payload for attachment upload because of error (${D.error.message})`);if(typeof D.result!="string")throw new p(`Cannot create payload for attachment upload because of missing:
      reader result (${D.result})`);return{url:D.result,name:y.name,mimeType:y.type}})(t),C=await(async function(y,D,P){const I=u.get(_.ENDPOINT_CHAT),{url:L,name:V,mimeType:q}=P,Q={content:L.split(";base64,")[1],fileName:V,mimeType:q},ee=await fetch(`${I}/chat/1.0/brand/${y}/channel/${D}/attachment`,{method:"POST",body:JSON.stringify(Q),headers:{"Content-Type":"application/json",[or.GO]:u.get(_.APP_NAME)}});if(!ee.ok)throw new p(`Failed to upload Attachments. Status (${ee.status})`);return ee.json()})(e,n,l);if(oe((w=C)==null?void 0:w.fileUrl)===!1)return{url:C.fileUrl,friendlyName:l.name};var w;throw(function(y){return oe(y==null?void 0:y.allowedFileSize)===!1})(C)?new Ut("Upload attachment failed",C):new p(`Unknown file upload response (${C})`)};function ln(t){var e,n;return t.type===W.CONTACT_STATUS_CHANGED&&((n=(e=t.data)===null||e===void 0?void 0:e.case)===null||n===void 0?void 0:n.id)!==void 0}function dn(t){var e,n;return t.type===W.CONTACT_CREATED&&((n=(e=t.data)===null||e===void 0?void 0:e.case)===null||n===void 0?void 0:n.id)!==void 0}function ar(t){var e,n;return t.type===W.CONTACT_TO_ROUTING_QUEUE_ASSIGNMENT_CHANGED&&((n=(e=t.data)===null||e===void 0?void 0:e.case)===null||n===void 0?void 0:n.id)!==void 0}function cr(t){return t.type===He.m.CONTACT_RECIPIENTS_CHANGED}const hn=(t,e,n,l=Et())=>({messageContent:t,browserFingerprint:l,idOnExternalPlatform:e,thread:{idOnExternalPlatform:n},consumer:{customFields:[]},consumerContact:{customFields:[]},attachments:[]});function vt(t){var e;return t.type===m.Ne.MORE_MESSAGES_LOADED&&((e=t==null?void 0:t.data)===null||e===void 0?void 0:e.messages)!==void 0}const fn=t=>({eventType:m.YU.LOAD_MORE_MESSAGES,data:t});class ur extends p{}class lr extends p{}const En=t=>t.type===m.Ne.THREAD_METADATA_LOADED&&t.data.lastMessage!==void 0,Ae=t=>{const e=t.data,n=oe(e)===!1,l=oe(e==null?void 0:e.messages)===!1,C=t.type===m.Ne.THREAD_RECOVERED||t.type===m.Ne.LIVECHAT_RECOVERED,w=oe(t.error);return n&&l&&w&&C};function vn(t){return t.type===m.Ne.THREAD_ARCHIVED}class pn extends p{}function mn(t){const e={eventType:m.YU.RECOVER_THREAD,data:{}};return t===void 0?e:Object.assign(Object.assign({},e),{data:{thread:{idOnExternalPlatform:t}}})}class dr extends p{}class kt extends p{}class Mt{constructor(e,n,l,C,w={},y=!1){this._exists=!1,this._typingTimeoutID=void 0,this._isAuthorizationEnabled=!1,this._customFields=new Map,this._typingPreviewText="",this.idOnExternalPlatform=e,this._websocketClient=n,this._messageEmitter=l,this._customer=C,this._isAuthorizationEnabled=y,Ot(this._customFields,w),this._registerEventHandlers()}async recover(){const e=await Y(mn(this.idOnExternalPlatform),this._websocketClient);if(Ae(e)){const n=e.data,{contact:l,consumerContact:C}=n,w=(function(y,D){var P={};for(var I in y)Object.prototype.hasOwnProperty.call(y,I)&&D.indexOf(I)<0&&(P[I]=y[I]);if(y!=null&&typeof Object.getOwnPropertySymbols=="function"){var L=0;for(I=Object.getOwnPropertySymbols(y);L<I.length;L++)D.indexOf(I[L])<0&&Object.prototype.propertyIsEnumerable.call(y,I[L])&&(P[I[L]]=y[I[L]])}return P})(n,["contact","consumerContact"]);return Object.assign(Object.assign({},w),{contact:l??C})}throw new kt("Thread recover fail",e)}async sendMessage(e){return(async(n,l)=>{const C=(w=n,{eventType:m.YU.SEND_MESSAGE,data:w});var w;const y=await Y(C,l);if(Pt(y))return y;throw new dt("Send message failed",y)})(this._mergeCustomFieldsAndAccessTokenWithMessageData(e,!1),this._websocketClient)}async sendTextMessage(e,n={}){const{messageId:l=(0,G.v4)(),browserFingerprint:C=Et()}=n,w=(function(D){return{payload:{text:D},type:Fe.C.TEXT}})(e),y=hn(w,l,this.idOnExternalPlatform,C);return this.sendMessage(y)}async sendPostbackMessage(e,n,l={}){const{messageId:C=(0,G.v4)(),browserFingerprint:w=Et()}=l,y=(function(P,I){return{payload:{text:I,postback:P},postback:P,type:Fe.C.TEXT}})(e,n),D=hn(y,C,this.idOnExternalPlatform,w);return this.sendMessage(D)}async sendOutboundMessage(e){return(async(n,l)=>{const C=(w=n,{eventType:m.YU.SEND_OUTBOUND,data:w});var w;const y=await Y(C,l);if(Pt(y))return y;throw new dt("Send Outbound message failed",y)})(this._mergeCustomFieldsAndAccessTokenWithMessageData(e,!0),this._websocketClient)}async loadMoreMessages(){var e;const{scrollToken:n,oldestMessageDatetime:l}=(e=JSON.parse(u.get(_.THREAD_DATA,"{}")))!==null&&e!==void 0?e:{};if(ke(n))return null;const C={scrollToken:n,oldestMessageDatetime:l,thread:{idOnExternalPlatform:this.idOnExternalPlatform}},w=await Y(fn(C),this._websocketClient);if(vt(w))return w;throw new pn("Load more messages failed",w)}async lastMessageSeen(){var e;return Y((e=this.idOnExternalPlatform,{eventType:m.YU.MESSAGE_SEEN,data:{thread:{idOnExternalPlatform:e}}}),this._websocketClient)}async sendAttachments(e,n={}){if(oe(e)||e.length===0)throw new p("FileList must be provided to sendAttachment method");const l=await(async(C,w,y={})=>{const{brandId:D,channelId:P}=It();try{const I=await Promise.all(Array.from(C).map((async q=>sr(q,D,P)))),{messageId:L=(0,G.v4)(),browserFingerprint:V=Et()}=y;return{messageContent:{type:Fe.C.TEXT,payload:{text:""}},attachments:I,browserFingerprint:V,thread:{idOnExternalPlatform:w},idOnExternalPlatform:L,consumer:{customFields:[]},consumerContact:{customFields:[]}}}catch(I){throw I instanceof Ut?I:I instanceof Error?new p(`Send attachment failed because of (${I.message})`):new p("Unknown error during file upload")}})(e,this.idOnExternalPlatform,n);return this.sendMessage(l)}keystroke(e=1e3,n){var l;this._typingTimeoutID||Y((l=this.idOnExternalPlatform,{eventType:m.YU.SENDER_TYPING_STARTED,data:{thread:{idOnExternalPlatform:l}}}),this._websocketClient),clearTimeout(this._typingTimeoutID),this._typingTimeoutID=setTimeout((()=>{this._stopTypingCallback(n)}),e)}stopTyping(){this._stopTypingCallback()}_stopTypingCallback(e){var n;clearTimeout(this._typingTimeoutID),this._typingTimeoutID=void 0,Y((n=this.idOnExternalPlatform,{eventType:m.YU.SENDER_TYPING_ENDED,data:{thread:{idOnExternalPlatform:n}}}),this._websocketClient),typeof e=="function"&&e()}keystrokeForPreview(e,n=1250){this._typingPreviewText=e,this._typingForPreviewTimeoutID||(this._typingForPreviewTimeoutID=setTimeout((()=>{this.stopTypingForPreview()}),n))}stopTypingForPreview(e=!0){clearTimeout(this._typingForPreviewTimeoutID),this._typingForPreviewTimeoutID=void 0;const n=this._typingPreviewText;this._typingPreviewText="",e!==!1&&this.sendMessagePreview(n)}async getMetadata(){const e=await Y((n=this.idOnExternalPlatform,{eventType:m.YU.LOAD_THREAD_METADATA,data:{thread:{idOnExternalPlatform:n}}}),this._websocketClient);var n;if(En(e))return e;throw new lr("Get metadata failed",e)}onThreadEvent(e,n){const l=((C,w)=>y=>{(D=>{var P,I,L,V,q,Q,ee;const he=D;return(Q=(V=(I=(P=he==null?void 0:he.thread)===null||P===void 0?void 0:P.idOnExternalPlatform)!==null&&I!==void 0?I:(L=he==null?void 0:he.case)===null||L===void 0?void 0:L.threadIdOnExternalPlatform)!==null&&V!==void 0?V:(q=he==null?void 0:he.message)===null||q===void 0?void 0:q.threadIdOnExternalPlatform)!==null&&Q!==void 0?Q:(ee=he==null?void 0:he.messagePreview)===null||ee===void 0?void 0:ee.threadIdOnExternalPlatform})(y.detail.data)===C&&w(y)})(this.idOnExternalPlatform,n);return this._messageEmitter.addEventListener(e,l),()=>{this._messageEmitter.removeEventListener(e,l)}}async sendCustomFields(){var e,n;return Y((e=ct(this._customFields),n=this.idOnExternalPlatform,{eventType:m.YU.SET_CONSUMER_CONTACT_CUSTOM_FIELD,data:{customFields:e,thread:{idOnExternalPlatform:n}}}),this._websocketClient)}async setCustomFields(e){Ot(this._customFields,e),this._exists!==!1&&await this.sendCustomFields()}setCustomField(e,n){return this.setCustomFields({[e]:n})}async archive(){const e=await Y((n=this.idOnExternalPlatform,{eventType:m.YU.ARCHIVE_THREAD,data:{thread:{idOnExternalPlatform:n}}}),this._websocketClient);var n;if(vn(e))return!0;throw new ur("Archive Thread failed",e)}async setName(e){const n=(l=this.idOnExternalPlatform,C=e,{eventType:m.YU.UPDATE_THREAD,data:{thread:{idOnExternalPlatform:l,threadName:C}}});var l,C;const w=await Y(n,this._websocketClient);if((function(y){return oe(y.error)})(w))return!0;throw new dr("Set Thread name failed",w)}async sendMessagePreview(e){const n=((l,C)=>({eventType:m.YU.SEND_MESSAGE_PREVIEW,data:{thread:{idOnExternalPlatform:l},messageContent:{payload:{text:C},type:Fe.C.TEXT}}}))(this.idOnExternalPlatform,e);await Y(n,this._websocketClient)}async sendTranscript(e,n){const l=((C,w)=>({eventType:m.YU.SEND_TRANSCRIPT,data:{consumerContact:{id:C},consumerRecipients:[{idOnExternalPlatform:w}]}}))(e,n);return Y(l,this._websocketClient)}_setThreadAndCustomerExists(){var e;this._exists=!0,(e=this._customer)===null||e===void 0||e.setExists(!0)}_clearCustomFieldsOnContactStatusChangedToClosed(e){const n=e.detail;ln(n)&&n.data.case.status===un.P.CLOSED&&this._customFields.clear()}_mergeCustomFieldsAndAccessTokenWithMessageData(e,n){var l,C,w,y,D,P;let I;const L=(l=this._isAuthorizationEnabled&&v())!==null&&l!==void 0&&l;L!==!1&&(I={token:L.token}),Nt(this._customFields,e.consumerContact.customFields);const V={customFields:ct(this._customFields)};let q;return n||((C=this._customer)===null||C===void 0||C.setCustomFieldsFromArray((y=(w=e.consumer)===null||w===void 0?void 0:w.customFields)!==null&&y!==void 0?y:[]),q={customFields:(P=(D=this._customer)===null||D===void 0?void 0:D.getCustomFieldsArray())!==null&&P!==void 0?P:[]}),Object.assign(Object.assign({},e),{accessToken:I,consumer:q,consumerContact:V})}_registerEventHandlers(){this.onThreadEvent(W.CASE_CREATED,(()=>this._setThreadAndCustomerExists())),this.onThreadEvent(W.CONTACT_CREATED,(()=>this._setThreadAndCustomerExists())),this.onThreadEvent(W.THREAD_RECOVERED,(()=>this._setThreadAndCustomerExists())),this.onThreadEvent(W.CONTACT_STATUS_CHANGED,(e=>this._clearCustomFieldsOnContactStatusChangedToClosed(e)))}}function _n(t){const e={eventType:m.YU.RECOVER_LIVECHAT,data:{}};return t===void 0?e:Object.assign(Object.assign({},e),{data:{thread:{idOnExternalPlatform:t}}})}class gn extends Mt{constructor(e,n,l,C,w={},y=!1){super(e,n,l,C,w,y),this._isInitialized=!1,this._canSendMessage=!0,this._registerLivechatEventHandlers()}async recover(){const e=await Y(_n(this.idOnExternalPlatform),this._websocketClient);if(Ae(e)){const n=e.data,{contact:l,consumerContact:C}=n,w=(function(y,D){var P={};for(var I in y)Object.prototype.hasOwnProperty.call(y,I)&&D.indexOf(I)<0&&(P[I]=y[I]);if(y!=null&&typeof Object.getOwnPropertySymbols=="function"){var L=0;for(I=Object.getOwnPropertySymbols(y);L<I.length;L++)D.indexOf(I[L])<0&&Object.prototype.propertyIsEnumerable.call(y,I[L])&&(P[I[L]]=y[I[L]])}return P})(n,["contact","consumerContact"]);return Object.assign(Object.assign({},w),{contact:l??C})}throw new kt("Thread recover fail",e)}async sendMessage(e){if(this._canSendMessage===!1)throw new p("Cannot send more messages to Contact");return super.sendMessage(e)}async startChat(e="Begin conversation"){if(this._isInitialized)throw new p("Chat is already initialized");try{const n=await this.sendTextMessage(e);return this._isInitialized=!0,n}catch(n){if(n instanceof Error)throw new p(`Sending initial message failed because of (${n.message})`);return}}async endChat(){const e=u.get(_.THREAD_DATA,"{}"),n=JSON.parse(e),l=n==null?void 0:n.contactId;if(oe(l))throw new p("Cannot end Chat because of missing ContactId in the storage");await Y((function(C,w){return{eventType:m.YU.END_CONTACT,data:{thread:{idOnExternalPlatform:C},contact:{id:w}}}})(this.idOnExternalPlatform,l),this._websocketClient)}async loadMoreMessages(){var e;const{scrollToken:n,oldestMessageDatetime:l,contactId:C}=(e=JSON.parse(u.get(_.THREAD_DATA,"{}")))!==null&&e!==void 0?e:{};if(ke(n)||ke(C))return null;const w={scrollToken:n,oldestMessageDatetime:l,thread:{idOnExternalPlatform:this.idOnExternalPlatform},contact:{id:C}},y=await Y(fn(w),this._websocketClient);if(vt(y))return y;throw new pn("Load more messages failed",y)}_registerLivechatEventHandlers(){this.onThreadEvent(W.LIVECHAT_RECOVERED,(e=>{Ae(e.detail)&&this._setThreadAndCustomerExists()}))}}const Tn=t=>!b(t)&&"threads"in t;function bn(t){const e=u.get(_.THREAD_DATA,"{}"),n=JSON.parse(e)||{};u.set(_.THREAD_DATA,JSON.stringify(Object.assign(Object.assign({},n),{contactId:t})))}function hr(t){var e,n,l;return dn(t)&&bn(t.data.case.id),Ae(t)&&bn((n=(e=t.data.consumerContact)===null||e===void 0?void 0:e.caseId)!==null&&n!==void 0?n:(l=t.data.contact)===null||l===void 0?void 0:l.id),t}function wn(t){var e;const n=(w=t.messages,(e=(y=w==null?0:w.length)?w[y-1]:void 0)===null||e===void 0?void 0:e.createdAt),l=u.get(_.THREAD_DATA,"{}"),C=JSON.parse(l)||{};var w,y;u.set(_.THREAD_DATA,JSON.stringify(Object.assign(Object.assign({},C),{scrollToken:t.scrollToken,oldestMessageDatetime:oe(n)?"":n})))}function fr(t){if(Ae(t)){const{messages:e,messagesScrollToken:n}=t.data;wn({messages:e,scrollToken:n})}if(vt(t)){const{scrollToken:e,messages:n}=t.data;wn({scrollToken:e,messages:n})}return t}class Cn extends Error{constructor(e="Aborted"){super(e),this.name="AbortError"}}class Be extends Promise{constructor(e){const n=new AbortController,l=n.signal;super(((C,w)=>{l.addEventListener("abort",(()=>{w(new Cn(this.abortReason))})),e==null||e(C,w,l)})),this.abort=C=>{this._abortReason=C??"Aborted",n.abort()}}get abortReason(){return this._abortReason}}Be.from=t=>t instanceof Be?t:new Be(((e,n)=>{t.then(e).catch(n)}));class An{constructor(e){var n,l;if(this.isLivechat=!1,this.channelId="",this.websocketClient=null,this.customer=null,this._incomingChatEventMiddleware=new Wn,this.isAuthorizationEnabled=!1,this._threadCache=new Map,this._contactCustomFieldsQueue=new Map,this._sendRefreshTokenEvent=async()=>{const y=v();if(b(y))return;const D=await Y((P=y.token,{eventType:m.YU.REFRESH_TOKEN,data:{accessToken:{token:P}}}),this.websocketClient);var P;if(on(D))return h(D.data.accessToken),void Rt(D.data.accessToken,this._sendRefreshTokenEvent);throw new k("An error occurred while refreshing the access token",D.error)},e===void 0)throw new p("No options was provided for initialization of ChatSdk");u.set(_.AUTHORIZATION_CODE,e.authorizationCode),u.set(_.BRAND_ID,`${e.brandId}`),u.set(_.CHANNEL_ID,e.channelId),u.set(_.APP_NAME,(n=e.appName)!==null&&n!==void 0?n:"chat-web-sdk"),u.set(_.APP_VERSION,`${(l=e.appVersion)!==null&&l!==void 0?l:0}`);const{brandId:C,channelId:w}=It();this.onError=e.onError,this.onRawEvent=e.onRawEvent,this._incomingChatEventMiddleware.register(qn),this._incomingChatEventMiddleware.register(fr),this._incomingChatEventMiddleware.register(hr),this._messageEmitter=new Qn;try{if(isNaN(C))throw new Error("Missing BrandID");if(w===void 0)throw new Error("Missing ChannelId");if(e.customerId===void 0)throw new Error("Missing CustomerId");this._initEnvironment(e),this._initWS(C,w,e.customerId),this.customer=new ie(e.customerId,e.customerName,e.customerImage,this.websocketClient),this.channelId=w}catch(y){this.onErrorHandler(y)}}onErrorHandler(e){if(typeof this.onError!="function")throw new p(e);this.onError(new p(e))}async authorize(e,n){var l,C,w,y,D,P,I;const L=v();if(L!==null)try{return await(async function(et,xt,_t,Gr){const Lr=nn(_t,Gr),yn=await Y(Lr,et);if(yn.error!==void 0)throw new k("Authorization reconnect failed",yn.error);return Rt(_t,xt),{reconnected:!0}})(this.websocketClient,this._sendRefreshTokenEvent,L,n)}catch{}const V=(function(Ze,et=(0,G.v4)()){return Object.assign({eventType:m.YU.AUTHORIZE_CUSTOMER,data:{authorization:{authorizationCode:Ze}}},N(et))})(e??u.get(_.AUTHORIZATION_CODE,null),n),q=tn(en(V),(0,G.v4)(),o.p.REGISTER),Q=await qt(q,this.websocketClient);if(!rn(Q))throw(l=this.websocketClient)===null||l===void 0||l.disconnect(),new k("Authorization failed",Q.error);const{consumerIdentity:ee,customer:he,channel:Ve,contact:Je}=Q.data,Xe=ee==null?void 0:ee.idOnExternalPlatform;if(Ce(pt=Xe)||pt==="")throw(C=this.websocketClient)===null||C===void 0||C.disconnect(),new p("Invalid customer identity");var pt;ie.setId(Xe),ee.firstName===void 0&&ee.lastName===void 0||ie.setName(`${ee.firstName} ${ee.lastName}`);const mt=ee.image;return mt!==void 0&&ie.setImage(mt),he!=null&&he.customFields&&((w=this.customer)===null||w===void 0||w.setCustomFieldsFromArray(he.customFields)),Je!=null&&Je.customFields&&Nt(this._contactCustomFieldsQueue,Je.customFields),this.isLivechat=(D=(y=Ve==null?void 0:Ve.settings)===null||y===void 0?void 0:y.isLivechat)!==null&&D!==void 0&&D,this.isAuthorizationEnabled=(P=Ve==null?void 0:Ve.settings.isAuthorizationEnabled)!==null&&P!==void 0&&P,((I=Q.data.accessToken)===null||I===void 0?void 0:I.token)!==void 0&&(h(Q.data.accessToken),Rt(Q.data.accessToken,this._sendRefreshTokenEvent)),Q.data}async generateAuthorizationToken(e,n){const l=await Y((function(w,y){return{eventType:m.YU.GENERATE_AUTHORIZATION_TOKEN,data:{thread:{idOnExternalPlatform:w},url:y}}})(e,n),this.websocketClient);if(!("authorizationToken"in l.data))throw new p("Invalid response from generate authorization token (generateAuthorizationToken)");const{authorizationToken:C}=l.data;return C}onChatEvent(e,n){return this._messageEmitter.addEventListener(e,n),()=>{this._messageEmitter.removeEventListener(e,n)}}getCustomer(){return this.customer}getThread(e){if(b(this.websocketClient))throw new p("Cannot get thread because websocket is disconnected");if(Ce(e))throw new p("Cannot get thread because id is undefined");const n=this._threadCache.get(e);if(!oe(n))return n;if(this.isLivechat){const C=new gn(e,this.websocketClient,this._messageEmitter,this.customer,this._getContactCustomFieldsFromQueue(),this.isAuthorizationEnabled);return this._threadCache.set(e,C),C}const l=new Mt(e,this.websocketClient,this._messageEmitter,this.customer,this._getContactCustomFieldsFromQueue(),this.isAuthorizationEnabled);return this._threadCache.set(e,l),l}async getThreadList(){if(b(this.websocketClient))throw new p("Cannot get thread list because websocket is disconnected");const e={eventType:m.YU.FETCH_THREAD_LIST,data:{}},n=await Y(e,this.websocketClient);if(!Tn(n.data))throw new p("Invalid response from fetch thread list (getThreadList)");return n.data.threads}getWebsocketClient(){return this.websocketClient}async sendOfflineMessage(e){return(async(n,l)=>{const C=(y=>{const[D,...P]=y.name.split(" ").reverse(),I=P.reverse().join(" "),L={idOnExternalPlatform:y.email,firstName:I,lastName:D},V={messageContent:{type:Fe.C.TEXT,payload:{text:y.message}}};return{eventType:m.YU.SEND_OFFLINE_MESSAGE,consumerIdentity:L,data:V}})(n),w=await Y(C,l);if(Pt(w))return w;throw new dt("Send offline message failed",w)})(e,this.websocketClient)}recoverThreadData(e){return new Be((async(n,l)=>{const C=mn(e),w=await Y(C,this.websocketClient);Ae(w)?n(w):l(new p("Invalid response from recover livechat thread"))}))}recoverLivechatThreadData(e){return new Be((async(n,l)=>{const C=_n(e),w=await Y(C,this.websocketClient);Ae(w)?n(w):l(new p("Invalid response from recover livechat thread"))}))}_getContactCustomFieldsFromQueue(){if(this._contactCustomFieldsQueue.size>0){const e=Xt(this._contactCustomFieldsQueue);return this._contactCustomFieldsQueue.clear(),e}return{}}_initEnvironment(e){var n,l;if(e.environment===pe.custom){if(ke(e.customEnvironment))throw new p('customEnvironment must be provided when environment is set to "custom"');return u.set(_.ENDPOINT_GATEWAY,(n=e.customEnvironment)===null||n===void 0?void 0:n.gateway),void u.set(_.ENDPOINT_CHAT,(l=e.customEnvironment)===null||l===void 0?void 0:l.chat)}const{gateway:C,chat:w}=(function(y){const D="{ENV}",P="https://channels-de-{ENV}.niceincontact.com",I="wss://chat-gateway-de-{ENV}.niceincontact.com";switch(y){case pe.AU1:return{chat:P.replace(D,"au1"),name:"Australia",gateway:I.replace(D,"au1")};case pe.CA1:return{chat:P.replace(D,"ca1"),name:"Canada",gateway:I.replace(D,"ca1")};case pe.EU1:return{chat:P.replace(D,"eu1"),name:"Europe",gateway:I.replace(D,"eu1")};case pe.JP1:return{chat:P.replace(D,"jp1"),name:"Japan",gateway:I.replace(D,"jp1")};case pe.NA1:return{chat:P.replace(D,"na1"),name:"North America",gateway:I.replace(D,"na1")};case pe.UK1:return{chat:P.replace(D,"uk1"),name:"United Kingdom",gateway:I.replace(D,"uk1")};case pe.custom:return{chat:"",name:"Custom",gateway:""};default:throw new p(`Unknown environment: ${y}`)}})(e.environment);u.set(_.ENDPOINT_GATEWAY,C),u.set(_.ENDPOINT_CHAT,w)}_initWS(e,n,l){const C=u.get(_.ENDPOINT_GATEWAY);(function(P){if(P==null)throw Error(`Expected non-nullish value, got ${P}`)})(C);const w=new URL(C),y=w.protocol,D={host:w.hostname,port:w.port,prefix:w.pathname.substring(1),forceSecureProtocol:y==="wss:"};this.websocketClient=new Zn(e,n,l,D,this.onError),this.websocketClient.on(f.xT.MESSAGE,(async P=>{try{typeof this.onRawEvent=="function"&&this.onRawEvent(P);const I=await(async V=>{if(Ce(V))return null;if(V.type!==He.m.EVENT_IN_S3)return V;const q=V.data.s3Object.url,Q=await fetch(q);if(Q.ok)return lt(await Q.json());throw new p("Failed to fetch S3 event data")})((V=>{const q=V==null?void 0:V.detail;if(!q)return;let Q;try{Q=JSON.parse(q.data)}catch{return}return lt(Q)})(P)),L=this._incomingChatEventMiddleware.process(I);if(!Ce(L)){const{type:V}=L;(q=>{const{id:Q}=q;if(at.has(Q)){const ee=at.get(Q);typeof ee=="function"&&ee(q),at.delete(Q)}})(L),this._messageEmitter.dispatchEvent(new Yn(V??"",{detail:L}))}}catch(I){this.onErrorHandler(I)}}))}}function Er(t){var e,n;return t.type===W.ASSIGNED_AGENT_CHANGED&&((n=(e=t.data)===null||e===void 0?void 0:e.case)===null||n===void 0?void 0:n.id)!==void 0}function vr(t){var e,n;return t.type===W.AGENT_TYPING_STARTED&&((n=(e=t.data)===null||e===void 0?void 0:e.thread)===null||n===void 0?void 0:n.idOnExternalPlatform)!==void 0}function pr(t){var e,n;return t.type===W.AGENT_TYPING_ENDED&&((n=(e=t.data)===null||e===void 0?void 0:e.thread)===null||n===void 0?void 0:n.idOnExternalPlatform)!==void 0}var mr=E(510);const _r=t=>{var e,n,l,C,w,y;return t.direction===mr.T.INBOUND?(n=(e=t.authorEndUserIdentity)===null||e===void 0?void 0:e.fullName)!==null&&n!==void 0?n:"":`${(C=(l=t.authorUser)===null||l===void 0?void 0:l.firstName)!==null&&C!==void 0?C:""} ${(y=(w=t.authorUser)===null||w===void 0?void 0:w.surname)!==null&&y!==void 0?y:""}`.trim()};function gr(t){const e=oe(t.id)===!1,n=oe(t.direction)===!1,l=oe(t.messageContent)===!1;return e&&n&&l}function Tr(t){return t.type===He.m.MESSAGE_CREATED}function br(t){return t.type===He.m.MESSAGE_SENT}function wr(t){return t.type===He.m.MESSAGE_READ_CHANGED}const Cr=t=>{const e=t;return Number.isInteger(e==null?void 0:e.data.positionInQueue)&&ke(e==null?void 0:e.id)===!1&&(e==null?void 0:e.type)===m.Ne.SET_POSITION_IN_QUEUE};class Ar extends p{}function yr(t){return{eventType:m.YU.CREATE_GROUP_CHAT_INVITE,data:{contact:{id:t}}}}async function Sr(t,e){const n=await Y(t,e);if((function(l){return l.type===W.GROUP_CHAT_INVITE_CREATED})(n))return n;throw new Ar("Create invitation failed",n)}class Or extends p{}function Nr(t){return{eventType:m.YU.JOIN_GROUP_CHAT,data:{invitation:{code:t}}}}async function Ir(t,e){const n=await Y(t,e);if((function(l){return l.type===W.GROUP_CHAT_JOINED})(n))return n;throw new Or("Join Group chat failed",n)}function Dr(t){return{eventType:m.YU.LEAVE_GROUP_CHAT,data:{contact:{id:t}}}}async function Rr(t,e){return Y(t,e)}class Pr extends p{}function Ur(t,e,n){return{eventType:m.YU.SEND_EMAIL_INVITE_TO_GROUP_CHAT,data:{contact:{id:t},invitation:{code:e},recipients:[{idOnExternalPlatform:n}]}}}async function kr(t,e){const n=await Y(t,e);if((function(l){return l.type===W.GROUP_CHAT_INVITE_SENT})(n))return n;throw new Pr("Send Email Invitation failed",n)}function Mr(t){return typeof t=="object"&&t!==null&&"reconnected"in t&&t.reconnected===!0}const xr=An})(),j})()))})(bt,bt.exports);var ye=bt.exports,Ei=Hr(ye);function Un(s){return!!(s.allowedFileSize&&s.allowedFileTypes)}const J="[NiceDFOServiceDesk]",kn=10*1e3;class _i extends Wr{constructor(){super(...arguments),this.isChannelOnline=!1}async ensureSDK(){var E,j;if(this.sdk)return;this.persistedState()?te(`${J} Retrieved previous state`,this.persistedState()):this.updatePersistedState({customerID:null,lastAgentMessageID:null,contactID:null,threadID:null},!1);const a=this.config;te(`${J} Creating integration using config`,a);let{customerID:r}=this.persistedState();r||(a.useWebChatUserID===!0?r=this.state.userID:a.useWebChatUserID===!1||this.state.userID.startsWith(jr)?r=Sn(On.MISCELLANEOUS):r=this.state.userID,this.updatePersistedState({customerID:r})),te(`${J} Using customer ID "${r}"`);const i={brandId:a.brandID,channelId:a.channelID,environment:a.environment,customerId:r},c={type:"agent:niceDFO:getAuthCode",authCode:null,visitorID:null};await this.eventBus.fire(c,this.instance),this.sdk=new Ei(i),te(`${J} Authorizing...`);const d=await this.sdk.authorize(c.authCode,c.visitorID);te(`${J} Authorize complete`,d),this.isChannelOnline=((j=(E=d.channel)==null?void 0:E.availability)==null?void 0:j.status)==="online",this.sdk.onChatEvent(ye.ChatEvent.SET_POSITION_IN_QUEUE,_=>this.handlePositionInQueue(_)),this.sdk.onChatEvent(ye.ChatEvent.ASSIGNED_AGENT_CHANGED,_=>this.handleAgentChanged(_)),this.sdk.onChatEvent(ye.ChatEvent.CONTACT_STATUS_CHANGED,_=>this.handleContactStatusChanged(_)),this.sdk.onChatEvent(ye.ChatEvent.CONTACT_CREATED,_=>this.handleContactCreated(_)),this.callback.updateCapabilities({allowFileUploads:!0,allowMultipleFileUploads:!0})}async recoverThread(){const{threadID:a}=this.persistedState();if(a)try{te(`${J} Using existing thread ${a}`,this.thread),this.thread=this.sdk.getThread(a);const r=await Nn(this.thread.recover(),kn,"recover timed out");return te(`${J} Recovered thread ${a}`,r),await this.handleRecover(r),this.addThreadListeners(),!0}catch(r){Gt(`${J} Error getting existing thread`,r),this.updatePersistedState({threadID:null,contactID:null})}return!1}addThreadListeners(){this.thread.onThreadEvent(ye.ChatEvent.MESSAGE_CREATED,a=>this.handleMessageCreated(a)),this.thread.onThreadEvent(ye.ChatEvent.AGENT_TYPING_STARTED,a=>this.handleAgentTyping(a,!0)),this.thread.onThreadEvent(ye.ChatEvent.AGENT_TYPING_ENDED,a=>this.handleAgentTyping(a,!1))}async startChat(a,r){var _,f;await this.ensureSDK();const i=a.output.generic.find(Fr),{preStartChatPayload:c}=r,d=Sn(On.MISCELLANEOUS);if(te(`${J} Creating new thread ${d}`),this.thread=this.sdk.getThread(d),this.addThreadListeners(),c!=null&&c.customerName&&this.sdk.getCustomer().setName(c.customerName),this.newContactPromise=Br(),(f=(_=c==null?void 0:c.consumerContact)==null?void 0:_.customFields)!=null&&f.length){const o={};c==null||c.consumerContact.customFields.forEach(m=>{o[m.ident]=m.value}),this.thread.setCustomFields(o)}const E=Vr(i,"Begin conversation");await this.thread.startChat(E.join(`
`));const j=await Nn(this.newContactPromise,kn,"A new chat timed out waiting for a contact to be created.");this.updatePersistedState({threadID:d,contactID:j}),this.newContactPromise=null,te(`${J} Started chat with contact ${j}`)}async handleMessageCreated(a){te(`${J} ${a.type}`,a);const r=a.detail.data,{message:i,agentContact:c}=r;await this.handleMessage(i,!0,c==null?void 0:c.user)}async handleRecover(a){const{lastAgentMessageID:r}=this.persistedState(),{messages:i}=a;te(`${J} Last agent message: ${r}`);const c=i.findIndex(d=>d.id===r);if(c>0)for(let d=c-1;d>=0;d--){const E=i[d];this.handleMessage(E,!1,a.ownerAssignee)}}async handleMessage(a,r,i){var c,d;if(a.direction==="outbound"){const E=a.threadIdOnExternalPlatform,j=this.persistedState().threadID;if(!E||E!==j){te(`${J} Got message for thread ${E} but the current thread is ${j}.`);return}const{isConnected:_}=this.serviceManager.store.getState().persistedToBrowserStorage.chatState.agentState;r&&!_&&await this.doAgentJoined(i);const f=[];if((c=a.messageContent)!=null&&c.text&&f.push(In({response_type:Dn.TEXT,text:a.messageContent.text})),(d=a.attachments)!=null&&d.length&&a.attachments.forEach(o=>{f.push(In({response_type:Dn.BUTTON,kind:zr.LINK,button_type:$r.URL,url:o.url,label:o.friendlyName||o.fileName||o.filename}))}),f.length){const o={id:null,output:{generic:f}};await this.callback.agentTyping(!1),await this.callback.sendMessageToUser(o,i==null?void 0:i.id),this.updatePersistedState({lastAgentMessageID:a.id})}}}async handleAgentTyping(a,r){te(`${J} ${a.type}`,a),await this.callback.agentTyping(r)}async handleContactStatusChanged(a){var d;te(`${J} ${a.type}`,a);const r=a.detail.data,i=r.case.id,c=this.persistedState().contactID;if(!i||i!==c){te(`${J} Got contact ${i} status change but the current contact is ${c}.`);return}((d=r.case)==null?void 0:d.status)==="closed"&&(te(`${J} Agent closed contact ${i}`,a),await this.callback.agentEndedChat())}async handleContactCreated(a){var r,i;te(`${J} ${a.type}`,a),this.newContactPromise?this.newContactPromise.doResolve((i=(r=a.detail.data)==null?void 0:r.case)==null?void 0:i.id):te(`${J} Got a new contact but wasn't expecting one.`,a)}async handleAgentChanged(a){te(`${J} ${a.type}`,a);const r=a.detail.data,i=r.case.id,c=this.persistedState().contactID;if(!i||i!==c){te(`${J} Got contact ${i} status change but the current contact is ${c}.`);return}const{inboxAssignee:d,previousInboxAssignee:E}=r;d?(E&&await this.callback.beginTransferToAnotherAgent(),await this.doAgentJoined(d)):await this.callback.agentLeftChat()}async handlePositionInQueue(a){te(`${J} ${a.type}`,a);const r=a.detail;await this.callback.updateAgentAvailability({position_in_queue:r.data.positionInQueue||1})}async doAgentJoined(a){const r=(a==null?void 0:a.nickname)||`${(a==null?void 0:a.firstName)||""} ${(a==null?void 0:a.surname)||""}`.trim()||null,i={id:a==null?void 0:a.id,nickname:r,profile_picture_url:a==null?void 0:a.imageUrl};await this.callback.agentJoined(i)}async endChat(a){var r;te(`${J} Ended chat`),this.updatePersistedState({threadID:null,contactID:null}),a.endedByAgent||(r=this.thread)==null||r.endChat(),this.thread=null}async sendMessageToAgent(a,r,i){if(a.input.text){const c=a.input.text;try{await this.thread.sendTextMessage(c)}catch(d){this.callback.setErrorStatus({type:Yr.USER_MESSAGE,messageID:r}),Gt(`${J} Error sending message to agent`,d)}}i.filesToUpload.length&&this.doFileUploads(i.filesToUpload)}async doFileUploads(a){const r=new DataTransfer;a.forEach(c=>r.items.add(c.file));let i;try{const c=await this.thread.sendAttachments(r.files);te(`${J} Got sendAttachments result`,c),Un(c)&&(i=this.formatUploadErrorMessage(c))}catch(c){Gt(`${J} Error sending files to agent`,c),i=this.formatUploadErrorMessage(c)}a.forEach((c,d)=>{this.callback.setFileUploadStatus(c.id,!!i,d===0?i:null)})}formatUploadErrorMessage(a){if(Un(a)){const r=a.allowedFileTypes.map(({mimeType:c})=>c).join(", ");return this.instance.getIntl().formatMessage({id:"serviceDesk_niceDFO_fileUploadError"},{allowedTypes:r,fileSize:a.allowedFileSize})}return this.getIntlText("fileSharing_uploadFailed")}async userReadMessages(){}async userTyping(a){var r,i;a?(r=this.thread)==null||r.keystroke(5e3):(i=this.thread)==null||i.stopTyping()}async areAnyAgentsOnline(a){return await this.ensureSDK(),this.isChannelOnline}async reconnect(){return await this.ensureSDK(),this.recoverThread()}}export{_i as NiceDFOServiceDesk};
