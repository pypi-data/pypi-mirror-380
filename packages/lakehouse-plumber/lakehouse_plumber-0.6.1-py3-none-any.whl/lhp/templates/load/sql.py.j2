@dlt.view()
def {{ target_view }}():
    """{{ description }}"""
    df = spark.sql("""{{ sql_query }}""")
    {% if add_operational_metadata %}
    
    # Add operational metadata columns
    {% for col_name, expression in metadata_columns.items()|sort %}
    df = df.withColumn('{{ col_name }}', {{ expression }})
    {% endfor %}
    {% endif %}
    
    return df 