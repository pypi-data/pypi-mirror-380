The Variance Test is a method used to identify outliers in a set of numeric data. It calculates the mean and standard deviation of the data and sets upper and lower bounds based on a user-provided multiplier. Any values outside of these bounds are considered outliers.
------

SET SCHEMA DM_PAL;

DROP TABLE PAL_VT_DATA_TBL;
CREATE COLUMN TABLE PAL_VT_DATA_TBL (
	"ID" INTEGER,
	"X" DOUBLE
);
INSERT INTO PAL_VT_DATA_TBL VALUES (0,25);
INSERT INTO PAL_VT_DATA_TBL VALUES (1,20);
INSERT INTO PAL_VT_DATA_TBL VALUES (2,23);
INSERT INTO PAL_VT_DATA_TBL VALUES (3,29);
INSERT INTO PAL_VT_DATA_TBL VALUES (4,26);
INSERT INTO PAL_VT_DATA_TBL VALUES (5,23);
INSERT INTO PAL_VT_DATA_TBL VALUES (6,22);
INSERT INTO PAL_VT_DATA_TBL VALUES (7,21);
INSERT INTO PAL_VT_DATA_TBL VALUES (8,22);
INSERT INTO PAL_VT_DATA_TBL VALUES (9,25);
INSERT INTO PAL_VT_DATA_TBL VALUES (10,26);
INSERT INTO PAL_VT_DATA_TBL VALUES (11,28);
INSERT INTO PAL_VT_DATA_TBL VALUES (12,29);
INSERT INTO PAL_VT_DATA_TBL VALUES (13,27);
INSERT INTO PAL_VT_DATA_TBL VALUES (14,26);
INSERT INTO PAL_VT_DATA_TBL VALUES (15,23);
INSERT INTO PAL_VT_DATA_TBL VALUES (16,22);
INSERT INTO PAL_VT_DATA_TBL VALUES (17,23);
INSERT INTO PAL_VT_DATA_TBL VALUES (18,25);
INSERT INTO PAL_VT_DATA_TBL VALUES (19,103);

DROP TABLE #PAL_PARAMETER_TBL;
CREATE LOCAL TEMPORARY COLUMN TABLE #PAL_PARAMETER_TBL (
    "PARAM_NAME" VARCHAR (256),
    "INT_VALUE" INTEGER,
    "DOUBLE_VALUE" DOUBLE,
    "STRING_VALUE" VARCHAR (1000)
);
INSERT INTO #PAL_PARAMETER_TBL VALUES ('SIGMA_NUM', null, 3.0, null);

CALL "_SYS_AFL"."PAL_VARIANCE_TEST"(PAL_VT_DATA_TBL, #PAL_PARAMETER_TBL, ?, ?);

