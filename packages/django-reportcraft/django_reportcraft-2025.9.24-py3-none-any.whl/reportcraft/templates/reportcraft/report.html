{% extends "reportcraft/base.html" %}
{% load static %}

{% load reportcraft %}
{% block extra_css %}
    <link href="{% static "reportcraft/reportcraft.min.css" %}" rel="stylesheet">
{% endblock %}

{% block page-pretitle %}Report{% endblock %}
{% block page-title %}<span id="report-title">{{ report.title }}</span>{% endblock %}
{% block page-subtitle %}<span id="report-subtitle">{{ report.description }}</span>{% endblock %}
{% block page-content %}
    <div id="report-entry" class="report-{{ report.theme }}"></div>
{% endblock %}

{% block page-scripts %}
    <script type="module">
        import { showReport } from '{% static "reportcraft/reportcraft.min.js" %}';
        document.addEventListener('DOMContentLoaded', function() {
            fetch("{{ data_url }}{{ query }}")
                .then(response => response.json())
                .then(data => {
                    const sections = data["sections"] || [];
                    const reportTitle = data["title"] || "A Report";
                    const reportDescription = data["description"] || "";
                    document.getElementById("report-title").innerText = reportTitle;
                    document.getElementById("report-subtitle").innerText = reportDescription;
                    showReport("#report-entry", sections, "{% static 'reportcraft' %}");
                })
                .catch(error => console.error('Error fetching report data:', error));
        });
    </script>
{% endblock %}