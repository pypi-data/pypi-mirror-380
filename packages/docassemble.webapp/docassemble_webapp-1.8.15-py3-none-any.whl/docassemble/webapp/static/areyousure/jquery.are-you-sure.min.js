/*!
 * jQuery Plugin: Are-You-Sure (Dirty Form Detection)
 * https://github.com/codedance/jquery.AreYouSure/
 *
 * Copyright (c) 2012-2014, Chris Dance and PaperCut Software http://www.papercut.com/
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * Author:  chris.dance@papercut.com
 * Version: 1.9.0
 * Date:    13th August 2014
 */(function(e){e.fn.areYouSure=function(t){var n=e.extend({message:"You have unsaved changes!",dirtyClass:"dirty",change:null,silent:!1,addRemoveFieldsMarksDirty:!1,fieldEvents:"change keyup propertychange input",fieldSelector:":input:not(input[type=submit]):not(input[type=button])"},t),i=function(t){if(t.hasClass("ays-ignore")||t.hasClass("aysIgnore")||t.attr("data-ays-ignore")||t.attr("name")===void 0)return null;if(t.is(":disabled"))return"ays-disabled";var n,s=t.attr("type");switch(t.is("select")&&(s="select"),s){case"checkbox":case"radio":n=t.is(":checked");break;case"select":n="",t.find("option").each(function(){var s=e(this);s.is(":selected")&&(n+=s.val())});break;default:n=t.val()}return n},a=function(e){e.data("ays-orig",i(e))},o=function(t){var a,c,r=function(e){var t=e.data("ays-orig");return void 0!==t&&i(e)!=t},o=e(this).is("form")?e(this):e(this).parents("form");if(r(e(t.target))){s(o,!0);return}if($fields=o.find(n.fieldSelector),n.addRemoveFieldsMarksDirty&&(c=o.data("ays-orig-field-count"),c!=$fields.length)){s(o,!0);return}a=!1,$fields.each(function(){var t=e(this);if(r(t))return a=!0,!1}),s(o,a)},r=function(t){var i=t.find(n.fieldSelector);e(i).each(function(){a(e(this))}),e(i).unbind(n.fieldEvents,o),e(i).bind(n.fieldEvents,o),t.data("ays-orig-field-count",e(i).length),s(t,!1)},s=function(e,t){var s=t!=e.hasClass(n.dirtyClass);e.toggleClass(n.dirtyClass,t),s&&(n.change&&n.change.call(e,e),t&&e.trigger("dirty.areYouSure",[e]),t||e.trigger("clean.areYouSure",[e]),e.trigger("change.areYouSure",[e]))},c=function(){var t=e(this),s=t.find(n.fieldSelector);e(s).each(function(){var t=e(this);t.data("ays-orig")||(a(t),t.bind(n.fieldEvents,o))}),t.trigger("checkform.areYouSure")},l=function(){r(e(this))};return!n.silent&&!window.aysUnloadSet&&(window.aysUnloadSet=!0,e(window).bind("beforeunload",function(){if($dirtyForms=e("form").filter("."+n.dirtyClass),$dirtyForms.length==0)return;if(navigator.userAgent.toLowerCase().match(/msie|chrome/)){if(window.aysHasPrompted)return;window.aysHasPrompted=!0,window.setTimeout(function(){window.aysHasPrompted=!1},900)}return n.message})),this.each(function(){if(!e(this).is("form"))return;var i=e(this);i.submit(function(){i.removeClass(n.dirtyClass)}),i.bind("reset",function(){s(i,!1)}),i.bind("rescan.areYouSure",c),i.bind("reinitialize.areYouSure",l),i.bind("checkform.areYouSure",o),r(i)})}})(jQuery)