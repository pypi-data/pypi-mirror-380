Metadata-Version: 2.1
Name: lancetnic
Version: 2.1.0
Summary: A tool for working with text data
Home-page: https://github.com/Lancet52/lancetnic
Author: Lancet52
Author-email: lancetFPV@yandex.ru
Classifier: Development Status :: 5 - Production/Stable
Classifier: Programming Language :: Python :: 3.10
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Requires-Python: >=3.9
Description-Content-Type: text/markdown
License-File: LICENSE

# LANCETNIC 2.1.0

[![PyPI Package Version](https://img.shields.io/pypi/v/lancetnic.svg?style=flat-square)](https://pypi.org/project/lancetnic/)
[![PyPi status](https://img.shields.io/pypi/status/lancetnic.svg?style=flat-square)](https://pypi.python.org/pypi/lancetnic)
[![Downloads](https://static.pepy.tech/badge/lancetnic)](https://pepy.tech/project/lancetnic)
[![Downloads](https://img.shields.io/pypi/dm/lancetnic.svg?style=flat-square)](https://pypi.python.org/pypi/lancetnic)
[![MIT License](https://img.shields.io/pypi/l/lancetnic.svg?style=flat-square)](https://opensource.org/licenses/MIT)

### LANCETNIC - —ç—Ç–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –±–∞–∑–æ–≤—ã–π –Ω–∞–±–æ—Ä –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á:

- –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö, —á–∏—Å–ª–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –∞ —Ç–∞–∫–∂–µ –∏—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π.


### –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ä—è–¥ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è:
- –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∏ –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –æ–±—É—á–µ–Ω–∏–µ–º.
- –û–±—É—á–µ–Ω–∏—é –º–æ–¥–µ–ª–∏.
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –º–µ—Ç—Ä–∏–∫ –ø–æ –æ–∫–æ–Ω—á–∞–Ω–∏–∏ –æ–±—É—á–µ–Ω–∏—è, –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è —Ä–µ—à–µ–Ω–∏–µ –æ —Ç–æ—á–Ω–æ—Å—Ç–∏ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏.
- –ò–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –º–æ–¥–µ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

–° –ø–æ–º–æ—â—å—é LANCETNIC –º–æ–∂–Ω–æ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞, –≤—ã—è–≤–ª–µ–Ω–∏—è —Å–ø–∞–º–∞, –º–æ—à–µ–Ω–Ω–∏—á–µ—Å–∫–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π, –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ü–µ–Ω, –∞ —Ç–∞–∫–∂–µ –ø—Ä–æ–≤–æ–¥–∏—Ç—å —Ä–∞–±–æ—Ç—ã —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Ä—è–¥–∞–º–∏.


–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ —Å —á–∏—Å—Ç–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏, —Ç–∞–∫ –∏ —Å –∫–æ–º–±–∏–Ω–∞—Ü–∏–µ–π —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∏ —á–∏—Å–ª–æ–≤—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫, –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏ –∏ —Ü–µ–Ω—ã.
–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è: –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞, –≤—ã—è–≤–ª–µ–Ω–∏–µ —Å–ø–∞–º–∞, –º–æ—à–µ–Ω–Ω–∏—á–µ—Å–∫–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π, —Ä–∞–±–æ—Ç–∞ —Å —á–∏—Å–ª–æ–≤—ã–º–∏ —Ä—è–¥–∞–º–∏ –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è–º–∏.

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞:
–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å –ø–æ–º–æ—â—å—é CUDA

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–º —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PyTorch —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π CUDA (–ù–ï–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û):

```bash
pip install torch==2.5.1+cu124 torchaudio==2.5.1+cu124 torchvision==0.20.1+cu124 --index-url https://download.pytorch.org/whl/cu124
```

–ó–∞—Ç–µ–º —É—Å—Ç–∞–Ω–æ–≤–∫–∞ lancetnic:

```bash
pip install lancetnic
```

## üë• –ê–≤—Ç–æ—Ä—ã

- [Lancet52](https://github.com/Lancet52)

## üìÑ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:

<div align="center">

## –ó–∞–¥–∞—á–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

<img src="lancetnic/docs/images/classification.png" alt="–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è" width="500">
</div>

- ### –ö–ª–∞—Å—Å `TextClass()`
–ü–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.
```Python
from lancetnic import TextClass
```

| –ê—Ç—Ä–∏–±—É—Ç         | –¢–∏–ø       | –î–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------------|-----------|---------------------|----------|
| `text_column`  | string   | –õ—é–±–æ–µ –≤–∞–ª–∏–¥–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ | –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ |
| `label_column` | string   | –õ—é–±–æ–µ –≤–∞–ª–∏–¥–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ | –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ —Å —Ü–µ–ª–µ–≤—ã–º–∏ –º–µ—Ç–∫–∞–º–∏ |
| `split_ratio`  | float    | (0.01, 0.99) | –î–æ–ª—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (–ø—Ä–∏ val_path=None) |
| `random_state` | int      | (1, 99) | –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π seed (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 42) |
           
### –º–µ—Ç–æ–¥ `train`

| –ü–∞—Ä–∞–º–µ—Ç—Ä       | –¢–∏–ø       | –ó–Ω–∞—á–µ–Ω–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------------|-----------|----------|----------|
| `model_name`   | class    | LancetMC/LancetMCA | –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏ |
| `train_path`   | string   | –ü—É—Ç—å | –ü—É—Ç—å –∫ –æ–±—É—á–∞—é—â–∏–º –¥–∞–Ω–Ω—ã–º (CSV) |
| `val_path`     | string   | –ü—É—Ç—å/None | –ü—É—Ç—å –∫ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º |
| `num_epochs`   | int      | ‚â•1 | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö |
| `hidden_size`  | int      | ‚â•1 | –ù–µ–π—Ä–æ–Ω–æ–≤ –≤ —Å–ª–æ–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 256) |
| `num_layers`   | int      | ‚â•1 | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ—ë–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1) |
| `batch_size`   | int      | ‚â•1 | –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 128) |
| `learning_rate`| float    | (1e-5, 1e-1) | Learning rate (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.001) |
| `dropout`      | float    | [0.0, 0.99) | Dropout (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0) |
| `optim_name`   | string   | Adam/RAdam/SGD/RMSprop/Adadelta | –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä |
| `crit_name`    | string   | CELoss | –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å |

### –º–µ—Ç–æ–¥ `predict`

| –ü–∞—Ä–∞–º–µ—Ç—Ä       | –¢–∏–ø       | –ó–Ω–∞—á–µ–Ω–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------------|-----------|----------|----------|
| `model_path`   | string   | –ü—É—Ç—å | –ü—É—Ç—å –∫ –º–æ–¥–µ–ª–∏ (.pth) |
| `text`         | string   | –¢–µ–∫—Å—Ç | –¢–µ–∫—Å—Ç –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ |


### –ü—Ä–∏–º–µ—Ä –¥–ª—è –∫–∞–ª—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞
```Python
from lancetnic.models import LancetMC
from lancetnic import TextClass

text_model = TextClass(
            text_column='description',  # –ò–º—è —Å—Ç–æ–ª–±—Ü–∞, —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
            label_column='category',    # –ò–º—è —Å—Ç–æ–ª–±—Ü–∞, —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ –º–µ—Ç–∫–∏
            split_ratio=0.2,            # –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –º–µ–∂–¥—É –æ–±—É—á–µ–Ω–∏–µ–º –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π (–µ—Å–ª–∏ val_path –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç)
            random_state=42             # –°–ª—É—á–∞–π–Ω–æ–µ –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            )

text_model.train(model_name=LancetMC,   # –ò–º—è –º–æ–¥–µ–ª–∏ (–¥–æ—Å—Ç—É–ø–µ–Ω –≤—ã–±–æ—Ä –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏)
                train_path="train.csv", # –ü—É—Ç—å –∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–º –¥–∞–Ω–Ω—ã–º (—Ñ–æ—Ä–º–∞—Ç CSV)
                val_path=None,          # –ü—É—Ç—å –∫ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º. –ú–æ–∂–µ—Ç –æ—Ç—Å—É—Ç—Å–≤–æ–≤–∞—Ç—å: None
                num_epochs=50,          # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö –æ–±—É—á–µ–Ω–∏—è
                hidden_size=256,        # –†–∞–∑–º–µ—Ä —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–ª–æ–≤–∞ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–π—Ä–æ–Ω–æ–≤ –≤ —Å–ª–æ–µ)
                num_layers=1,           # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∫—Ä—ã—Ç—ã—Ö —Å–ª–æ–µ–≤
                batch_size=256,         # –†–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–æ–≤ (–±–∞—Ç—á–µ–π) –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
                learning_rate=0.001,    # –°–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞
                dropout=0,              # –ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–æ–≤ (0-1)
                optim_name='Adam',      # –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä ('Adam', 'SGD', 'RAdam', –∏ –¥—Ä.)
                crit_name='CELoss'      # –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å ('CELoss' –∏ –¥—Ä.)
                )
```
### –ò–Ω—Ñ–µ—Ä–µ–Ω—Å –º–æ–¥–µ–ª–∏
```Python
from lancetnic import TextClass

text_model = TextClass()
text_pred = text_model.predict(
                model_path="model.pth", # –ü—É—Ç—å –¥–æ –º–æ–¥–µ–ª–∏
                text="Sample text to classify" # –¢–µ–∫—Å—Ç –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
                )
```

- ### –ö–ª–∞—Å—Å `TextScalarClass()`
```Python
from lancetnic import TextScalarClass
```

| –ê—Ç—Ä–∏–±—É—Ç         | –¢–∏–ø       | –î–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------------|-----------|---------------------|----------|
| `text_column`  | string   | –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ –∏–ª–∏ None | –°—Ç–æ–ª–±–µ—Ü —Å —Ç–µ–∫—Å—Ç–æ–º (None –µ—Å–ª–∏ —Ç–æ–ª—å–∫–æ —á–∏—Å–ª–∞) |
| `data_column`  | list     | –°–ø–∏—Å–æ–∫ —Å—Ç–æ–ª–±—Ü–æ–≤ | –ß–∏—Å–ª–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ |
| `label_column` | string   | –õ—é–±–æ–µ –≤–∞–ª–∏–¥–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ | –¶–µ–ª–µ–≤—ã–µ –º–µ—Ç–∫–∏ |
| `split_ratio`  | float    | (0.01, 0.99) | –î–æ–ª—è –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ |
| `random_state` | int      | (1, 99) | Random seed (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 42) |

### –º–µ—Ç–æ–¥ `train`

| –ü–∞—Ä–∞–º–µ—Ç—Ä       | –¢–∏–ø       | –ó–Ω–∞—á–µ–Ω–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------------|-----------|----------|----------|
| `model_name`   | class    | LancetMC/LancetMCA | –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏ |
| `train_path`   | string   | –ü—É—Ç—å | –ü—É—Ç—å –∫ –æ–±—É—á–∞—é—â–∏–º –¥–∞–Ω–Ω—ã–º (CSV) |
| `val_path`     | string   | –ü—É—Ç—å/None | –ü—É—Ç—å –∫ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º |
| `num_epochs`   | int      | ‚â•1 | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö |
| `hidden_size`  | int      | ‚â•1 | –ù–µ–π—Ä–æ–Ω–æ–≤ –≤ —Å–ª–æ–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 256) |
| `num_layers`   | int      | ‚â•1 | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ—ë–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1) |
| `batch_size`   | int      | ‚â•1 | –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 128) |
| `learning_rate`| float    | (1e-5, 1e-1) | Learning rate (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.001) |
| `dropout`      | float    | [0.0, 0.99) | Dropout (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0) |
| `optim_name`   | string   | Adam/RAdam/SGD/RMSprop/Adadelta | –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä |
| `crit_name`    | string   | CELoss | –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å |

### –º–µ—Ç–æ–¥ `predict`

| –ü–∞—Ä–∞–º–µ—Ç—Ä       | –¢–∏–ø       | –ó–Ω–∞—á–µ–Ω–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------------|-----------|----------|----------|
| `model_path`   | string   | –ü—É—Ç—å | –ü—É—Ç—å –∫ –º–æ–¥–µ–ª–∏ (.pth) |
| `text`         | string   | –¢–µ–∫—Å—Ç | –¢–µ–∫—Å—Ç –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ |
| `numeric`      | list     | –ß–∏—Å–ª–∞ | –ß–∏—Å–ª–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (—Ç–æ–ª—å–∫–æ TextScalarClass) |

### –ü—Ä–∏–º–µ—Ä –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∏ —á–∏—Å–ª–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
```Python
from lancetnic.models import LancetMC
from lancetnic import TextScalarClass

mixed_model = TextScalarClass(
                text_column='description',      # –ò–º—è —Å—Ç–æ–ª–±—Ü–∞ —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ —Ç–µ–∫—Å—Ç (–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –µ—Å–ª–∏ –≤ –ù–î —Ç–æ–ª—å–∫–æ —á–∏—Å–ª–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ)
                data_column=['feat1', 'feat2'], # –°–ø–∏—Å–æ–∫ —Å—Ç–æ–ª–±—Ü–æ–≤ —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö —á–∏—Å–ª–æ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
                label_column='target',          # –ò–º—è —Å—Ç–æ–ª–±—Ü–∞, —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ –º–µ—Ç–∫–∏
                split_ratio=0.2,                # –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –º–µ–∂–¥—É –æ–±—É—á–µ–Ω–∏–µ–º –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π (–µ—Å–ª–∏ val_path –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç)
                random_state=42                 # –°–ª—É—á–∞–π–Ω–æ–µ –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
                )

mixed_model.train(model_name=LancetMC,  # –ò–º—è –º–æ–¥–µ–ª–∏ (–¥–æ—Å—Ç—É–ø–µ–Ω –≤—ã–±–æ—Ä –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏)
                train_path="train.csv", # –ü—É—Ç—å –∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–º –¥–∞–Ω–Ω—ã–º (—Ñ–æ—Ä–º–∞—Ç CSV)
                val_path=None,          # –ü—É—Ç—å –∫ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º. –ú–æ–∂–µ—Ç –æ—Ç—Å—É—Ç—Å–≤–æ–≤–∞—Ç—å: None
                num_epochs=50,          # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö –æ–±—É—á–µ–Ω–∏—è
                hidden_size=256,        # –†–∞–∑–º–µ—Ä —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–ª–æ–≤–∞ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–π—Ä–æ–Ω–æ–≤ –≤ —Å–ª–æ–µ)
                num_layers=1,           # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∫—Ä—ã—Ç—ã—Ö —Å–ª–æ–µ–≤
                batch_size=256,         # –†–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–æ–≤ (–±–∞—Ç—á–µ–π) –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
                learning_rate=0.001,    # –°–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞
                dropout=0,              # –ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–æ–≤ (0-1)
                optim_name='Adam',      # –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä ('Adam', 'SGD', 'RAdam', –∏ –¥—Ä.)
                crit_name='CELoss'      # –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å ('CELoss' –∏ –¥—Ä.)
                )
```

### –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –º–∞—Å—Å–∏–≤–∞ –¥–∞–Ω–Ω—ã—Ö
```Python
from lancetnic import TextScalarClass

mixed_model = TextScalarClass()
mixed_pred = mixed_model.predict(
                model_path="mixed_model.pth",   # –ü—É—Ç—å –¥–æ –º–æ–¥–µ–ª–∏
                text="Product description",     # –¢–µ–∫—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (–º–æ–∂–µ—Ç –æ—Ç—Å—É—Ç—Å–≤–æ–≤–∞—Ç—å None)
                numeric=[0.5, 1.2]              # –ß–∏—Å–ª–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –≤–∏–¥–µ —Å–ø–∏—Å–∫–∞
                )
```


## –ú–æ–¥–µ–ª–∏ –¥–ª—è –∑–∞–¥–∞—á–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

- LancetMC
```Python
from lancetnic.models import LancetMC
```
- LancetMCA
```Python
from lancetnic.models import LancetMC
```
- ScalpelMC
```Python
from lancetnic.models import ScalpelMC
```

 –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å—Ç–æ–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | LancetMC | LancetMCA | ScalpelMC |
|----------------|----------|-----------|-----------|
| **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** | LSTM | LSTM + Attention | Fully Connected Network |
| **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** | –ú–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π | –ú–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Å –≤–Ω–∏–º–∞–Ω–∏–µ–º | –ú–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö |
| **–ú–µ—Ö–∞–Ω–∏–∑–º –≤–Ω–∏–º–∞–Ω–∏—è** | ‚ùå | ‚úÖ | ‚ùå |
| **–û–±—É—á–µ–Ω–∏–µ** | –ú–µ–¥–ª–µ–Ω–Ω–µ–µ | –°–∞–º—ã–π –º–µ–¥–ª–µ–Ω–Ω—ã–π | –ë—ã—Å—Ç—Ä–æ–µ |
| **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ** | –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã | –î–ª–∏–Ω–Ω—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã | –¢–∞–±–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –ø—Ä–æ—Å—Ç–µ–π—à–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ |

## –ü–æ –æ–∫–æ–Ω—á–∞–Ω–∏–∏ –æ–±—É—á–µ–Ω–∏—è –≤ —Å–æ–∑–¥–µ—Ç—Å—è –ø–∞–ø–∫–∞ —Å –ø—Ä–æ–µ–∫—Ç–æ–º
```markdown
üìÅ runs/
‚îú‚îÄ‚îÄ üìÅ train_0/ # –ü—Ä–æ–µ–∫—Ç
‚îÇ ‚îú‚îÄ‚îÄ üì¶ best_model.pt # –ú–æ–¥–µ–ª—å —Å –ª—É—á—à–∏–º–∏ –≤–µ—Å–∞–º–∏
‚îÇ ‚îú‚îÄ‚îÄ üì¶ last_model.pt # –ú–æ–¥–µ–ª—å —Å –≤–µ—Å–∞–º–∏ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —ç–ø–æ—Ö–∏ –æ–±—É—á–µ–Ω–∏—è
‚îÇ ‚îú‚îÄ‚îÄ üìä result.csv # –î–∞–Ω–Ω—ã–µ –ø–æ –∫–∞–∂–¥–æ–π —ç–ø–æ—Ö–µ –æ–±—É—á–µ–Ω–∏—è
‚îÇ ‚îú‚îÄ‚îÄ üñºÔ∏è confusion_matrix_best_model.png # –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫ –¥–ª—è best_model.pt
‚îÇ ‚îú‚îÄ‚îÄ üñºÔ∏è confusion_matrix_last_model.png # –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫ –¥–ª—è last_model.pt
‚îÇ ‚îú‚îÄ‚îÄ üñºÔ∏è dataset_counts.png # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–∞—Ç–∞—Å–µ—Ç–∞
‚îÇ ‚îú‚îÄ‚îÄ üñºÔ∏è f1_score.png # –ú–µ—Ç—Ä–∏–∫–∞ F1 score
‚îÇ ‚îú‚îÄ‚îÄ üñºÔ∏è train_val_acc.png # –ì—Ä–∞—Ñ–∏–∫ train/val accuracy
‚îÇ ‚îú‚îÄ‚îÄ üñºÔ∏è train_val_loss.png # –ì—Ä–∞—Ñ–∏–∫ train/val loss
‚îÇ ‚îú‚îÄ‚îÄ ‚öôÔ∏è hyperparams.yaml
‚îú‚îÄ‚îÄ üìÅ train_1/
...
```
