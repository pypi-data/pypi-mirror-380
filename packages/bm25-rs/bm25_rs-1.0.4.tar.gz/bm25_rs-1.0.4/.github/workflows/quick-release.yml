name: Quick Release

on:
  workflow_dispatch:
    inputs:
      version_type:
        description: 'Type of version bump'
        required: true
        default: 'patch'
        type: choice
        options:
        - patch
        - minor
        - major

jobs:
  quick-release:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
    - name: Trigger Release Workflow
      uses: actions/github-script@v7
      with:
        script: |
          const response = await github.rest.actions.createWorkflowDispatch({
            owner: context.repo.owner,
            repo: context.repo.repo,
            workflow_id: 'release.yml',
            ref: 'main',
            inputs: {
              version_type: '${{ github.event.inputs.version_type }}',
              create_tag: 'true',
              skip_build: 'false'
            }
          });
          
          console.log('Release workflow triggered with version type: ${{ github.event.inputs.version_type }}');
          
          // Add summary
          await core.summary
            .addHeading('Quick Release Triggered')
            .addTable([
              [{data: 'Parameter', header: true}, {data: 'Value', header: true}],
              ['Version Type', '${{ github.event.inputs.version_type }}'],
              ['Workflow', 'release.yml'],
              ['Branch', 'main']
            ])
            .addLink('View Release Workflow', `${context.serverUrl}/${context.repo.owner}/${context.repo.repo}/actions/workflows/release.yml`)
            .write();