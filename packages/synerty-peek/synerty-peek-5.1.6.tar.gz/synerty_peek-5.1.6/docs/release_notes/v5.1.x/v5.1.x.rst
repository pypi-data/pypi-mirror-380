.. _release_notes_v5.1.x:

====================
v5.1.x Release Notes
====================

Platform Changes
----------------

Enhanced Metrics Collection
~~~~~~~~~~~~~~~~~~~~~~~~~~~

Peek v5.1.0 introduces improved metrics collection capabilities specifically
designed for secure environments where direct internet access is restricted. The platform now provides:

- New HTTP endpoint on port 8011 for metrics access
- Metrics data available via ``/metrics.tar`` endpoint  
- Enables comprehensive data collection without compromising network security
- Facilitates monitoring and analysis in air-gapped environments

Enhanced Logging System
~~~~~~~~~~~~~~~~~~~~~~~

The platform now includes a sophisticated logging management system with:

- **Automatic log rotation**: Configurable size-based rotation (default 500MB per log file)
- **Disk space monitoring**: Automatic monitoring with configurable thresholds (defaults: 20% or 5GB free space)
- **Log compression**: Automatic compression of rotated logs to save disk space
- **Service-based rotation**: Coordinated rotation across all Peek services
- **Centralized configuration**: All logging settings manageable via ``config.json``

This system ensures optimal disk usage while maintaining comprehensive logging for troubleshooting and auditing.

Major Plugin Changes
--------------------

ENMAC Switching Plugin Redesign
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The ENMAC Switching plugin has undergone a complete architectural redesign to improve usability and performance:

**Enhanced User Interface**:
- Modern two-column navigation system for improved workflow
- Streamlined layout optimized for field operations
- Better visual organization of switching operations and job management

**Core Integration**:
- Deep integration with the peek-core-screen component
- Unified screen management across different operational contexts
- Consistent user experience with other Peek applications
- Dynamically editible via peek-admin

**Advanced Configuration**:
- Job type-specific screen configurations for tailored workflows
- Template screen linking capabilities for standardized operations
- Flexible screen inheritance and customization options

*Epics: peek&100*

Dynamic Screen Components
~~~~~~~~~~~~~~~~~~~~~~~~

Multiple plugins have been enhanced with the new dynamic peek-core-screen component:

**Job Management Screens**:
- Dynamic job list displays with real-time updates
- Configurable job detail views based on job types

**Customer Management**:
- Improved customer information displays
- Dynamic customer detail screens with configurable layouts
- Better integration with operational workflows

**Operation Management**:
- Enhanced operation tracking screens
- Dynamic operation detail views for each permit type
- Improved operational status visibility

**Virtual Scrolling Support**:
All enhanced screens now include virtual scrolling capabilities for improved
performance when displaying large operation lists, ensuring smooth user experience
even with thousands of operations.

**Dynamically Editable Screens**:
The peek-core-screen functionality provides the switching plugin
the ability to instantly update screens by adding, removing or modifying the
screens via peek-admin, providing real-time customization
capabilities without requiring application restarts, or re-deploying iOS apps.

Deployment Changes
------------------

There are no deployment changes with this release. Deployment procedures
remain the same as Peek v5.0.x.

Support Platforms
-----------------

The following platforms are supported:

- **RHEL**:
  - RHEL 8.8 or higher
  - RHEL 9.5 or higher
  - Amazon Linux 2023

- **Browsers**:
  - Google Chrome version 78 or above
  - Microsoft Edge version 79 or above

- **iOS**:
  - iOS 17, 18

Migration Steps
---------------

In the SQL Plugin, the `Job` plugin requires two changes, see the notes in the
default SQL for `Job`, there are notes there.

All `switching` screens need to be reconfigured via the peek-core-screen plugin.

v5.1.2 Changes
--------------

New Features
````````````

ENMAC Switching Redesign
~~~~~~~~~~~~~~~~~~~~~~~~
The ENMAC Switching plugin has been completely redesigned with:
- Improved UI layout for better usability
- Two-column navigation system
- Integration with peek-core-screen component
- Job type specific screen configurations
- Template screen linking capabilities

*Epics: peek&100*

Metrics Collection for Secure Environments
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Added support for metrics collection in secure environments:
- New HTTP endpoint on port 8011
- Metrics data accessible via ``/metrics.tar``
- Enables data collection without direct internet access

*Issues: peek/peek#2993*

Improvements
````````````

- [peek/peek#2989] Enhanced logging system with configurable rotation and disk space management:
  - Automatic log rotation based on size (default 500MB)
  - Disk space threshold monitoring (defaults: 20% or 5GB free space)
  - Compression of rotated logs
  - Service restart-based rotation
  - Configurable via ``config.json``
- [peek/peek#2988] Upgraded Job, Customer, and Operation screens with dynamic peek-core-screen component featuring virtual scrolling support

Bug Fixes
`````````

- [peek/peek#2986] Resolved GraphDB unique key violations during segment processing:
  1. Cleared database storage constraints
  2. Restarted database service
  3. Cleared logs and reprocessed segments
- [peek/peek#2996] Fixed core-screen plugin to correctly return newly created default screens when requested screens don't exist
- [peek/peek#2990] Resolved exception occurring during offline status checks before document index initialization

Tasks
`````

- [peek/peek#2985] Created v5.1.x branches and released version 5.1.0
- [peek/peek#2987] Disabled intermittent Valkey SSL dependency tests to prevent build failures
- [peek/peek#2991] Fixed Angular budgets error in Peek Office v5.1.x build process

v5.1.1 Changes
--------------

This version was abandoned due to CI failures and was not released.

v5.1.0 Changes
--------------

This version was abandoned due to CI failures and was not released.