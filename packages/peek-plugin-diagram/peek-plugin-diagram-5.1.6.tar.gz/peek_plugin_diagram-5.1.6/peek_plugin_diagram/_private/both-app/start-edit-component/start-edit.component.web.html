<nz-modal
    (nzOnCancel)="closePopup()"
    [nzVisible]="popupShown"
    nzTitle="Create or Edit Diagram Branch"
    [nzFooter]="null"
    [nzWidth]="600"
>
    <ng-container *nzModalContent>
        <div class="button-div">
            <div></div>
            <div class="btn-group">
                <button (click)="startEditing()" nz-button nzType="primary">
                    Start Editing
                </button>
            </div>
        </div>
        <nz-tabset (nzSelectedIndexChange)="barIndex = $event">
            <nz-tab nzTitle="Create New">
                <div class="tab-content">
                    <form nz-form>
                        <nz-form-item>
                            <nz-form-label>Name</nz-form-label>
                            <nz-form-control>
                                <input
                                    [(ngModel)]="newBranch.name"
                                    name="branchName"
                                    type="text"
                                    nz-input
                                    placeholder="Enter branch name"
                                    aria-label="Branch name"
                                />
                            </nz-form-control>
                        </nz-form-item>
                        <nz-form-item>
                            <nz-form-label>Comment</nz-form-label>
                            <nz-form-control>
                                <textarea
                                    [(ngModel)]="newBranch.comment"
                                    name="branchComment"
                                    class="form-textarea"
                                    nz-input
                                    [nzAutosize]="{ minRows: 3, maxRows: 5 }"
                                    placeholder="Enter comment"
                                    aria-label="Branch comment"
                                ></textarea>
                            </nz-form-control>
                        </nz-form-item>
                    </form>
                </div>
            </nz-tab>
            <nz-tab nzTitle="Edit Branch">
                <div class="tab-content filter-div">
                    <input
                        *ngIf="!noAllItems()"
                        [(ngModel)]="filterText"
                        nz-input
                        placeholder="Filter"
                        type="text"
                        nz-tooltip
                        [nzTooltipMouseEnterDelay]="1.0"
                        nzTooltipTitle="Enter some text here to filter the list"
                        nzTooltipPlacement="top"
                        class="filter-input"
                    />
                    <nz-switch
                        [(ngModel)]="showOnlyMine"
                        nzCheckedChildren="Mine"
                        nzUnCheckedChildren="Mine"
                        nz-tooltip
                        [nzTooltipMouseEnterDelay]="1.0"
                        nzTooltipTitle="Show only branches you created?"
                        nzTooltipPlacement="top"
                    >
                    </nz-switch>
                    <nz-switch
                        [(ngModel)]="sortByDate"
                        nzCheckedChildren="Date"
                        nzUnCheckedChildren="Date"
                        nz-tooltip
                        [nzTooltipMouseEnterDelay]="1.0"
                        nzTooltipTitle="Sort the list by date or by name?"
                        nzTooltipPlacement="top"
                    >
                    </nz-switch>
                </div>

                <p *ngIf="noItems()" class="empty-message">
                    You have no existing branches.
                </p>
                <p *ngIf="noFilteredItems()" class="empty-message">
                    Your filter returned no items.
                </p>
                <div *ngIf="!noItems()" class="scroll-outer">
                    <nz-list nzBordered nzSize="large">
                        <nz-list-item
                            (click)="selectBranch(item)"
                            *ngFor="let item of (items$ | async)"
                            [class.selected]="isBranchSelected(item)"
                            class="branch-item"
                        >
                            {{ item.name }}
                        </nz-list-item>
                    </nz-list>
                </div>
            </nz-tab>
        </nz-tabset>
    </ng-container>
</nz-modal>
